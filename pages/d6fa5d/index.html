<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySql | Esqbs&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/blog-pub/img/favicon.ico">
    <link rel="manifest" href="/blog-pub/manifest.json">
    <link rel="apple-touch-icon" href="/blog-pub/img/logo.png">
    <script src="/blog-pub/index.js"></script>
    <meta name="description" content="个人博客">
    <meta name="charset" content="UTF-8">
    <meta name="keywords" content="个人博客">
    <meta name="theme-color" content="#F9648D">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog-pub/assets/css/0.styles.557eeae8.css" as="style"><link rel="preload" href="/blog-pub/assets/js/app.c191a6e4.js" as="script"><link rel="preload" href="/blog-pub/assets/js/2.ddadb16d.js" as="script"><link rel="preload" href="/blog-pub/assets/js/3.076d2e1e.js" as="script"><link rel="preload" href="/blog-pub/assets/js/10.1e7d9256.js" as="script"><link rel="prefetch" href="/blog-pub/assets/js/11.7662ffe2.js"><link rel="prefetch" href="/blog-pub/assets/js/12.acda5d4c.js"><link rel="prefetch" href="/blog-pub/assets/js/13.9bd8951c.js"><link rel="prefetch" href="/blog-pub/assets/js/14.e6ab0268.js"><link rel="prefetch" href="/blog-pub/assets/js/15.8475485a.js"><link rel="prefetch" href="/blog-pub/assets/js/16.cc900633.js"><link rel="prefetch" href="/blog-pub/assets/js/17.464f3ae5.js"><link rel="prefetch" href="/blog-pub/assets/js/18.0c1b81ba.js"><link rel="prefetch" href="/blog-pub/assets/js/19.a7e86ec7.js"><link rel="prefetch" href="/blog-pub/assets/js/20.895dc95b.js"><link rel="prefetch" href="/blog-pub/assets/js/4.12b1639e.js"><link rel="prefetch" href="/blog-pub/assets/js/5.572b4f10.js"><link rel="prefetch" href="/blog-pub/assets/js/6.9ae577a0.js"><link rel="prefetch" href="/blog-pub/assets/js/7.07b876b5.js"><link rel="prefetch" href="/blog-pub/assets/js/8.93e56b0c.js"><link rel="prefetch" href="/blog-pub/assets/js/9.062edf52.js">
    <link rel="stylesheet" href="/blog-pub/assets/css/0.styles.557eeae8.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog-pub/" class="home-link router-link-active"><img src="/blog-pub/img/logo.png" alt="Esqbs's blog" class="logo"> <span class="site-name can-hide">Esqbs's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog-pub/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog-pub/note/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/blog-pub/record/" class="nav-link">日常记录</a></div><div class="nav-item"><a href="/blog-pub/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog-pub/pages/beb6c0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog-pub/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog-pub/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/blog-pub/img/avatar.jpg"> <div class="blogger-info"><h3>Esqbs</h3> <span>这是我写的吗？？？</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog-pub/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog-pub/note/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/blog-pub/record/" class="nav-link">日常记录</a></div><div class="nav-item"><a href="/blog-pub/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog-pub/pages/beb6c0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog-pub/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog-pub/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据库</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-pub/pages/d6fa5d/" aria-current="page" class="active sidebar-link">MySql</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#一、数据库基本语法" class="sidebar-link">一、数据库基本语法</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#二、ddl" class="sidebar-link">二、DDL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#查询数据库" class="sidebar-link">查询数据库</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#创建数据库" class="sidebar-link">创建数据库</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#修改数据库" class="sidebar-link">修改数据库</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#删除数据库" class="sidebar-link">删除数据库</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#使用-切换数据库" class="sidebar-link">使用/切换数据库</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#创建数据表" class="sidebar-link">创建数据表</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#查询数据表" class="sidebar-link">查询数据表</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#查询表结构" class="sidebar-link">查询表结构</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#删除数据表" class="sidebar-link">删除数据表</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#修改数据表" class="sidebar-link">修改数据表</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#三、数据类型" class="sidebar-link">三、数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#数值类型" class="sidebar-link">数值类型</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#字符串类型" class="sidebar-link">字符串类型</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#日期类型" class="sidebar-link">日期类型</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#四、字段约束" class="sidebar-link">四、字段约束</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#非空约束" class="sidebar-link">非空约束</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#唯一约束" class="sidebar-link">唯一约束</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#主键约束" class="sidebar-link">主键约束</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#主键自增" class="sidebar-link">主键自增</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#联合主键" class="sidebar-link">联合主键</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#外键约束" class="sidebar-link">外键约束</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#五、dml-数据操作语言" class="sidebar-link">五、DML 数据操作语言</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#插入数据" class="sidebar-link">插入数据</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#删除数据" class="sidebar-link">删除数据</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#修改数据" class="sidebar-link">修改数据</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#六、dql-数据查询语言" class="sidebar-link">六、DQL 数据查询语言</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#where子句" class="sidebar-link">where子句</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#like子句" class="sidebar-link">LIKE子句</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#对查询结果进行处理" class="sidebar-link">对查询结果进行处理</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#七、数据表的关联关系" class="sidebar-link">七、数据表的关联关系</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#八、连接查询" class="sidebar-link">八、连接查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#内连接" class="sidebar-link">内连接</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#左连接" class="sidebar-link">左连接</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#右连接" class="sidebar-link">右连接</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#数据表别名" class="sidebar-link">数据表别名</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#子查询" class="sidebar-link">子查询</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#九、存储过程" class="sidebar-link">九、存储过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#存储过程介绍" class="sidebar-link">存储过程介绍</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#创建存储过程" class="sidebar-link">创建存储过程</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#调用存储过程" class="sidebar-link">调用存储过程</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#存储过程中变量的使用" class="sidebar-link">存储过程中变量的使用</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#存储过程的参数" class="sidebar-link">存储过程的参数</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#存储过程的流程控制" class="sidebar-link">存储过程的流程控制</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#存储过程的管理" class="sidebar-link">存储过程的管理</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#游标" class="sidebar-link">游标</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#十、触发器" class="sidebar-link">十、触发器</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#十一、视图" class="sidebar-link">十一、视图</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#视图的概念" class="sidebar-link">视图的概念</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#视图的作用" class="sidebar-link">视图的作用</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#视图的特性" class="sidebar-link">视图的特性</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#视图的操作" class="sidebar-link">视图的操作</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#十二、索引" class="sidebar-link">十二、索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#索引的介绍" class="sidebar-link">索引的介绍</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#索引的分类" class="sidebar-link">索引的分类</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#索引操作" class="sidebar-link">索引操作</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#索引的总结" class="sidebar-link">索引的总结</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/d6fa5d/#十三、数据库事务" class="sidebar-link">十三、数据库事务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#事务的特性" class="sidebar-link">事务的特性</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#mysql事务管理" class="sidebar-link">MySQL事务管理</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/d6fa5d/#设置数据库隔离级别" class="sidebar-link">设置数据库隔离级别</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-6"><div class="articleInfo-wrap" data-v-d5e9d2e6><div class="articleInfo" data-v-d5e9d2e6><ul class="breadcrumbs" data-v-d5e9d2e6><li data-v-d5e9d2e6><a href="/blog-pub/" title="首页" class="iconfont icon-home router-link-active" data-v-d5e9d2e6></a></li> <li data-v-d5e9d2e6><a href="/blog-pub/note/#学习笔记" data-v-d5e9d2e6>学习笔记</a></li><li data-v-d5e9d2e6><a href="/blog-pub/note/#数据库" data-v-d5e9d2e6>数据库</a></li></ul> <div class="info" data-v-d5e9d2e6><div title="作者" class="author iconfont icon-touxiang" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>Esqbs</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>2022-05-04</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">MySql<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="一、数据库基本语法"><a href="#一、数据库基本语法" class="header-anchor">#</a> 一、数据库基本语法</h2> <ul><li>SQL不区分大小写</li> <li>每条语句以“；”结尾</li> <li>关键字之间使用空格</li></ul> <h2 id="二、ddl"><a href="#二、ddl" class="header-anchor">#</a> 二、DDL</h2> <blockquote><p>使用DDL语句可以创建、查询、修改、删除数据库</p></blockquote> <h3 id="查询数据库"><a href="#查询数据库" class="header-anchor">#</a> 查询数据库</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>	<span class="token comment">// 显示当前MySQL数据库列表</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 显示指定名称的数据库的创建的SQL指令</span>
</code></pre></div><h3 id="创建数据库"><a href="#创建数据库" class="header-anchor">#</a> 创建数据库</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 创建数据库</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	 <span class="token comment">// 当指定名称的数据库不存在时创建数据库</span>
<span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>	<span class="token comment">// 创建数据库时指定字符集</span>
</code></pre></div><h3 id="修改数据库"><a href="#修改数据库" class="header-anchor">#</a> 修改数据库</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>	<span class="token comment">// 修改数据库字符集</span>
</code></pre></div><h3 id="删除数据库"><a href="#删除数据库" class="header-anchor">#</a> 删除数据库</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 删除数据库会删除所有表和数据</span>
<span class="token keyword">drop</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 如果数据库存在删除数据库</span>
</code></pre></div><h3 id="使用-切换数据库"><a href="#使用-切换数据库" class="header-anchor">#</a> 使用/切换数据库</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">use</span> <span class="token operator">&lt;</span>dbName<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="创建数据表"><a href="#创建数据表" class="header-anchor">#</a> 创建数据表</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> students <span class="token punctuation">(</span>
    stu_num <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    stu_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    stu_gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    stu_age <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    stu_tel <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    stu_qq <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">unique</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="查询数据表"><a href="#查询数据表" class="header-anchor">#</a> 查询数据表</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="查询表结构"><a href="#查询表结构" class="header-anchor">#</a> 查询表结构</h3> <div class="language- extra-class"><pre class="language-text"><code>desc &lt;tableName&gt;;
</code></pre></div><h3 id="删除数据表"><a href="#删除数据表" class="header-anchor">#</a> 删除数据表</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 删除数据表</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 如果数据库表存在删除数据表</span>
</code></pre></div><h3 id="修改数据表"><a href="#修改数据表" class="header-anchor">#</a> 修改数据表</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">rename</span> <span class="token keyword">to</span> <span class="token operator">&lt;</span>newName<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 修改数据表名</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>	<span class="token comment">//修改数据表单的字符集，数据表默认字符集和数据库一致</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">add</span> <span class="token operator">&lt;</span>columnName<span class="token operator">&gt;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//添加列</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> change <span class="token operator">&lt;</span>oldColumnName<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>newColumnName<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>tyep<span class="token operator">&gt;</span><span class="token punctuation">;</span>	<span class="token comment">// 修改字段的列和类型</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">modify</span> <span class="token operator">&lt;</span>columnName<span class="token operator">&gt;</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 只修改类型</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">drop</span> <span class="token operator">&lt;</span>columnName<span class="token operator">&gt;</span><span class="token punctuation">;</span> 	<span class="token comment">// 删除列</span>
</code></pre></div><h2 id="三、数据类型"><a href="#三、数据类型" class="header-anchor">#</a> 三、数据类型</h2> <h3 id="数值类型"><a href="#数值类型" class="header-anchor">#</a> 数值类型</h3> <table><thead><tr><th style="text-align:left;">类型</th> <th style="text-align:left;">大小</th> <th style="text-align:left;">范围（有符号）</th> <th style="text-align:left;">范围（无符号）</th> <th style="text-align:left;">用途</th></tr></thead> <tbody><tr><td style="text-align:left;">TINYINT</td> <td style="text-align:left;">1 Bytes</td> <td style="text-align:left;">(-128，127)</td> <td style="text-align:left;">(0，255)</td> <td style="text-align:left;">小整数值</td></tr> <tr><td style="text-align:left;">SMALLINT</td> <td style="text-align:left;">2 Bytes</td> <td style="text-align:left;">(-32 768，32 767)</td> <td style="text-align:left;">(0，65 535)</td> <td style="text-align:left;">大整数值</td></tr> <tr><td style="text-align:left;">MEDIUMINT</td> <td style="text-align:left;">3 Bytes</td> <td style="text-align:left;">(-8 388 608，8 388 607)</td> <td style="text-align:left;">(0，16 777 215)</td> <td style="text-align:left;">大整数值</td></tr> <tr><td style="text-align:left;">INT或INTEGER</td> <td style="text-align:left;">4 Bytes</td> <td style="text-align:left;">(-2 147 483 648，2 147 483 647)</td> <td style="text-align:left;">(0，4 294 967 295)</td> <td style="text-align:left;">大整数值</td></tr> <tr><td style="text-align:left;">BIGINT</td> <td style="text-align:left;">8 Bytes</td> <td style="text-align:left;">(-9,223,372,036,854,775,808，9 223 372 036 854 775 807)</td> <td style="text-align:left;">(0，18 446 744 073 709 551 615)</td> <td style="text-align:left;">极大整数值</td></tr> <tr><td style="text-align:left;">FLOAT</td> <td style="text-align:left;">4 Bytes</td> <td style="text-align:left;">(-3.402 823 466 E+38，-1.175 494 351 E-38)，0，(1.175 494 351 E-38，3.402 823 466 351 E+38)</td> <td style="text-align:left;">0，(1.175 494 351 E-38，3.402 823 466 E+38)</td> <td style="text-align:left;">单精度 浮点数值</td></tr> <tr><td style="text-align:left;">DOUBLE</td> <td style="text-align:left;">8 Bytes</td> <td style="text-align:left;">(-1.797 693 134 862 315 7 E+308，-2.225 073 858 507 201 4 E-308)，0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308)</td> <td style="text-align:left;">0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308)</td> <td style="text-align:left;">双精度 浮点数值</td></tr> <tr><td style="text-align:left;">DECIMAL</td> <td style="text-align:left;">对DECIMAL(M,D) ，如果M&gt;D，为M+2否则为D+2</td> <td style="text-align:left;">依赖于M和D的值</td> <td style="text-align:left;">依赖于M和D的值</td> <td style="text-align:left;">小数值</td></tr></tbody></table> <h3 id="字符串类型"><a href="#字符串类型" class="header-anchor">#</a> 字符串类型</h3> <table><thead><tr><th style="text-align:left;">类型</th> <th style="text-align:left;">大小</th> <th style="text-align:left;">用途</th></tr></thead> <tbody><tr><td style="text-align:left;">CHAR</td> <td style="text-align:left;">0-255 bytes</td> <td style="text-align:left;">定长字符串</td></tr> <tr><td style="text-align:left;">VARCHAR</td> <td style="text-align:left;">0-65535 bytes</td> <td style="text-align:left;">变长字符串</td></tr> <tr><td style="text-align:left;">TINYBLOB</td> <td style="text-align:left;">0-255 bytes</td> <td style="text-align:left;">不超过 255 个字符的二进制字符串</td></tr> <tr><td style="text-align:left;">TINYTEXT</td> <td style="text-align:left;">0-255 bytes</td> <td style="text-align:left;">短文本字符串</td></tr> <tr><td style="text-align:left;">BLOB</td> <td style="text-align:left;">0-65 535 bytes</td> <td style="text-align:left;">二进制形式的长文本数据</td></tr> <tr><td style="text-align:left;">TEXT</td> <td style="text-align:left;">0-65 535 bytes</td> <td style="text-align:left;">长文本数据</td></tr> <tr><td style="text-align:left;">MEDIUMBLOB</td> <td style="text-align:left;">0-16 777 215 bytes</td> <td style="text-align:left;">二进制形式的中等长度文本数据</td></tr> <tr><td style="text-align:left;">MEDIUMTEXT</td> <td style="text-align:left;">0-16 777 215 bytes</td> <td style="text-align:left;">中等长度文本数据</td></tr> <tr><td style="text-align:left;">LONGBLOB</td> <td style="text-align:left;">0-4 294 967 295 bytes</td> <td style="text-align:left;">二进制形式的极大文本数据</td></tr> <tr><td style="text-align:left;">LONGTEXT</td> <td style="text-align:left;">0-4 294 967 295 bytes</td> <td style="text-align:left;">极大文本数据</td></tr></tbody></table> <h3 id="日期类型"><a href="#日期类型" class="header-anchor">#</a> 日期类型</h3> <table><thead><tr><th style="text-align:left;">类型</th> <th style="text-align:left;">大小 ( bytes)</th> <th style="text-align:left;">范围</th> <th style="text-align:left;">格式</th> <th style="text-align:left;">用途</th></tr></thead> <tbody><tr><td style="text-align:left;">DATE</td> <td style="text-align:left;">3</td> <td style="text-align:left;">1000-01-01/9999-12-31</td> <td style="text-align:left;">YYYY-MM-DD</td> <td style="text-align:left;">日期值</td></tr> <tr><td style="text-align:left;">TIME</td> <td style="text-align:left;">3</td> <td style="text-align:left;">'-838:59:59'/'838:59:59'</td> <td style="text-align:left;">HH:MM:SS</td> <td style="text-align:left;">时间值或持续时间</td></tr> <tr><td style="text-align:left;">YEAR</td> <td style="text-align:left;">1</td> <td style="text-align:left;">1901/2155</td> <td style="text-align:left;">YYYY</td> <td style="text-align:left;">年份值</td></tr> <tr><td style="text-align:left;">DATETIME</td> <td style="text-align:left;">8</td> <td style="text-align:left;">1000-01-01 00:00:00/9999-12-31 23:59:59</td> <td style="text-align:left;">YYYY-MM-DD HH:MM:SS</td> <td style="text-align:left;">混合日期和时间值</td></tr> <tr><td style="text-align:left;">TIMESTAMP</td> <td style="text-align:left;">4</td> <td style="text-align:left;">1970-01-01 00:00:00/2038结束时间是第 <strong>2147483647</strong> 秒，北京时间 <strong>2038-1-19 11:14:07</strong>，格林尼治时间 2038年1月19日 凌晨 03:14:07</td> <td style="text-align:left;">YYYYMMDD HHMMSS</td> <td style="text-align:left;">混合日期和时间值，时间戳</td></tr></tbody></table> <h2 id="四、字段约束"><a href="#四、字段约束" class="header-anchor">#</a> 四、字段约束</h2> <h3 id="非空约束"><a href="#非空约束" class="header-anchor">#</a> 非空约束</h3> <blockquote><p>限制数据表中此列的值必须提供</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> books<span class="token punctuation">(</span>
	book_isbn <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	book_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span> <span class="token comment">// 非空约束</span>
	book_author <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="唯一约束"><a href="#唯一约束" class="header-anchor">#</a> 唯一约束</h3> <blockquote><p>数据表中此列的值不能重复</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> books<span class="token punctuation">(</span>
	book_isbn <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">unique</span><span class="token punctuation">,</span> <span class="token comment">// 唯一约束</span>
	book_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
	book_author <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="主键约束"><a href="#主键约束" class="header-anchor">#</a> 主键约束</h3> <blockquote><p>主键----就是数据表中记录的唯一标识，在一张表中只能有一个主键（主键可以是一个列，也可以是多个列的组合）</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 创建表时添加主键约束</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> books<span class="token punctuation">(</span>
	book_isbn <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span> <span class="token comment">// 主键约束</span>
	book_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
	book_author <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> books<span class="token punctuation">(</span>
	book_isbn <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	book_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
	book_author <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>book_isbn<span class="token punctuation">)</span>	<span class="token comment">// 主键约束</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 删除数据表主键约束</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> books <span class="token keyword">drop</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">;</span>

<span class="token comment"># 创建表之后添加主键约束</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> books <span class="token keyword">modify</span> book_isbn <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="主键自增"><a href="#主键自增" class="header-anchor">#</a> 主键自增</h3> <blockquote><p>当数据表中没有合适的列作为主键时，可以定义一个与记录无关的列（id）作为主键。MySQL中可以设置为int，同时设置为自动增长。</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> books<span class="token punctuation">(</span>
	book_id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>	<span class="token comment">// 主键自增，自动增长的数据不会重复生成</span>
	book_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
	book_author <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="联合主键"><a href="#联合主键" class="header-anchor">#</a> 联合主键</h3> <blockquote><p>联合组件----将数据表中的多列组合到一起设置为表的主键</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> students<span class="token punctuation">(</span>
	stu_num <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	stu_name <span class="token keyword">varChar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">create</span> <span class="token keyword">table</span> courses<span class="token punctuation">(</span>
	course_id <span class="token keyword">int</span><span class="token punctuation">,</span>
	course_name <span class="token keyword">varChar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">create</span> <span class="token keyword">table</span> grades<span class="token punctuation">(</span>
	stu_num <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	course_id <span class="token keyword">int</span><span class="token punctuation">,</span>
	score <span class="token keyword">int</span><span class="token punctuation">,</span>
	<span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">,</span> course_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="外键约束"><a href="#外键约束" class="header-anchor">#</a> 外键约束</h3> <h2 id="五、dml-数据操作语言"><a href="#五、dml-数据操作语言" class="header-anchor">#</a> 五、DML 数据操作语言</h2> <h3 id="插入数据"><a href="#插入数据" class="header-anchor">#</a> 插入数据</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 向数据表中指定列添加数据，values中值的顺序必须与表名后字段的顺序对应</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token punctuation">(</span>column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

<span class="token comment"># 当向表中所有数据添加数据时，表名后面的字段列表可以省略，values中值的顺序与数据表定义时保持一致</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">values</span><span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

<span class="token comment"># 实例</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stus <span class="token punctuation">(</span>stu_num<span class="token punctuation">,</span> stu_name<span class="token punctuation">,</span> stu_gender<span class="token punctuation">,</span> stu_age<span class="token punctuation">,</span> stu_tel<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;男&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&quot;12312341234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="删除数据"><a href="#删除数据" class="header-anchor">#</a> 删除数据</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 如果没有where，则删除所有</span>
<span class="token keyword">delete</span> <span class="token keyword">from</span> <span class="token operator">&lt;</span>tableNamme<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token keyword">WHERE</span> conditions<span class="token punctuation">]</span>
</code></pre></div><h3 id="修改数据"><a href="#修改数据" class="header-anchor">#</a> 修改数据</h3> <div class="language- extra-class"><pre class="language-text"><code>update &lt;tableName&gt; set &lt;columnName1&gt;=value1,&lt;columnName2&gt;=value2,... [WHERE conditions]

# 实例
update stus set stu_name=&quot;王五&quot; where stu_num=&quot;2&quot;; // 修改一列
update stus set stu_gender=&quot;女&quot;,stu_qq=&quot;999999999&quot; where stu_num=&quot;2&quot;;	// 修改多列
</code></pre></div><h2 id="六、dql-数据查询语言"><a href="#六、dql-数据查询语言" class="header-anchor">#</a> 六、DQL 数据查询语言</h2> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> columnName1<span class="token punctuation">,</span><span class="token punctuation">[</span>columnName2<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token keyword">FROM</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span>
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> conditions<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">LIMIT</span> N<span class="token punctuation">]</span><span class="token punctuation">[</span> <span class="token keyword">OFFSET</span> M<span class="token punctuation">]</span>
</code></pre></div><h3 id="where子句"><a href="#where子句" class="header-anchor">#</a> where子句</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 条件</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_num<span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">;</span>	<span class="token comment">// 等于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_num<span class="token operator">!=</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">;</span>	<span class="token comment">// 不等于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&gt;</span><span class="token number">18</span><span class="token punctuation">;</span>	<span class="token comment">// 大于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&lt;</span><span class="token number">18</span><span class="token punctuation">;</span>	<span class="token comment">// 小于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&gt;=</span><span class="token number">18</span><span class="token punctuation">;</span>	<span class="token comment">// 大于等于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">;</span>	<span class="token comment">// 小于等于</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 区间查询</span>

<span class="token comment"># 条件逻辑运算符</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">and</span> stu_gender<span class="token operator">=</span><span class="token string">&quot;男&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 与</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&gt;</span><span class="token number">18</span> <span class="token operator">or</span> stu_gender<span class="token operator">=</span><span class="token string">&quot;男&quot;</span><span class="token punctuation">;</span>	<span class="token comment">// 或</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age <span class="token operator">not</span> <span class="token operator">between</span> <span class="token number">18</span> <span class="token operator">and</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 取反</span>

</code></pre></div><h3 id="like子句"><a href="#like子句" class="header-anchor">#</a> LIKE子句</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_name <span class="token operator">like</span> <span class="token string">&quot;%张%&quot;</span><span class="token punctuation">;</span>	<span class="token comment">//包含“张”。%表示任意多个字符</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_name <span class="token operator">like</span> <span class="token string">&quot;张%&quot;</span><span class="token punctuation">;</span>	<span class="token comment">//第一个字为“张”</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_name <span class="token operator">like</span> <span class="token string">&quot;张_&quot;</span><span class="token punctuation">;</span>	<span class="token comment">//第一个字为“张”，第二个为任意字符。_表示任意一个字符</span>
</code></pre></div><h3 id="对查询结果进行处理"><a href="#对查询结果进行处理" class="header-anchor">#</a> 对查询结果进行处理</h3> <h4 id="计算列"><a href="#计算列" class="header-anchor">#</a> 计算列</h4> <blockquote><p>对从数据表中查询出来的数据进行一定的处理后显示出来</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> stu_name<span class="token punctuation">,</span><span class="token number">2021</span><span class="token operator">-</span>stu_age <span class="token keyword">from</span> stus<span class="token punctuation">;</span>
</code></pre></div><h4 id="字段别名"><a href="#字段别名" class="header-anchor">#</a> 字段别名</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> stu_name<span class="token punctuation">,</span><span class="token number">2021</span><span class="token operator">-</span>stu_age <span class="token keyword">as</span> stu_birth_year <span class="token keyword">from</span> stus<span class="token punctuation">;</span>
</code></pre></div><h4 id="消除重复记录"><a href="#消除重复记录" class="header-anchor">#</a> 消除重复记录</h4> <blockquote><p>从查询结果中将重复记录消除 <code>distinct</code></p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">distinct</span> stu_age <span class="token keyword">from</span> stus
</code></pre></div><h4 id="排序"><a href="#排序" class="header-anchor">#</a> 排序</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 单字段排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&gt;</span><span class="token number">15</span> <span class="token keyword">order</span> <span class="token keyword">by</span> stu_age<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&gt;</span><span class="token number">15</span> <span class="token keyword">order</span> <span class="token keyword">by</span> stu_age <span class="token keyword">desc</span><span class="token punctuation">;</span> <span class="token comment">// 降序， asc 升序（默认）</span>

<span class="token comment"># 多字段排序</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_age<span class="token operator">&gt;</span><span class="token number">15</span> <span class="token keyword">order</span> <span class="token keyword">by</span> stu_gender<span class="token punctuation">,</span>stu_age <span class="token keyword">desc</span><span class="token punctuation">;</span> <span class="token comment">// 先满足第一个排序规则，再按第二规则排序</span>
</code></pre></div><h4 id="聚合函数"><a href="#聚合函数" class="header-anchor">#</a> 聚合函数</h4> <ul><li><code>count()</code> 统计函数</li> <li><code>max()</code> 计算最大值</li> <li><code>min()</code> 计算最大值</li> <li><code>sum()</code> 计算和</li> <li><code>avg()</code> 求平均值</li></ul> <h4 id="日期函数"><a href="#日期函数" class="header-anchor">#</a> 日期函数</h4> <blockquote><p>当向日期类型的列添加数据时，可以通过字符串类型赋值。如果想添加当前系统时间，可使用 <code>now()</code> 或 <code>sysdate()</code></p></blockquote> <h4 id="字符串函数"><a href="#字符串函数" class="header-anchor">#</a> 字符串函数</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># concat() 拼接</span>
<span class="token keyword">select</span> concat<span class="token punctuation">(</span>stu_name<span class="token punctuation">,</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> stu_gender<span class="token punctuation">)</span> <span class="token keyword">from</span> stus<span class="token punctuation">;</span>

<span class="token comment"># upper() 转大写</span>

<span class="token comment"># lower() 转小写</span>

<span class="token comment"># substring(str, start, len) 截取 从1开始</span>
<span class="token keyword">select</span> substring<span class="token punctuation">(</span>stu_name<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">from</span> stus<span class="token punctuation">;</span>

</code></pre></div><h4 id="分组"><a href="#分组" class="header-anchor">#</a> 分组</h4> <ul><li>select 后使用 * ，查询结果显示分组后每组的第一条记录</li> <li>select后通常显示分组字段和聚合函数</li> <li>语句执行顺序：1. 先根据where条件从数据库查询记录 2. group by对记录进行分组 3. 执行having对分组后的数据进行筛选</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 实例 先分组后统计人数</span>
<span class="token keyword">select</span> stu_gender<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span> <span class="token keyword">from</span> stus <span class="token keyword">group</span> <span class="token keyword">by</span> stu_gender<span class="token punctuation">;</span>
<span class="token comment"># 先分组后求每组平均值</span>
<span class="token keyword">select</span> stu_gender<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>stu_age<span class="token punctuation">)</span> <span class="token keyword">from</span> stus <span class="token keyword">group</span> <span class="token keyword">by</span> stu_gender<span class="token punctuation">;</span>

<span class="token comment"># 先按年龄分组，统计数量，还可对结果排序</span>
<span class="token keyword">select</span> stu_age<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span> <span class="token keyword">from</span> stus <span class="token keyword">group</span> <span class="token keyword">by</span> stu_age <span class="token keyword">order</span> <span class="token keyword">by</span> stu_age<span class="token punctuation">;</span>
<span class="token comment"># 先按年龄分组，统计数量，筛选出人数大于1的分组</span>
<span class="token keyword">select</span> stu_age<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span> <span class="token keyword">from</span> stus <span class="token keyword">group</span> <span class="token keyword">by</span> stu_age <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment"># 先按年龄分组，统计数量，筛选出人数大于1的分组，再按年龄排序显示</span>
<span class="token keyword">select</span> stu_age<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span> <span class="token keyword">from</span> stus <span class="token keyword">group</span> <span class="token keyword">by</span> stu_age <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">order</span> <span class="token keyword">by</span> stu_age<span class="token punctuation">;</span>
<span class="token comment"># 先选出男生，再按年龄分组，统计数量，筛选出人数大于1的分组，最后按年龄排序显示</span>
<span class="token keyword">select</span> stu_age<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span> <span class="token keyword">from</span> stus <span class="token keyword">where</span> stu_gender<span class="token operator">=</span><span class="token string">&quot;男&quot;</span> <span class="token keyword">group</span> <span class="token keyword">by</span> stu_age <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">1</span> <span class="token keyword">order</span> <span class="token keyword">by</span> stu_age<span class="token punctuation">;</span>
</code></pre></div><h4 id="分页"><a href="#分页" class="header-anchor">#</a> 分页</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">limit</span> <span class="token keyword">start</span><span class="token punctuation">,</span>count <span class="token comment">// start开始位置，count查询数量</span>

<span class="token comment">## pageNum页码， pageSize每页条数</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token operator">&lt;</span>tableName<span class="token operator">&gt;</span> <span class="token keyword">limit</span> <span class="token punctuation">(</span>pageNum <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>pageSize<span class="token punctuation">,</span>pageSize
</code></pre></div><h2 id="七、数据表的关联关系"><a href="#七、数据表的关联关系" class="header-anchor">#</a> 七、数据表的关联关系</h2> <h4 id="一对一关联"><a href="#一对一关联" class="header-anchor">#</a> 一对一关联</h4> <ul><li>主键关联----两张数据表中主键相同的数据为相互对应的数据</li> <li>唯一外键----在任意一张表中添加一个字段添加外键约束与另一种表主键关联，并将外键列添加唯一约束</li></ul> <h4 id="一对多关联"><a href="#一对多关联" class="header-anchor">#</a> 一对多关联</h4> <p>在多的一端添加外键，与一的一端主键进行关联</p> <h4 id="多对多关联"><a href="#多对多关联" class="header-anchor">#</a> 多对多关联</h4> <p>额外创建一张关系表来维护多对多关联----在关系表中定义两个外键，分别与两个数据表的主键进行关联</p> <h4 id="外键约束-2"><a href="#外键约束-2" class="header-anchor">#</a> 外键约束</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">## 方式一：创建表时添加外键</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> classes<span class="token punctuation">(</span>
    class_id <span class="token keyword">int</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
    class_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span><span class="token punctuation">,</span>
    class_remark <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">create</span> <span class="token keyword">table</span> students<span class="token punctuation">(</span>
    stu_num <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>
    stu_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    stu_gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    stu_age <span class="token keyword">int</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    cid <span class="token keyword">int</span><span class="token punctuation">,</span>
    <span class="token keyword">constraint</span> FK_STUDENTS_CLASSES <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">references</span> classes<span class="token punctuation">(</span>class_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">## 方式二：创建表之后添加外键约束</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">add</span> <span class="token keyword">constraint</span> FK_STUDENTS_CLASSES <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">references</span> classes<span class="token punctuation">(</span>class_id<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">## 删除外键</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> FK_STUDENTS_CLASSES<span class="token punctuation">;</span>
</code></pre></div><h4 id="外键约束-级联"><a href="#外键约束-级联" class="header-anchor">#</a> 外键约束--级联</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> students <span class="token keyword">set</span> cid<span class="token operator">=</span><span class="token boolean">NULL</span> <span class="token keyword">where</span> cid<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> classes <span class="token keyword">set</span> class_id<span class="token operator">=</span><span class="token number">9</span> <span class="token keyword">where</span> class_name<span class="token operator">=</span><span class="token string">&quot;java&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">update</span> students <span class="token keyword">set</span> cid<span class="token operator">=</span><span class="token number">9</span> <span class="token keyword">where</span> cid <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment"># 级联实现</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">drop</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> FK_STUDENTS_CLASSES<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">add</span> <span class="token keyword">constraint</span> FK_STUDENTS_CLASSES <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">references</span> classes<span class="token punctuation">(</span>class_id<span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="八、连接查询"><a href="#八、连接查询" class="header-anchor">#</a> 八、连接查询</h2> <blockquote><p>在MySQL中可以使用join实现多表的联合查询----连接查询，join按照其功能的不同分为三个操作：</p> <ul><li>inner join 内连接</li> <li>left join 左连接</li> <li>right join 右连接</li></ul></blockquote> <h3 id="内连接"><a href="#内连接" class="header-anchor">#</a> 内连接</h3> <ol><li>直接获取两张数据表中的数据集合的 <a href="https://baike.baidu.com/item/%E7%AC%9B%E5%8D%A1%E5%B0%94%E4%B9%98%E7%A7%AF/6323173" target="_blank" rel="noopener noreferrer">笛卡尔积<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> classes<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>内连接条件</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 使用where设置过滤条件：先生成笛卡尔积再从笛卡尔积中过滤数据（效率低）</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> classes <span class="token keyword">where</span> students<span class="token punctuation">.</span>cid<span class="token operator">=</span>classes<span class="token punctuation">.</span>class_id<span class="token punctuation">;</span>

<span class="token comment"># 使用on设置连接查询条件：先判断连接条件是否成立，如果成立两张表的数据进行组合生成一条记录</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> classes <span class="token keyword">on</span> students<span class="token punctuation">.</span>cid<span class="token operator">=</span>classes<span class="token punctuation">.</span>class_id<span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>结果只获取两张表中匹配条件成立的数据，任何一张表在另一张表如果没有找到对应匹配则不会出现在查询结果中</li></ol> <h3 id="左连接"><a href="#左连接" class="header-anchor">#</a> 左连接</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 显示左表中的所有数据，如果在右表中存在于左表记录满足匹配条件的数据，则进行匹配；如果右表中不存在匹配的数据，则显示为NULL</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> classes <span class="token keyword">on</span> students<span class="token punctuation">.</span>cid<span class="token operator">=</span>classes<span class="token punctuation">.</span>class_id<span class="token punctuation">;</span>
</code></pre></div><h3 id="右连接"><a href="#右连接" class="header-anchor">#</a> 右连接</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 显示右表中的所有数据</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> classes <span class="token keyword">on</span> students<span class="token punctuation">.</span>cid<span class="token operator">=</span>classes<span class="token punctuation">.</span>class_id<span class="token punctuation">;</span>
</code></pre></div><h3 id="数据表别名"><a href="#数据表别名" class="header-anchor">#</a> 数据表别名</h3> <blockquote><p>如果在连接查询的多张表中存在相同名字的字段，我们可以使用<code>表名.字段名</code>来进行区分，如果表名太长不便于SQL语句的编写，可以使用数据表别名</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students s <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> classes c <span class="token keyword">on</span> s<span class="token punctuation">.</span>cid<span class="token operator">=</span>c<span class="token punctuation">.</span>class_id<span class="token punctuation">;</span>
</code></pre></div><h3 id="子查询"><a href="#子查询" class="header-anchor">#</a> 子查询</h3> <ol><li>子查询的返回值是单个值</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 传统方式</span>
<span class="token keyword">select</span> class_id <span class="token keyword">from</span> classes <span class="token keyword">where</span> class_name<span class="token operator">=</span><span class="token string">&quot;c&quot;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> cid <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment"># 子查询</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> cid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> class_id <span class="token keyword">from</span> classes <span class="token keyword">where</span> class_name<span class="token operator">=</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>子查询的返回值是多个值</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 传统方式</span>
<span class="token keyword">select</span> class_id <span class="token keyword">from</span> classes <span class="token keyword">where</span> class_name <span class="token operator">LIKE</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> cid <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">UNION</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> cid <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">UNION</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> cid <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment"># 子查询</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> cid <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> class_id <span class="token keyword">from</span> classes <span class="token keyword">where</span> class_name<span class="token operator">=</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>子查询的返回值是多个值--多行多列</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 查询cid = 3的班级中性别为男的学生信息</span>
<span class="token comment"># 多条件查询</span>
<span class="token keyword">select</span> <span class="token operator">*</span> form students <span class="token keyword">where</span> cid<span class="token operator">=</span><span class="token number">3</span> <span class="token operator">and</span> stu_gender<span class="token operator">=</span><span class="token string">&quot;男&quot;</span><span class="token punctuation">;</span>

<span class="token comment"># 子查询：先查询cid=3班级的学生信息，将这些信息作为一个整体虚拟表，再基于这个虚拟表查询性别为男的学生信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> students <span class="token keyword">where</span> cid<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span> t <span class="token keyword">where</span> t<span class="token punctuation">.</span>stu_gender<span class="token operator">=</span><span class="token string">&quot;男&quot;</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="九、存储过程"><a href="#九、存储过程" class="header-anchor">#</a> 九、存储过程</h2> <h3 id="存储过程介绍"><a href="#存储过程介绍" class="header-anchor">#</a> 存储过程介绍</h3> <ol><li>存在的问题：
<ul><li>如果需要多次重复执行相同的SQL，SQL执行都需要通过连接传递到MySQL，并且需要经过编译和执行的步骤；</li> <li>如果需要连续执行多个SQL指令，并且二个SQL指令需要使用第一个SQL指令执行的结果作为参数；</li></ul></li></ol> <blockquote><p>存储过程：</p> <p>将能够完成特定功能的SQL指令进行封装，编译之后存储在数据库服务器上，并且为之取一个名字，客户端可以通过名字直接调用这个SQL指令集，获取执行结果</p></blockquote> <ol start="2"><li><p>存储过程的优点：</p> <ul><li>SQL指令无需客户端重复编写，通过网络传送，可以节省网络开销，同时避免SQL指令在网络传输过程中被恶意篡改</li> <li>存储过程经过编译创建并保存在数据库中，执行过程无需重复进行编译操作</li> <li>存储过程中多个SQL指令存在逻辑关系，支持流程创建语句，可以实现更为复杂的业务</li></ul></li> <li><p>存储过程的缺点：</p> <ul><li>不同的数据库存储过程不同，切换数据库时需要重新编写</li> <li>存储过程会增加数据库的连接执行时间，不利于高并发访问</li></ul></li></ol> <h3 id="创建存储过程"><a href="#创建存储过程" class="header-anchor">#</a> 创建存储过程</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> proc_test1<span class="token punctuation">(</span><span class="token operator">IN</span> a <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token operator">IN</span> b <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">OUT</span> c <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">set</span> c <span class="token operator">=</span> a<span class="token operator">+</span>b<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="调用存储过程"><a href="#调用存储过程" class="header-anchor">#</a> 调用存储过程</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">set</span> <span class="token variable">@m</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 定义变量</span>
<span class="token keyword">call</span> proc_test1<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token variable">@m</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用存储过程</span>
<span class="token keyword">select</span> <span class="token variable">@m</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span> <span class="token comment">// 查询变量</span>
</code></pre></div><h3 id="存储过程中变量的使用"><a href="#存储过程中变量的使用" class="header-anchor">#</a> 存储过程中变量的使用</h3> <blockquote><p>存储过程中变量分为两种：局部变量和用户变量</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 局部变量</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_test2 <span class="token punctuation">(</span> <span class="token operator">IN</span> a <span class="token keyword">INT</span><span class="token punctuation">,</span> <span class="token keyword">OUT</span> r <span class="token keyword">INT</span> <span class="token punctuation">)</span> <span class="token keyword">BEGIN</span>
	<span class="token keyword">DECLARE</span> x <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">DECLARE</span> y <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">SET</span> x <span class="token operator">=</span> a <span class="token operator">*</span> a<span class="token punctuation">;</span>
	<span class="token keyword">SET</span> y <span class="token operator">=</span> a <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">SET</span> r <span class="token operator">=</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span>

<span class="token comment"># 用户变量</span>
<span class="token keyword">set</span> <span class="token variable">@m</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 定义用户变量，必须以@开头</span>
<span class="token keyword">select</span> <span class="token variable">@m</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span> <span class="token comment">// 查询变量</span>

<span class="token comment"># 查询结果赋值给变量</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> <span class="token identifier"><span class="token punctuation">`</span>proc_test3<span class="token punctuation">`</span></span><span class="token punctuation">(</span><span class="token keyword">OUT</span> c <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span>stu_num<span class="token punctuation">)</span> <span class="token keyword">INTO</span> c <span class="token keyword">from</span> students<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="存储过程的参数"><a href="#存储过程的参数" class="header-anchor">#</a> 存储过程的参数</h3> <blockquote><p>MySQL存储过程的参数一共有三种：IN / OUT / INOUT</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># IN</span>
<span class="token keyword">create</span> <span class="token keyword">procedure</span> proc_test4<span class="token punctuation">(</span><span class="token operator">IN</span> snum <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> gender <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">IN</span> age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">insert</span> <span class="token keyword">into</span> students<span class="token punctuation">(</span>stu_num<span class="token punctuation">,</span> stu_name<span class="token punctuation">,</span> stu_gender<span class="token punctuation">,</span> stu_age<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span>snum<span class="token punctuation">,</span> sname<span class="token punctuation">,</span> gender<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token comment"># INOUT</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_test6<span class="token punctuation">(</span><span class="token keyword">INOUT</span> str <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">select</span> stu_name <span class="token keyword">INTO</span> str <span class="token keyword">from</span> students <span class="token keyword">where</span> stu_name<span class="token operator">=</span>str<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="存储过程的流程控制"><a href="#存储过程的流程控制" class="header-anchor">#</a> 存储过程的流程控制</h3> <ol><li>分支语句</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># if-else</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_test8<span class="token punctuation">(</span><span class="token operator">IN</span> a <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">if</span> a<span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">then</span>
		<span class="token keyword">select</span> stu_name <span class="token keyword">from</span> students<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">select</span> class_name <span class="token keyword">from</span> classes<span class="token punctuation">;</span>
	<span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token comment"># case</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_test9<span class="token punctuation">(</span><span class="token operator">IN</span> a <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">case</span> a
	<span class="token keyword">when</span> <span class="token number">1</span> <span class="token keyword">then</span>
		<span class="token keyword">select</span> stu_name <span class="token keyword">from</span> students<span class="token punctuation">;</span>
	<span class="token keyword">when</span> <span class="token number">2</span> <span class="token keyword">then</span>
		<span class="token keyword">select</span> class_name <span class="token keyword">from</span> classes<span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token keyword">select</span> class_name <span class="token keyword">from</span> classes<span class="token punctuation">;</span>
	<span class="token keyword">end</span> <span class="token keyword">case</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><ol><li>循环语句</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># while</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_test10<span class="token punctuation">(</span><span class="token operator">IN</span> a <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">declare</span> i <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token keyword">set</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> i <span class="token operator">&lt;</span> a <span class="token keyword">do</span>
		<span class="token keyword">select</span> stu_name <span class="token keyword">from</span> students<span class="token punctuation">;</span>
		<span class="token keyword">set</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token comment"># repeat</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_test11<span class="token punctuation">(</span><span class="token operator">IN</span> a <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">declare</span> i <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token keyword">set</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">repeat</span>
		<span class="token keyword">select</span> stu_name <span class="token keyword">from</span> students<span class="token punctuation">;</span>
		<span class="token keyword">set</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	until i <span class="token operator">&gt;</span> a <span class="token keyword">end</span> <span class="token keyword">repeat</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token comment"># loop</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> proc_test12<span class="token punctuation">(</span><span class="token operator">IN</span> a <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">declare</span> i <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token keyword">set</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	myloop:<span class="token keyword">loop</span>
		<span class="token keyword">select</span> stu_name <span class="token keyword">from</span> students<span class="token punctuation">;</span>
		<span class="token keyword">set</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> i <span class="token operator">=</span> a <span class="token keyword">then</span>
			<span class="token keyword">leave</span> myloop<span class="token punctuation">;</span>
		<span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
	<span class="token keyword">end</span> <span class="token keyword">loop</span><span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="存储过程的管理"><a href="#存储过程的管理" class="header-anchor">#</a> 存储过程的管理</h3> <ol><li>查询存储过程</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 根据数据库名称查询存储过程</span>
<span class="token keyword">show</span> <span class="token keyword">procedure</span> <span class="token keyword">status</span> <span class="token keyword">where</span> db<span class="token operator">=</span><span class="token string">&quot;db_test&quot;</span><span class="token punctuation">;</span>
<span class="token comment"># 查询存储过程的细节</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">procedure</span> db_test<span class="token punctuation">.</span>proc_test1<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>修改存储过程</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">PROCEDURE</span> 存储过程名 <span class="token punctuation">[</span> 特征 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
</code></pre></div><p>特征参数：</p> <p>​	<code>CONTAINS SQL</code> 表示子程序包含 SQL 语句，但不包含读或写数据的语句。
​    <code>NO SQL</code> 表示子程序中不包含 SQL 语句。
​    <code>READS SQL DATA</code> 表示子程序中包含读数据的语句。
​    <code>MODIFIES SQL DATA</code> 表示子程序中包含写数据的语句。
​    <code>SQL SECURITY { DEFINER |INVOKER }</code> 指明谁有权限来执行，DEFINER表示只有定义者可以执行，INVOKER 表示调用者可以执行。
​    <code>DEFINER</code> 表示只有定义者自己才能够执行。
​    <code>INVOKER</code> 表示调用者可以执行。
​    <code>COMMENT 'string'</code> 表示注释信息。</p> <ol start="3"><li>删除存储过程</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">procedure</span> proc_test1<span class="token punctuation">;</span>
</code></pre></div><h3 id="游标"><a href="#游标" class="header-anchor">#</a> 游标</h3> <blockquote><p>游标可以用来依次取出查询结果集中的每条数据</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> proc_test13<span class="token punctuation">(</span><span class="token keyword">OUT</span> result <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
	<span class="token keyword">declare</span> snum <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">declare</span> sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">declare</span> num <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token keyword">declare</span> i <span class="token keyword">int</span><span class="token punctuation">;</span>
	<span class="token keyword">declare</span> str <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment"># 声明游标</span>
	<span class="token keyword">declare</span> mycursor <span class="token keyword">cursor</span> <span class="token keyword">for</span> <span class="token keyword">select</span> stu_num<span class="token punctuation">,</span>stu_name <span class="token keyword">from</span> students<span class="token punctuation">;</span>
	<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> num <span class="token keyword">from</span> students<span class="token punctuation">;</span>
	<span class="token comment"># 打开游标</span>
	<span class="token keyword">open</span> mycursor<span class="token punctuation">;</span>
	<span class="token keyword">set</span> i<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> i<span class="token operator">&lt;</span>num <span class="token keyword">do</span>
		<span class="token comment"># 使用游标</span>
		<span class="token keyword">FETCH</span> mycursor <span class="token keyword">INTO</span> snum<span class="token punctuation">,</span>sname<span class="token punctuation">;</span>
		<span class="token keyword">set</span> i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">set</span> str <span class="token operator">=</span> concat_ws<span class="token punctuation">(</span><span class="token string">&quot;~&quot;</span><span class="token punctuation">,</span> snum<span class="token punctuation">,</span> sname<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">set</span> result <span class="token operator">=</span> concat_ws<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">end</span> <span class="token keyword">while</span><span class="token punctuation">;</span>
	<span class="token comment"># 关闭游标</span>
	<span class="token keyword">close</span> mycursor<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="十、触发器"><a href="#十、触发器" class="header-anchor">#</a> 十、触发器</h2> <blockquote><p>触发器用于监听对数据表中数据的insert、delete、update操作，在触发器中通常处理一些DML的关联操作。可以使用NEW和OLD关键字在触发器中获取触发这个触发器的DML操作的数据。</p> <p>NEW：在触发器中用于获取insert操作添加的数据、update操作修改后的数据</p> <p>OLD：在触发器中用于获取delete操作删除的数据、update操作修改前的数据</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">trigger</span> <span class="token operator">&lt;</span>trigger_name<span class="token operator">&gt;</span>
before <span class="token operator">|</span> <span class="token keyword">after</span>					<span class="token comment">-- 触发时机</span>
<span class="token keyword">insert</span> <span class="token operator">|</span> <span class="token keyword">delete</span> <span class="token operator">|</span> <span class="token keyword">update</span>		<span class="token comment">-- DML类型</span>
<span class="token keyword">on</span> <span class="token operator">&lt;</span>table_name<span class="token operator">&gt;</span>					
<span class="token keyword">for each row</span>					<span class="token comment">-- 声明为行级触发器</span>
<span class="token operator">&lt;</span>sql_statement<span class="token operator">&gt;</span>					<span class="token comment">-- 触发器操作</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 创建触发器</span>
<span class="token keyword">create</span> <span class="token keyword">trigger</span> trigger_test1
<span class="token keyword">after</span> <span class="token keyword">update</span> <span class="token keyword">on</span> students <span class="token keyword">for each row</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> stulogs <span class="token punctuation">(</span><span class="token keyword">time</span><span class="token punctuation">,</span> log_text<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> concat<span class="token punctuation">(</span>OLD<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span> <span class="token string">'改为'</span><span class="token punctuation">,</span> NEW<span class="token punctuation">.</span>stu_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 查看触发器</span>
<span class="token keyword">show</span> triggers<span class="token punctuation">;</span>

<span class="token comment"># 删除触发器</span>
<span class="token keyword">drop</span> <span class="token keyword">trigger</span> trigger_test1
</code></pre></div><h2 id="十一、视图"><a href="#十一、视图" class="header-anchor">#</a> 十一、视图</h2> <h3 id="视图的概念"><a href="#视图的概念" class="header-anchor">#</a> 视图的概念</h3> <p>视图就是由数据库中一张表或者多张表根据特定的条件查询出的数据构成的虚拟表。</p> <h3 id="视图的作用"><a href="#视图的作用" class="header-anchor">#</a> 视图的作用</h3> <ul><li>安全性：如果直接将数据表授权给用户，那么用户可以CRUD数据表中的所有数据。假如想要对数据表中的部分数据进行保护，可以将公开的数据生成视图，授权用户访问视图。</li> <li>简单性：如果查询的数据来源于多张表，可以使用多表连接查询来实现；通过视图将查询的结果开放，用户则可以直接通过查询视图获取多表数据。</li></ul> <h3 id="视图的特性"><a href="#视图的特性" class="header-anchor">#</a> 视图的特性</h3> <ul><li>查询操作：如果在数据表中添加或删除了数据，视图中也会同步更新。</li> <li>新增数据：如果在视图中添加了数据，数据会被添加到原数据表中。</li> <li>删除数据：如果从视图中删除了数据，数据也将从原表中删除。</li> <li>修改操作：如果从视图中修改了数据，也将修改原数据表中的数据。</li></ul> <h3 id="视图的操作"><a href="#视图的操作" class="header-anchor">#</a> 视图的操作</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 创建视图</span>
<span class="token keyword">create</span> <span class="token keyword">view</span> view1
<span class="token keyword">as</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> records r <span class="token keyword">inner</span> <span class="token keyword">join</span> students s <span class="token keyword">inner</span> <span class="token keyword">join</span> books b
<span class="token keyword">on</span> s<span class="token punctuation">.</span>stu_num<span class="token operator">=</span>r<span class="token punctuation">.</span>snum <span class="token operator">and</span> r<span class="token punctuation">.</span>bid<span class="token operator">=</span>b<span class="token punctuation">.</span>book_id<span class="token punctuation">;</span>

<span class="token comment"># 查询视图</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> view1<span class="token punctuation">;</span>
<span class="token comment"># 查询视图结构</span>
<span class="token keyword">desc</span> view1<span class="token punctuation">;</span>

<span class="token comment"># 修改视图</span>
<span class="token keyword">alter</span> <span class="token keyword">view</span> view1
<span class="token keyword">as</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>stu_name<span class="token punctuation">,</span>b<span class="token punctuation">.</span>book_name<span class="token punctuation">,</span>r<span class="token punctuation">.</span>borrow_num <span class="token keyword">from</span> records r <span class="token keyword">inner</span> <span class="token keyword">join</span> students s <span class="token keyword">inner</span> <span class="token keyword">join</span> books b
<span class="token keyword">on</span> s<span class="token punctuation">.</span>stu_num<span class="token operator">=</span>r<span class="token punctuation">.</span>snum <span class="token operator">and</span> r<span class="token punctuation">.</span>bid<span class="token operator">=</span>b<span class="token punctuation">.</span>book_id<span class="token punctuation">;</span>

<span class="token comment"># 删除视图</span>
<span class="token keyword">drop</span> <span class="token keyword">view</span> view1<span class="token punctuation">;</span>
</code></pre></div><h2 id="十二、索引"><a href="#十二、索引" class="header-anchor">#</a> 十二、索引</h2> <h3 id="索引的介绍"><a href="#索引的介绍" class="header-anchor">#</a> 索引的介绍</h3> <p>索引就是将数据表中某一列/某几列 的值取出来构造成便于查找的结构进行存储，生成数据表的目录。</p> <p>当进行数据的查询时，则先在目录中进行查找得到对应数据的地址，然后再到数据集表中根据地址快速获取数据。</p> <h3 id="索引的分类"><a href="#索引的分类" class="header-anchor">#</a> 索引的分类</h3> <ul><li>主键索引：将字段声明为主键，会自动在组将字段创建主键索引，每张表只能有一个主键</li> <li>唯一索引：将字段声明为唯一键，会自动在唯一字段创建唯一索引</li> <li>普通索引：在普通字段上创建索引，没有唯一性限制</li> <li>组合索引：两个及以上字段联合起来创建的索引</li></ul> <h3 id="索引操作"><a href="#索引操作" class="header-anchor">#</a> 索引操作</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 创建唯一索引</span>
<span class="token keyword">create</span> <span class="token keyword">unique</span> <span class="token keyword">index</span> index1 <span class="token keyword">on</span> table1<span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 创建普通索引</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> index1 <span class="token keyword">on</span> table1<span class="token punctuation">(</span>tid<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 创建组合索引</span>
<span class="token keyword">create</span> <span class="token keyword">index</span> index1 <span class="token keyword">on</span> table1<span class="token punctuation">(</span>tid<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 全文检索</span>
<span class="token keyword">create</span> fulltext <span class="token keyword">index</span> <span class="token operator">&lt;</span>index_name<span class="token operator">&gt;</span> <span class="token keyword">on</span> 表名<span class="token punctuation">(</span>字段名<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 查看索引</span>
<span class="token keyword">show</span> indexes <span class="token keyword">from</span> <span class="token operator">&lt;</span>table_name<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment"># 删除索引</span>
<span class="token keyword">drop</span> <span class="token keyword">index</span> <span class="token operator">&lt;</span>index_name<span class="token operator">&gt;</span> <span class="token keyword">on</span> <span class="token operator">&lt;</span>table_name<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="索引的总结"><a href="#索引的总结" class="header-anchor">#</a> 索引的总结</h3> <ol><li>优点
<ul><li>索引大大降低了数据库服务器在执行查询操作时扫描的数据，提高查询效率</li> <li>索引可以避免服务器排序，将随机IO变成顺序IO</li></ul></li> <li>缺点
<ul><li>索引是根据数据表列创建的，当数据表中数据发生DML操作时，索引页需要更新</li> <li>索引文件也会占用磁盘空间</li></ul></li> <li>注意事项
<ul><li>数据表中的数据不多时，全表扫描可能更快，不要使用索引</li> <li>数据量大但DML操作频繁时，不建议使用索引</li> <li>不要在数据重复度高的列上创建索引</li> <li>创建索引之后，注意SQL的编写，避免索引失效</li></ul></li></ol> <h2 id="十三、数据库事务"><a href="#十三、数据库事务" class="header-anchor">#</a> 十三、数据库事务</h2> <blockquote><p>把完成特定业务的多个数据库DML操作步骤称为一个事务</p></blockquote> <h3 id="事务的特性"><a href="#事务的特性" class="header-anchor">#</a> 事务的特性</h3> <ul><li>原子性(<strong>A</strong>tomicity)：一个事务中的多个DML操作，要么同时执行成功，要么同时执行失败</li> <li>一致性(<strong>C</strong>onsistency)：事务执行之前和事务执行之后，数据库中的数据是一致的，完成性和一致性不能被破坏</li> <li>隔离性(<strong>I</strong>solation)：数据库允许多个事务同时执行，多个并行的事务之间不能相互影响</li> <li>持久性(<strong>D</strong>urability)：事务完成之后，对数据的操作是永久的</li></ul> <h3 id="mysql事务管理"><a href="#mysql事务管理" class="header-anchor">#</a> MySQL事务管理</h3> <ol><li><p>自动提交与手动提交</p> <ul><li>在MySQL中，默认DML指令的执行是自动提交的，当我们执行一个DML指令之后，自动同步到数据库</li></ul></li> <li><p>事务管理</p> <blockquote><p>开启事务，将关闭自动提交</p></blockquote></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 开启事务</span>
<span class="token keyword">start</span> <span class="token keyword">transaction</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> records<span class="token punctuation">(</span>snum<span class="token punctuation">,</span> bid<span class="token punctuation">,</span> borrow_num<span class="token punctuation">,</span> is_return<span class="token punctuation">,</span> borrow_date<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'0005'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> sysdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">update</span> books <span class="token keyword">set</span> book_stock<span class="token operator">=</span>book_stock<span class="token operator">-</span><span class="token number">2</span> <span class="token keyword">where</span> book_id<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>

<span class="token comment"># 回滚会结束用户的事务，并撤销正在进行的所有未提交的修改</span>
<span class="token keyword">rollback</span><span class="token punctuation">;</span>

<span class="token comment"># SAVEPOINT 允许在事务中创建一个保存点，一个事务中可以有多个 SAVEPOINT</span>
<span class="token keyword">SAVEPOINT</span> identifier<span class="token punctuation">;</span>

<span class="token comment"># 把事务回滚到标记点</span>
<span class="token keyword">ROLLBACK</span> <span class="token keyword">TO</span> identifier<span class="token punctuation">;</span>

<span class="token comment"># 提交事务</span>
<span class="token keyword">commit</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li><p>事务隔离级别</p> <blockquote><p>数据库允许多个事务并行，多个事务之间是相互隔离、相互独立的；如果事务之间不相互隔离并且操作同一数据时，可能会导致数据的一致性被破坏</p></blockquote></li></ol> <ul><li><p>读未提交(read uncommitted)：T2可以读取T1执行但未提交的数据，可能会出现脏读</p> <blockquote><p>脏读：一个事务读取到了另一个事务未提交的数据</p></blockquote></li> <li><p>读已提交(read committed)：T2只能读取T1已经提交的数据；可能导致不可重复读（虚读）</p> <blockquote><p>不可重复读：在同一事务中，两次读到的数据不一致。（第二次读取时，数据被另一个事务修改）</p></blockquote></li> <li><p>可重复读(repeatable read)：T2执行第一次查询后，在事务结束之前其他事务不能修改数据；其他事务可新增数据，造成幻读</p> <blockquote><p>幻读：T1对数据表进行修改，然后查询所有数据。在查询之前T2向数据表中新增了一条数据，导致T1以为修改了所有数据，但却查出了与修改不一致的数据</p></blockquote></li> <li><p>串行化(serializable)：同时只允许一个事务对数据表进行操作；避免了脏读、虚度、幻读问题</p></li></ul> <h3 id="设置数据库隔离级别"><a href="#设置数据库隔离级别" class="header-anchor">#</a> 设置数据库隔离级别</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment"># 查看MySQL默认隔离级别</span>
<span class="token keyword">select</span> @<span class="token variable">@transaction_isolation</span><span class="token punctuation">;</span>

<span class="token comment"># 设置MySQL默认隔离级别</span>
<span class="token keyword">set</span> <span class="token keyword">session</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> 级别<span class="token punctuation">;</span>
</code></pre></div></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/blog-pub/tags/?tag=SQL" title="标签">#SQL</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/05/26, 18:20:49</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog-pub/pages/b8598e/" class="prev">wepack配置</a></span> <span class="next"><a href="/blog-pub/pages/c6919c/">Maven</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>Esqbs</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/blog-pub/assets/js/app.c191a6e4.js" defer></script><script src="/blog-pub/assets/js/2.ddadb16d.js" defer></script><script src="/blog-pub/assets/js/3.076d2e1e.js" defer></script><script src="/blog-pub/assets/js/10.1e7d9256.js" defer></script>
  </body>
</html>
