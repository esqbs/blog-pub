<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx | Esqbs&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/blog-pub/img/favicon.ico">
    <link rel="manifest" href="/blog-pub/manifest.json">
    <link rel="apple-touch-icon" href="/blog-pub/img/avatar.png">
    <meta name="description" content="个人博客">
    <meta name="charset" content="UTF-8">
    <meta name="keywords" content="个人博客">
    <meta name="theme-color" content="#F9648D">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog-pub/assets/css/0.styles.37901d15.css" as="style"><link rel="preload" href="/blog-pub/assets/js/app.be60059c.js" as="script"><link rel="preload" href="/blog-pub/assets/js/2.e21b2ba2.js" as="script"><link rel="preload" href="/blog-pub/assets/js/3.d9d11f96.js" as="script"><link rel="preload" href="/blog-pub/assets/js/33.74b085fb.js" as="script"><link rel="prefetch" href="/blog-pub/assets/js/10.fd10d232.js"><link rel="prefetch" href="/blog-pub/assets/js/11.3699defc.js"><link rel="prefetch" href="/blog-pub/assets/js/12.106b29d9.js"><link rel="prefetch" href="/blog-pub/assets/js/13.f8a421fb.js"><link rel="prefetch" href="/blog-pub/assets/js/14.6927230b.js"><link rel="prefetch" href="/blog-pub/assets/js/15.f7d5ed72.js"><link rel="prefetch" href="/blog-pub/assets/js/16.506609f2.js"><link rel="prefetch" href="/blog-pub/assets/js/17.7eba687d.js"><link rel="prefetch" href="/blog-pub/assets/js/18.8e7afb49.js"><link rel="prefetch" href="/blog-pub/assets/js/19.8e2e00a7.js"><link rel="prefetch" href="/blog-pub/assets/js/20.4a39b560.js"><link rel="prefetch" href="/blog-pub/assets/js/21.b9082f85.js"><link rel="prefetch" href="/blog-pub/assets/js/22.101d988c.js"><link rel="prefetch" href="/blog-pub/assets/js/23.bf1f4655.js"><link rel="prefetch" href="/blog-pub/assets/js/24.5819937a.js"><link rel="prefetch" href="/blog-pub/assets/js/25.dd692870.js"><link rel="prefetch" href="/blog-pub/assets/js/26.45675e4e.js"><link rel="prefetch" href="/blog-pub/assets/js/27.714de978.js"><link rel="prefetch" href="/blog-pub/assets/js/28.74207fdc.js"><link rel="prefetch" href="/blog-pub/assets/js/29.eec92be6.js"><link rel="prefetch" href="/blog-pub/assets/js/30.950d4d8d.js"><link rel="prefetch" href="/blog-pub/assets/js/31.15fb76fc.js"><link rel="prefetch" href="/blog-pub/assets/js/32.87108bb7.js"><link rel="prefetch" href="/blog-pub/assets/js/34.62263900.js"><link rel="prefetch" href="/blog-pub/assets/js/35.76b2681a.js"><link rel="prefetch" href="/blog-pub/assets/js/36.afe38077.js"><link rel="prefetch" href="/blog-pub/assets/js/37.bb3f4354.js"><link rel="prefetch" href="/blog-pub/assets/js/38.83e0f82d.js"><link rel="prefetch" href="/blog-pub/assets/js/39.4a705868.js"><link rel="prefetch" href="/blog-pub/assets/js/4.6bd88985.js"><link rel="prefetch" href="/blog-pub/assets/js/40.5991d24d.js"><link rel="prefetch" href="/blog-pub/assets/js/41.a4761cc9.js"><link rel="prefetch" href="/blog-pub/assets/js/42.64fd65f0.js"><link rel="prefetch" href="/blog-pub/assets/js/43.da5da23b.js"><link rel="prefetch" href="/blog-pub/assets/js/44.7fbae7ea.js"><link rel="prefetch" href="/blog-pub/assets/js/45.28764809.js"><link rel="prefetch" href="/blog-pub/assets/js/46.868ac27a.js"><link rel="prefetch" href="/blog-pub/assets/js/47.d000f8fa.js"><link rel="prefetch" href="/blog-pub/assets/js/48.b5ea9a82.js"><link rel="prefetch" href="/blog-pub/assets/js/49.0bdb822d.js"><link rel="prefetch" href="/blog-pub/assets/js/5.8249d72f.js"><link rel="prefetch" href="/blog-pub/assets/js/50.183514f9.js"><link rel="prefetch" href="/blog-pub/assets/js/51.6ea40ad7.js"><link rel="prefetch" href="/blog-pub/assets/js/52.b75504cd.js"><link rel="prefetch" href="/blog-pub/assets/js/53.5e4e88a7.js"><link rel="prefetch" href="/blog-pub/assets/js/54.d6a3ead2.js"><link rel="prefetch" href="/blog-pub/assets/js/55.5287c6b3.js"><link rel="prefetch" href="/blog-pub/assets/js/56.dbb74dd5.js"><link rel="prefetch" href="/blog-pub/assets/js/57.047e093b.js"><link rel="prefetch" href="/blog-pub/assets/js/58.a61dd01c.js"><link rel="prefetch" href="/blog-pub/assets/js/59.ad2f1ef2.js"><link rel="prefetch" href="/blog-pub/assets/js/6.7d5196e7.js"><link rel="prefetch" href="/blog-pub/assets/js/60.131244e9.js"><link rel="prefetch" href="/blog-pub/assets/js/61.d85cd451.js"><link rel="prefetch" href="/blog-pub/assets/js/7.01e1ca04.js"><link rel="prefetch" href="/blog-pub/assets/js/8.5ce6b863.js"><link rel="prefetch" href="/blog-pub/assets/js/9.90487e6c.js">
    <link rel="stylesheet" href="/blog-pub/assets/css/0.styles.37901d15.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog-pub/" class="home-link router-link-active"><!----> <span class="site-name">Esqbs's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog-pub/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog-pub/note/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/blog-pub/record/" class="nav-link">日常记录</a></div><div class="nav-item"><a href="/blog-pub/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog-pub/pages/beb6c0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog-pub/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog-pub/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.dev/esqbs/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <!----> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/blog-pub/img/avatar.jpg"> <div class="blogger-info"><h3>Esqbs</h3> <span>日积月累，累累累！</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog-pub/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog-pub/note/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/blog-pub/record/" class="nav-link">日常记录</a></div><div class="nav-item"><a href="/blog-pub/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog-pub/pages/beb6c0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog-pub/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog-pub/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.dev/esqbs/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>WebApi</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具类</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>bug记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Electron</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PWA</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>图形学</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>监控上报</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>无障碍和兼容性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>代码检查</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>全景图</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Nginx</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-pub/pages/eccec1/" aria-current="page" class="active sidebar-link">Nginx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/eccec1/#nginx" class="sidebar-link">Nginx</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/eccec1/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/eccec1/#文件" class="sidebar-link">文件</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/eccec1/#配置" class="sidebar-link">配置</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/eccec1/#conf-d下的文件" class="sidebar-link">conf.d下的文件</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/eccec1/#全局变量" class="sidebar-link">全局变量</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-6"><div class="articleInfo-wrap" data-v-d5e9d2e6><div class="articleInfo" data-v-d5e9d2e6><ul class="breadcrumbs" data-v-d5e9d2e6><li data-v-d5e9d2e6><a href="/blog-pub/" title="首页" class="iconfont icon-home router-link-active" data-v-d5e9d2e6></a></li> <li data-v-d5e9d2e6><a href="/blog-pub/note/#学习笔记" data-v-d5e9d2e6>学习笔记</a></li><li data-v-d5e9d2e6><a href="/blog-pub/note/#Nginx" data-v-d5e9d2e6>Nginx</a></li></ul> <div class="info" data-v-d5e9d2e6><div title="作者" class="author iconfont icon-touxiang" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>Esqbs</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>2024-06-14</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Nginx<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="nginx"><a href="#nginx" class="header-anchor">#</a> Nginx</h2> <p><a href="https://www.nginx.org.cn/article/detail/545" target="_blank" rel="noopener noreferrer">Nginx 从入门到实践，万字详解！_SHERlocked_93的博客-NGINX开源社区<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">apt</span> udpate
$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">curl</span> gnupg2 ca-certificates lsb-release
$ <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> nginx
</code></pre></div><h2 id="文件"><a href="#文件" class="header-anchor">#</a> 文件</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>/etc/nginx/nginx.conf <span class="token comment">#主配置文件</span>
/etc/nginx/conf.d/ <span class="token comment"># 子配置文件</span>
</code></pre></div><h2 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>user nobody<span class="token punctuation">;</span> <span class="token comment"># 运行用户，默认即是nginx，可以不进行设置</span>
worker_processes <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment"># Nginx 进程数，一般设置为和 CPU 核数一样</span>
pid /run/nginx.pid<span class="token punctuation">;</span> <span class="token comment"># Nginx 服务启动时的 pid 存放位置</span>
include /etc/nginx/modules-enabled/*.conf<span class="token punctuation">;</span>

events <span class="token punctuation">{</span>
        worker_connections <span class="token number">768</span><span class="token punctuation">;</span>  <span class="token comment"># 每个进程允许最大并发数</span>
        <span class="token comment"># multi_accept on;</span>
<span class="token punctuation">}</span>

http <span class="token punctuation">{</span>

        <span class="token comment">##</span>
        <span class="token comment"># Basic Settings</span>
        <span class="token comment">##</span>

        sendfile on<span class="token punctuation">;</span>
        tcp_nopush on<span class="token punctuation">;</span>
        types_hash_max_size <span class="token number">2048</span><span class="token punctuation">;</span>
        <span class="token comment"># server_tokens off;</span>

        <span class="token comment"># server_names_hash_bucket_size 64;</span>
        <span class="token comment"># server_name_in_redirect off;</span>

        include /etc/nginx/mime.types<span class="token punctuation">;</span> <span class="token comment"># 文件扩展名与类型映射表</span>
        default_type application/octet-stream<span class="token punctuation">;</span> <span class="token comment"># 默认文件类型</span>

        <span class="token comment">##</span>
        <span class="token comment"># SSL Settings</span>
        <span class="token comment">##</span>

        ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3<span class="token punctuation">;</span> <span class="token comment"># Dropping SSLv3, ref: POODLE</span>
        ssl_prefer_server_ciphers on<span class="token punctuation">;</span>

        <span class="token comment">##</span>
        <span class="token comment"># Logging Settings</span>
        <span class="token comment">##</span>

        access_log /var/log/nginx/access.log<span class="token punctuation">;</span>
        error_log /var/log/nginx/error.log<span class="token punctuation">;</span>  <span class="token comment"># Nginx 的错误日志存放目录</span>

        <span class="token comment">##</span>
        <span class="token comment"># Gzip 压缩</span>
        <span class="token comment"># gzip_types：要采用 gzip 压缩的 MIME 文件类型，其中 text/html 被系统强制启用；</span>
		<span class="token comment"># gzip_static：默认 off，该模块启用后，Nginx 首先检查是否存在请求静态文件的 gz 结尾的文件，如果有则直接返回该 .gz 文件内容；</span>
		<span class="token comment"># gzip_proxied：默认 off，nginx做为反向代理时启用，用于设置启用或禁用从代理服务器上收到相应内容 gzip 压缩；</span>
		<span class="token comment"># gzip_vary：用于在响应消息头中添加 Vary：Accept-Encoding，使代理服务器根据请求头中的 Accept-Encoding 识别是否启用 gzip 压缩；</span>
		<span class="token comment"># gzip_comp_level：gzip 压缩比，压缩级别是 1-9，1 压缩级别最低，9 最高，级别越高压缩率越大，压缩时间越长，建议 4-6；</span>
		<span class="token comment"># gzip_buffers：获取多少内存用于缓存压缩结果，16 8k 表示以 8k*16 为单位获得；</span>
		<span class="token comment"># gzip_min_length：允许压缩的页面最小字节数，页面字节数从header头中的 Content-Length 中进行获取。默认值是 0，不管页面多大都压缩。建议设置成大于 1k 的字节数，小于 1k 可能会越压越大；</span>
		<span class="token comment"># gzip_http_version：默认 1.1，启用 gzip 所需的 HTTP 最低版本；</span>
        <span class="token comment">##</span>

        <span class="token function">gzip</span> on<span class="token punctuation">;</span>

        <span class="token comment"># gzip_vary on;</span>
        <span class="token comment"># gzip_proxied any;</span>
        <span class="token comment"># gzip_comp_level 6;</span>
        <span class="token comment"># gzip_buffers 16 8k;</span>
        <span class="token comment"># gzip_http_version 1.1;</span>
        <span class="token comment"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span>

        <span class="token comment">##</span>
        <span class="token comment"># Virtual Host Configs</span>
        <span class="token comment">##</span>

        include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span>
        include /etc/nginx/sites-enabled/*<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="conf-d下的文件"><a href="#conf-d下的文件" class="header-anchor">#</a> conf.d下的文件</h2> <blockquote><p><code>include</code> 会将conf.d下的文件包含到对应位置</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 定义转发分配规则</span>
<span class="token comment"># 1. 轮询</span>
<span class="token comment">#	* max_fails：设置在fail_timeout设置的时间内的最大失败次数</span>
<span class="token comment">#	* fail_timeout：与max_fails结合使用</span>
<span class="token comment">#	* fail_time：服务器会被认为停机的时间长度， 默认 10s</span>
<span class="token comment">#	* backup：标记该服务器为备用服务器，当主服务器停止时，请求会发送给它</span>
<span class="token comment">#	* down：标记服务器停机</span>
<span class="token comment"># 2. 权重</span>
<span class="token comment"># 3. ip_hash</span>
<span class="token comment"># 4. least_conn</span>
upstream myserver <span class="token punctuation">{</span>
    <span class="token comment"># least_conn; # 把请求分派给连接数最少的服务器</span>
    <span class="token comment"># ip_hash; # 保证每个请求固定访问一个后端服务器</span>
    server localhost:8080  <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment"># 要转发到的服务器，如ip、ip:端口号、域名、域名:端口号</span>
    server localhost:8081  <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment"># 该台服务器接受2/6的请求量</span>
    server localhost:8082  <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment"># 该台服务器接受3/6的请求量</span>
<span class="token punctuation">}</span>



server <span class="token punctuation">{</span>
	charset utf-8<span class="token punctuation">;</span>
	
  	listen <span class="token number">80</span><span class="token punctuation">;</span>
  	<span class="token comment">#server_name  www.test.com localhost;		# 匹配明确的域名（可以填多个，Nginx不会去验证DNS）</span>
	<span class="token comment">#server_name  *.test.com;					# 以 *. 开头，模糊匹配</span>
	<span class="token comment">#server_name  www.test.*;					# 以 .* 结尾</span>
	<span class="token comment">#server_name  ~^(?&lt;www&gt;.+)\.test\.com$;		# 正则表达式</span>
	<span class="token comment">#server_name  &quot;&quot;;							# 空字符串，不会匹配任何域名</span>
	server_name www.test.com<span class="token punctuation">;</span>

	<span class="token comment"># vue history</span>
	location / <span class="token punctuation">{</span>
        proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>
        root /web/front<span class="token punctuation">;</span>
        index /index.html<span class="token punctuation">;</span>
        try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
	<span class="token comment"># 后端api</span>
	<span class="token comment"># proxy_set_header Host $host;</span>
	<span class="token comment"># 将原始请求的 Host 头部信息传递给后端服务器</span>
	<span class="token comment"># proxy_set_header X-Real-IP $remote_addr;</span>
	<span class="token comment"># 设置 X-Real-IP 头部，将其值设为客户端的 IP 地址。这允许后端服务器获取到客户端的实际 IP，而不是 Nginx 服务器的 IP</span>
	<span class="token comment"># proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span>
	<span class="token comment"># 设置 X-Forwarded-For 头部，用于记录客户端的原始 IP 地址和任何中间代理服务器的 IP 地址。这对于后端服务器追踪请求的来源非常有用。</span>
	<span class="token comment"># proxy_set_header X-Forwarded-Proto $scheme;</span>
	<span class="token comment"># 设置 X-Forwarded-Proto 头部，用于告知后端服务器原始请求使用的协议（HTTP 或 HTTPS）。这对于后端服务器生成正确的 URL 或进行安全相关的决策非常重要</span>
	location  /api/ <span class="token punctuation">{</span>
            proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>
            proxy_set_header X-Real-IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
            proxy_set_header REMOTE-HOST <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
            proxy_set_header X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
			add_header Access-Control-Allow-Methods *<span class="token punctuation">;</span>
			add_header Access-Control-Allow-Origin <span class="token variable">$http_origin</span><span class="token punctuation">;</span>
            proxy_pass http://myserver<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment"># 图片缓存时间设置</span>
    location ~ .*<span class="token punctuation">\</span>.<span class="token punctuation">(</span>css<span class="token operator">|</span>js<span class="token operator">|</span>jpg<span class="token operator">|</span>png<span class="token operator">|</span>gif<span class="token operator">|</span>swf<span class="token operator">|</span>woff<span class="token operator">|</span>woff2<span class="token operator">|</span>eot<span class="token operator">|</span>svg<span class="token operator">|</span>ttf<span class="token operator">|</span>otf<span class="token operator">|</span>mp3<span class="token operator">|</span>m4a<span class="token operator">|</span>aac<span class="token operator">|</span>txt<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>
        expires 10d<span class="token punctuation">;</span> <span class="token comment"># expires -1;不缓存</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment"># 防盗链</span>
    <span class="token comment"># valid_referers 指令可以用来获取 Referer 头域中的值，并且根据该值的情况给 Nginx全局变量</span>
    <span class="token comment"># 	* none: 检测Referer头域不存在的情况</span>
	<span class="token comment"># 	* blocked： 检测Referer头域的值被防火墙或者代理服务器删除或伪装的情况。那么在这种情况下，该头域的值不以&quot;http://&quot; 或 &quot;https://&quot; 开头</span>
	<span class="token comment"># 	* server_names: 设置一个或多个URL，检测Referer头域的值是否是URL中的某个</span>
    location ~* <span class="token punctuation">\</span>.<span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>webp<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>
        <span class="token comment"># 只允许 192.168.0.1 请求资源</span>
        valid_referers none blocked <span class="token number">192.168</span>.0.1<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$invalid_referer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           rewrite ^/ http://<span class="token variable">$host</span>/logo.png<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment"># rewrite regex replacement [flag];</span>
    <span class="token comment"># rewrite：URL重写指令</span>
	<span class="token comment"># regex：用于匹配URI的正则表达式</span>
	<span class="token comment"># replacement：将regex正则匹配到的内容替换成 replacement</span>
	<span class="token comment"># flag: flag标记, 值如下</span>
	<span class="token comment"># 	* last: 本条规则匹配完成后，继续向下匹配新的location URI 规则</span>
	<span class="token comment"># 	* break: 本条规则匹配完成即终止，不再匹配后面的任何规则</span>
	<span class="token comment"># 	* redirect: 返回302临时重定向，浏览器地址会显示跳转新的URL地址</span>
	<span class="token comment"># 	* permanent: 返回301永久重定向。浏览器地址会显示跳转新的URL地址</span>
    location  /api/ <span class="token punctuation">{</span>
    		rewrite ^/api/<span class="token punctuation">(</span>.*<span class="token punctuation">)</span>$ <span class="token variable">$1</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span>
            proxy_pass http://127.0.0.1:8000<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
    location /static <span class="token punctuation">{</span>
        <span class="token builtin class-name">alias</span>	/usr/share/nginx/html/static<span class="token punctuation">;</span>  <span class="token comment"># 静态资源目录, 实际路径：alias </span>
        <span class="token comment">#root	/usr/share/nginx/html; # root 实际路径： root + location</span>

        <span class="token comment">#autoindex               on;    # off(默认)开启静态资源列目录， 上面的charset utf-8;解决乱码</span>
        <span class="token comment">#autoindex_exact_size    off;   # on(默认)显示文件的确切大小，单位是byte；off显示文件大概大小，单位KB、MB、GB</span>
        <span class="token comment">#autoindex_localtime     off;   # off(默认)时显示的文件时间为GMT时间；on显示的文件时间为服务器时间</span>
  	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token comment"># 全部转https</span>
server <span class="token punctuation">{</span>
 <span class="token comment">#SSL 默认访问端口号为 443</span>
 listen <span class="token number">443</span> ssl<span class="token punctuation">;</span>
 <span class="token comment">#请填写绑定证书的域名</span>
 server_name cloud.tencent.com<span class="token punctuation">;</span> 
 <span class="token comment">#请填写证书文件的相对路径或绝对路径</span>
 ssl_certificate  cloud.tencent.com_bundle.crt<span class="token punctuation">;</span> 
 <span class="token comment">#请填写私钥文件的相对路径或绝对路径</span>
 ssl_certificate_key cloud.tencent.com.key<span class="token punctuation">;</span> 
 ssl_session_timeout 5m<span class="token punctuation">;</span>
 <span class="token comment">#请按照以下套件配置，配置加密套件，写法遵循 openssl 标准。</span>
 ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:<span class="token operator">!</span>NULL:<span class="token operator">!</span>aNULL:<span class="token operator">!</span>MD5:<span class="token operator">!</span>ADH:<span class="token operator">!</span>RC4<span class="token punctuation">;</span>
 <span class="token comment">#请按照以下协议配置</span>
 ssl_protocols TLSv1.2 TLSv1.3<span class="token punctuation">;</span>
 ssl_prefer_server_ciphers on<span class="token punctuation">;</span>
 location / <span class="token punctuation">{</span>
   <span class="token comment">#网站主页路径。此路径仅供参考，具体请您按照实际目录操作。 </span>
   <span class="token comment">#例如，您的网站主页在 Nginx 服务器的 /etc/www 目录下，则请修改 root 后面的 html 为 /etc/www。</span>
   root html<span class="token punctuation">;</span>
   index index.html index.htm<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
server <span class="token punctuation">{</span>
 listen <span class="token number">80</span><span class="token punctuation">;</span>
 <span class="token comment">#请填写绑定证书的域名</span>
 server_name cloud.tencent.com<span class="token punctuation">;</span> 
 <span class="token comment">#把http的域名请求转成https</span>
 <span class="token builtin class-name">return</span> <span class="token number">301</span> https://<span class="token variable">$host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://cloud.tencent.com/document/product/400/6814" target="_blank" rel="noopener noreferrer">SSL 证书 免费 SSL 证书申请流程-证书申请-文档中心-腾讯云 (tencent.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://cloud.tencent.com/document/product/400/35244" target="_blank" rel="noopener noreferrer">SSL 证书 Nginx 服务器 SSL 证书安装部署（Linux）-证书安装-文档中心-腾讯云 (tencent.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="全局变量"><a href="#全局变量" class="header-anchor">#</a> 全局变量</h2> <table><thead><tr><th>全局变量名</th> <th>功能</th></tr></thead> <tbody><tr><td>$host</td> <td>请求信息中的 Host，如果请求中没有 Host 行，则等于设置的服务器名，不包含端口</td></tr> <tr><td>$request_method</td> <td>客户端请求类型，如 GET、POST</td></tr> <tr><td>$remote_addr</td> <td>客户端的 IP 地址</td></tr> <tr><td>$args</td> <td>请求中的参数</td></tr> <tr><td>$arg_PARAMETER</td> <td>GET 请求中变量名 PARAMETER 参数的值，例如：$http_user_agent(Uaer-Agent 值), $http_referer...</td></tr> <tr><td>$content_length</td> <td>请求头中的 Content-length 字段</td></tr> <tr><td>$http_user_agent</td> <td>客户端agent信息</td></tr> <tr><td>$http_cookie</td> <td>客户端cookie信息</td></tr> <tr><td>$remote_addr</td> <td>客户端的IP地址</td></tr> <tr><td>$remote_port</td> <td>客户端的端口</td></tr> <tr><td>$http_user_agent</td> <td>客户端agent信息</td></tr> <tr><td>$server_protocol</td> <td>请求使用的协议，如 HTTP/1.0、HTTP/1.1</td></tr> <tr><td>$server_addr</td> <td>服务器地址</td></tr> <tr><td>$server_name</td> <td>服务器名称</td></tr> <tr><td>$server_port</td> <td>服务器的端口号</td></tr> <tr><td>$scheme</td> <td>HTTP 方法（如http，https）</td></tr> <tr><td>$uri</td> <td>不包含请求参数的URI，也不包含主机名</td></tr> <tr><td>$status</td> <td>响应状态码</td></tr></tbody></table></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.dev/esqbs/blog" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/blog-pub/tags/?tag=Nginx" title="标签">#Nginx</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/08/27, 14:47:36</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog-pub/pages/30de7d/" class="prev">docker配置</a></span> <!----></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
	Theme by
	<a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
		| Copyright © 2022-2024
		<span>Esqbs</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/blog-pub/assets/js/app.be60059c.js" defer></script><script src="/blog-pub/assets/js/2.e21b2ba2.js" defer></script><script src="/blog-pub/assets/js/3.d9d11f96.js" defer></script><script src="/blog-pub/assets/js/33.74b085fb.js" defer></script>
  </body>
</html>
