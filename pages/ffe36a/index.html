<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>krpano | Esqbs&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/blog-pub/img/favicon.ico">
    <link rel="manifest" href="/blog-pub/manifest.json">
    <link rel="apple-touch-icon" href="/blog-pub/img/avatar.png">
    <meta name="description" content="个人博客">
    <meta name="charset" content="UTF-8">
    <meta name="keywords" content="个人博客">
    <meta name="theme-color" content="#F9648D">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog-pub/assets/css/0.styles.82307187.css" as="style"><link rel="preload" href="/blog-pub/assets/js/app.910dc6a1.js" as="script"><link rel="preload" href="/blog-pub/assets/js/2.041a1d99.js" as="script"><link rel="preload" href="/blog-pub/assets/js/3.7b2c47fd.js" as="script"><link rel="preload" href="/blog-pub/assets/js/47.9bc03339.js" as="script"><link rel="prefetch" href="/blog-pub/assets/js/10.3480e798.js"><link rel="prefetch" href="/blog-pub/assets/js/11.80fda608.js"><link rel="prefetch" href="/blog-pub/assets/js/12.0e6ead3e.js"><link rel="prefetch" href="/blog-pub/assets/js/13.c893a35c.js"><link rel="prefetch" href="/blog-pub/assets/js/14.705200d1.js"><link rel="prefetch" href="/blog-pub/assets/js/15.a732e609.js"><link rel="prefetch" href="/blog-pub/assets/js/16.70414765.js"><link rel="prefetch" href="/blog-pub/assets/js/17.c21af659.js"><link rel="prefetch" href="/blog-pub/assets/js/18.817ee3a4.js"><link rel="prefetch" href="/blog-pub/assets/js/19.ea50d890.js"><link rel="prefetch" href="/blog-pub/assets/js/20.6888a8d8.js"><link rel="prefetch" href="/blog-pub/assets/js/21.aef8e8ba.js"><link rel="prefetch" href="/blog-pub/assets/js/22.ebbf89e8.js"><link rel="prefetch" href="/blog-pub/assets/js/23.99ec2aab.js"><link rel="prefetch" href="/blog-pub/assets/js/24.b9c944c5.js"><link rel="prefetch" href="/blog-pub/assets/js/25.5ecd1d16.js"><link rel="prefetch" href="/blog-pub/assets/js/26.b555e640.js"><link rel="prefetch" href="/blog-pub/assets/js/27.49ca022b.js"><link rel="prefetch" href="/blog-pub/assets/js/28.88b8ea75.js"><link rel="prefetch" href="/blog-pub/assets/js/29.e6a26075.js"><link rel="prefetch" href="/blog-pub/assets/js/30.2252e9f8.js"><link rel="prefetch" href="/blog-pub/assets/js/31.b2df1c2d.js"><link rel="prefetch" href="/blog-pub/assets/js/32.8b319b4e.js"><link rel="prefetch" href="/blog-pub/assets/js/33.fa39dd74.js"><link rel="prefetch" href="/blog-pub/assets/js/34.293963e1.js"><link rel="prefetch" href="/blog-pub/assets/js/35.eff6e8ae.js"><link rel="prefetch" href="/blog-pub/assets/js/36.67278ad8.js"><link rel="prefetch" href="/blog-pub/assets/js/37.8967e29b.js"><link rel="prefetch" href="/blog-pub/assets/js/38.c0ab6519.js"><link rel="prefetch" href="/blog-pub/assets/js/39.0b16a533.js"><link rel="prefetch" href="/blog-pub/assets/js/4.be550cc7.js"><link rel="prefetch" href="/blog-pub/assets/js/40.cdbcf5d3.js"><link rel="prefetch" href="/blog-pub/assets/js/41.89226e94.js"><link rel="prefetch" href="/blog-pub/assets/js/42.7b0991c8.js"><link rel="prefetch" href="/blog-pub/assets/js/43.4c1b7831.js"><link rel="prefetch" href="/blog-pub/assets/js/44.8a2ca9b2.js"><link rel="prefetch" href="/blog-pub/assets/js/45.9f99c57d.js"><link rel="prefetch" href="/blog-pub/assets/js/46.6c7f2596.js"><link rel="prefetch" href="/blog-pub/assets/js/48.59a252cb.js"><link rel="prefetch" href="/blog-pub/assets/js/49.375ebd04.js"><link rel="prefetch" href="/blog-pub/assets/js/5.e9dc0c3a.js"><link rel="prefetch" href="/blog-pub/assets/js/50.5379f7ca.js"><link rel="prefetch" href="/blog-pub/assets/js/51.1d9c5d93.js"><link rel="prefetch" href="/blog-pub/assets/js/52.52b132e5.js"><link rel="prefetch" href="/blog-pub/assets/js/53.3e1a1411.js"><link rel="prefetch" href="/blog-pub/assets/js/54.1e4a6e32.js"><link rel="prefetch" href="/blog-pub/assets/js/55.19d3701e.js"><link rel="prefetch" href="/blog-pub/assets/js/56.ee1ad469.js"><link rel="prefetch" href="/blog-pub/assets/js/57.40044fa4.js"><link rel="prefetch" href="/blog-pub/assets/js/58.4d538fc3.js"><link rel="prefetch" href="/blog-pub/assets/js/59.d6984caa.js"><link rel="prefetch" href="/blog-pub/assets/js/6.8966aab5.js"><link rel="prefetch" href="/blog-pub/assets/js/7.aa00597f.js"><link rel="prefetch" href="/blog-pub/assets/js/8.55587fc2.js"><link rel="prefetch" href="/blog-pub/assets/js/9.426821e7.js">
    <link rel="stylesheet" href="/blog-pub/assets/css/0.styles.82307187.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog-pub/" class="home-link router-link-active"><!----> <span class="site-name">Esqbs's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog-pub/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog-pub/note/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/blog-pub/record/" class="nav-link">日常记录</a></div><div class="nav-item"><a href="/blog-pub/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog-pub/pages/beb6c0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog-pub/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog-pub/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.dev/esqbs/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <!----> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/blog-pub/img/avatar.jpg"> <div class="blogger-info"><h3>Esqbs</h3> <span>日积月累，累累累！</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog-pub/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog-pub/note/" class="nav-link">学习笔记</a></div><div class="nav-item"><a href="/blog-pub/record/" class="nav-link">日常记录</a></div><div class="nav-item"><a href="/blog-pub/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/blog-pub/pages/beb6c0/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog-pub/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog-pub/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog-pub/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.dev/esqbs/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>WebApi</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具类</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>bug记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Electron</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>PWA</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>图形学</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>监控上报</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>无障碍和兼容性</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>代码检查</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>全景图</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog-pub/pages/ffe36a/" aria-current="page" class="active sidebar-link">krpano</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#文件说明" class="sidebar-link">文件说明</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#下载包使用说明" class="sidebar-link">下载包使用说明</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#成果文件说明" class="sidebar-link">成果文件说明</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#载入全景" class="sidebar-link">载入全景</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#krpano-xml语法" class="sidebar-link">Krpano XML语法</a></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#krpano-xml内置元素" class="sidebar-link">Krpano XML内置元素</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#特殊属性" class="sidebar-link">特殊属性</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#krpano" class="sidebar-link">krpano</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#preview" class="sidebar-link">preview</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#image" class="sidebar-link">image</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#view" class="sidebar-link">view</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#area" class="sidebar-link">area</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#display" class="sidebar-link">display</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#control" class="sidebar-link">control</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#cursors" class="sidebar-link">cursors</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#autorotate" class="sidebar-link">autorotate</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#plugin-layer" class="sidebar-link">plugin/layer</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#hotspot" class="sidebar-link">hotspot</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#events" class="sidebar-link">events</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#action" class="sidebar-link">action</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#contextmenu" class="sidebar-link">contextmenu</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#network" class="sidebar-link">network</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#memory" class="sidebar-link">memory</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#security" class="sidebar-link">security</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#lensflareset" class="sidebar-link">lensflareset</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#lensflare" class="sidebar-link">lensflare</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#data" class="sidebar-link">data</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#scene" class="sidebar-link">scene</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#style-2" class="sidebar-link">style</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#include" class="sidebar-link">include</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#progress-废弃" class="sidebar-link">progress（废弃）</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#textstyle-废弃" class="sidebar-link">textstyle（废弃）</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#action脚本语法" class="sidebar-link">action脚本语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#语法及使用" class="sidebar-link">语法及使用</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#表达式" class="sidebar-link">表达式</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#事件" class="sidebar-link">事件</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#count" class="sidebar-link">count</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#index" class="sidebar-link">index</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#全局变量" class="sidebar-link">全局变量</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#变量、语句" class="sidebar-link">变量、语句</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#计算相关方法" class="sidebar-link">计算相关方法</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#字符处理相关" class="sidebar-link">字符处理相关</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#动画" class="sidebar-link">动画</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#动态加载" class="sidebar-link">动态加载</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#视图、相机控制" class="sidebar-link">视图、相机控制</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#坐标相关" class="sidebar-link">坐标相关</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#更新重绘" class="sidebar-link">更新重绘</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#热点添加及移除" class="sidebar-link">热点添加及移除</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#js扩展" class="sidebar-link">JS扩展</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#调试" class="sidebar-link">调试</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#文字" class="sidebar-link">文字</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#汇总" class="sidebar-link">汇总</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#常用操作" class="sidebar-link">常用操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#层级问题" class="sidebar-link">层级问题</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#音乐" class="sidebar-link">音乐</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#视频热点" class="sidebar-link">视频热点</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#全屏" class="sidebar-link">全屏</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#键盘鼠标" class="sidebar-link">键盘鼠标</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#场景" class="sidebar-link">场景</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#js通信" class="sidebar-link">JS通信</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#获取中心坐标" class="sidebar-link">获取中心坐标</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#全景视频" class="sidebar-link">全景视频</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#krpano-tools使用" class="sidebar-link">krpano tools使用</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#常用插件" class="sidebar-link">常用插件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#combobox" class="sidebar-link">Combobox</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#videoplayer" class="sidebar-link">Videoplayer</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#scrollarea" class="sidebar-link">Scrollarea</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#gyro2-新" class="sidebar-link">Gyro2（新）</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#moretweentypes-plugin" class="sidebar-link">MoreTweenTypes Plugin</a></li><li class="sidebar-sub-header level3"><a href="/blog-pub/pages/ffe36a/#gridmenu" class="sidebar-link">Gridmenu</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog-pub/pages/ffe36a/#skin-setting" class="sidebar-link">skin_setting</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-6"><div class="articleInfo-wrap" data-v-d5e9d2e6><div class="articleInfo" data-v-d5e9d2e6><ul class="breadcrumbs" data-v-d5e9d2e6><li data-v-d5e9d2e6><a href="/blog-pub/" title="首页" class="iconfont icon-home router-link-active" data-v-d5e9d2e6></a></li> <li data-v-d5e9d2e6><a href="/blog-pub/note/#学习笔记" data-v-d5e9d2e6>学习笔记</a></li><li data-v-d5e9d2e6><a href="/blog-pub/note/#全景图" data-v-d5e9d2e6>全景图</a></li></ul> <div class="info" data-v-d5e9d2e6><div title="作者" class="author iconfont icon-touxiang" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>Esqbs</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-d5e9d2e6><a href="javascript:;" data-v-d5e9d2e6>2024-04-09</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">krpano<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p>本文档基于版本1.19 pr14。
如果需要查看最新文档，请查看：<a href="https://link.segmentfault.com/?enc=OpyHyZqxS98FeBZKs1P2Qg%3D%3D.vBdeTfFBNHTQZzKP3XXTG2QUKaaqN%2FJUwoaFmnMn4BuWtl%2F5GJ0zfV5J5%2BfjdZMp" target="_blank" rel="noopener noreferrer">Krpano全景漫游开发手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
官网：<a href="https://link.segmentfault.com/?enc=qsKTpzOUxYOzXqy9NLBJZQ%3D%3D.aZL%2BjVRl5t6KEWRrIfPUpjzawFIWm3IxHiri%2BPuW%2BVs%3D" target="_blank" rel="noopener noreferrer">https://krpano.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>概念</strong></p> <p>全景漫游（英文：panorama）技术可以让体验者在全景图像构建的全景空间里切换视角的浏览。它是通过拍摄全景图像，再采用计算机图形图像技术构建出全景空间，让使用者能用控制浏览的方向，或左或右、或上或下观看物体或场景，仿佛身临其境一般。与传统的3D建模相比，全景漫游技术制作简单，数据量小，系统消耗低，且更有真实感。</p> <p>早期270°或者360°全景漫游（柱状全景）：</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092040971.png" alt=""></p> <p>720°全景漫游：</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092040373.png" alt=""></p> <p><strong>全景图</strong></p> <p>全景图（这里特指<strong>球面全景图</strong>）是指一种图片宽高比为<strong>2比1</strong>的包含了360°x180°空间的图片，例如8000*4000的jpg图片或tiff图片等。
注：宽高比2：1为水平方向（360）：垂直方向（180）</p> <p><strong>Krpano简介</strong></p> <p>krpano是一款全景漫游制作软件和工具。其具有以下特点：</p> <ul><li>高度灵活、性能卓越的轻量化全景漫游浏览器。</li> <li>兼容HTML5和Flash，支持Webgl下的WebVR展示。</li> <li>使用专用的krpano xml代码编写全景漫游，可开发出高度定制化的项目，也可利用krpano工具开发在线全景制作及展示平台。</li> <li>支持多种类型的全景图以及全景视频和环物全景。</li> <li>支持多种投影模式。</li> <li>同时提供简单高效的批处理方式，可在无需代码干预下迅速生成一个基本功能兼备的全景漫游项目。</li></ul> <p><strong>如何选择</strong></p> <p>如果只想简单展示全景，无特殊定制需求，那么可以使用默认皮肤，或者使用全景平台进行开发。
如果需要开发全景平台、定制全景功能或者对全景开发有浓厚兴趣的可以学习和深入了解krpano。</p> <p><strong>特性</strong></p> <ul><li>兼容Flash和HTML5</li> <li>高性能和高质量的渲染</li> <li>高度可定制的</li> <li>丰富的全景格式和图像文件格式的支持</li> <li>多分辨率</li> <li>三维投影</li> <li>虚拟旅游热点/脚本</li> <li>渐进式</li></ul> <p><strong>案例展示</strong></p> <p>见下载包或者<a href="https://link.segmentfault.com/?enc=WrhXjfh9fZOY7e2dONRKKQ%3D%3D.00tcMP%2BCCgCMrBlhxNemKiWcEQbLTtesxFTJvMNWRY1Fn1oH8kyxMiL%2BHTnvpW5h" target="_blank" rel="noopener noreferrer">官方网站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <hr> <h2 id="文件说明"><a href="#文件说明" class="header-anchor">#</a> 文件说明</h2> <h3 id="下载包使用说明"><a href="#下载包使用说明" class="header-anchor">#</a> 下载包使用说明</h3> <h4 id="examples文件夹"><a href="#examples文件夹" class="header-anchor">#</a> examples文件夹</h4> <p>这是krpano的案例文件夹（1.19的examples文件夹在viewer文件夹下），里面包含了官方的绝大部分案例，这些案例都是学习krpano代码的很好的素材。注意下载包的案例所使用的viewer是下载包自身的默认viewer文件夹。因为你不能简单复制案例文件夹，你还需要设置一下对应viewer的路径，而且该viewer还必须是你自己的viewer。</p> <h4 id="templates-文件夹"><a href="#templates-文件夹" class="header-anchor">#</a> templates 文件夹</h4> <p>官方一系列模版所在的文件夹，包括了图片、xml、html以及相关配置文件等。通过对这里的了解和修改，我们可以做出自己的皮肤模版，然后一键生成，实现批量的工作流。当然，正常情况下，你也无需从这里拷贝，因为在droplet过程中会自动生成。部分模版在默认droplet过程中并没有使用到。</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092041647.png" alt=""></p> <h4 id="viewer-文件夹"><a href="#viewer-文件夹" class="header-anchor">#</a> viewer 文件夹</h4> <p><img src="https://esqbs.github.io/image_store/blog/202404092041232.png" alt=""></p> <p>krpano 下载包的官方插件、引擎、案例的存放位置，同时也是让案例文件夹能够正确显示的 viewer 所在的位置。其中plugins是当前版本的所有官方插件；examples是官方提供的案例。</p> <p><strong>小贴士</strong></p> <p>自身项目的 viewer（js和swf）会在droplet过程中自动生成无需从这里拷贝</p> <h4 id="droplet-bat-文件"><a href="#droplet-bat-文件" class="header-anchor">#</a> droplet.bat 文件</h4> <p>Krpano Droplets 是krpano命令行工具加上配置文件config的一个快捷方式。droplets使用方式非常简单，将文件（通常是图片或者xml等文件）直接拖放在droplet图标上松开即可。</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092041282.jpeg" alt="">
krpano droplet （图中齿轮状图标文件）</p> <p><strong>MAKE PANO (NORMAL) Droplet</strong></p> <p>用法说明:</p> <ul><li>生成普通 (=单分辨率) 全景.</li> <li>制作典型的360度全景.</li> <li>全部全景图将会一次性载入. 默认下方块最大边长为2048像素(可以在config配置文件中修改).</li> <li>包括默认的导航皮肤.</li> <li>支持Flash和HTML5.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具.</li> <li>配置文件:normal.config</li> <li>默认模版/皮肤配置文件:defaultbuttons.skin</li></ul> <p><strong>MAKE PANO (MULTIRES) Droplet</strong></p> <p>用法说明:</p> <ul><li>生成多分辨率全景</li> <li>制作所有类型的全景</li> <li>只有特定的切片在需要时载入. 没有尺寸/分辨率限制.</li> <li>包含默认的导航皮肤.</li> <li>支持Flash和HTML5.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具.</li> <li>配置文件:multires.config</li> <li>默认模版/皮肤配置文件:defaultbuttons.skin</li></ul> <p><strong>MAKE PANO (SINGLESWF)Droplet</strong></p> <p>用法说明:</p> <ul><li>生成普通 (=单分辨率) 全景同时将所有文件嵌在一个SWF文件中.只输出一个SWF文件和一个HTML文件.</li> <li>制作典型的360度全景 .</li> <li>全部全景图将会一次性载入. 默认下方块最大变长为2048像素(可以在配置文件中修改).</li> <li>包含默认的导航皮肤.</li> <li>仅支持Flash.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具.</li> <li>配置文件:singleswf.config</li> <li>默认模版/皮肤配置文件:defaultbuttons.skin</li></ul> <p><strong>MAKE PANO (FLAT)Droplet</strong></p> <p>用法说明:</p> <ul><li>生成平面切片多分辨率图像.</li> <li>制作平面图像. 输出时既定为平面图像.</li> <li>只有特定的切片在需要时载入. 没有尺寸/分辨率限制.</li> <li>包含有默认导航按钮的皮肤，针对特定的视角.</li> <li>支持Flash与HTML5.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具</li> <li>配置文件:flat.config</li> <li>默认模版/皮肤配置文件:flat.xml / flatskin.xml</li></ul> <p><strong>MAKE VTOUR (NORMAL)Droplet</strong>
用法说明:</p> <ul><li>生成普通 (=单分辨率) 全景并将它们整合到一个虚拟漫游中.</li> <li>制作典型的360度全景.</li> <li>全部全景图将会一次性载入. 默认下方块最大边长为2048像素(可以在配置文件中修改).</li> <li>包含一个包括导航按钮、可滚动缩略图以及可选择必应地图以及重力感应插件的默认皮肤.</li> <li>支持Flash和HTML5.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具.</li> <li>配置文件:vtour-normal.config</li> <li>默认模版/皮肤配置文件:vtourskin-thumbnails-bingmaps-gyro.skin</li></ul> <p><strong>MAKE VTOUR (MULTIRES)Droplet （正常生成不考虑VR的漫游推荐使用这个dropelt）</strong></p> <p>用法说明:</p> <ul><li>生成多分辨率全景并将它们整合到一个虚拟漫游中.</li> <li>制作所有类型全景图像.</li> <li>只有特定的切片在需要时载入. 没有尺寸/分辨率限制.</li> <li>包含一个包括导航按钮、可滚动缩略图以及可选择必应地图以及重力感应插件的默认皮肤.</li> <li>支持Flash和HTML5.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具.</li> <li>配置文件:vtour-multires.config</li> <li>默认模版/皮肤配置文件:vtourskin-thumbnails-bingmaps-gyro.skin</li></ul> <p><strong>MAKE VTOUR (VR-OPT)droplet （正常生成带有VR的漫游推荐使用这个dropelt）</strong></p> <p>用法说明:</p> <ul><li>生成多分辨率全景并将它们整合到一个虚拟漫游中.</li> <li>制作所有类型全景图像.</li> <li>只有特定的切片在需要时载入. 没有尺寸/分辨率限制.</li> <li>包含一个包括导航按钮、可滚动缩略图以及可选择必应地图以及重力感应插件的默认皮肤.</li> <li>支持Flash和HTML5.</li> <li>krpano 1.19 pr9后，可生成为VR优化的全景图。如果包含立体图像的输入时，会生成针对VR使用的立体图像。</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具.</li> <li>配置文件:vtour-vr.config</li> <li>默认模版/皮肤配置文件:vtourskin-thumbnails-bingmaps-gyro.skin</li></ul> <p><strong>MAKE OBJECTDroplet</strong></p> <p>用法说明:</p> <ul><li>生成若干个平面多分辨率图像并将它们整合到一个可缩放旋转的360物体影像中.</li> <li>制作平面图像物体. 所有物体图片的尺寸必须一致.</li> <li>只有特定的切片在需要时载入. 没有尺寸/分辨率限制.</li> <li>包含一个特定的控制物体的皮肤.</li> <li>仅支持Flash.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kmakemultires工具.</li> <li>配置文件:object.config</li> <li>默认模版/皮肤配置文件:object.xml / objectskin.xml</li></ul> <p><strong>Convert SPHERE to CUBEDroplet</strong></p> <p>用法说明:</p> <ul><li>将球面图像转换至立方体图.</li> <li>输出的立方体格式、尺寸以及图像尺寸可以在配置文件中修改.</li></ul> <p>Droplet 说明:</p> <ul><li>基于ktransform 工具.</li> <li>配置文件: convertdroplets.config</li></ul> <p><strong>Convert CUBE to SPHEREDroplet</strong></p> <p>用法说明:</p> <ul><li>将六张立方体图像转换成一张球面全景图.</li> <li>输出的图像尺寸和格式可以在配置文件中修改.</li></ul> <p>Droplet 说明:</p> <ul><li>基于kcube2sphere工具.</li> <li>配置文件: convertdroplets.config</li></ul> <p><strong>Encrypt XMLDroplet</strong></p> <p>用法说明:</p> <ul><li>将xml文件拖放进droplet进行加密.</li> <li>加密过程中xml文件会自动被压缩.</li></ul> <p>Droplet 说明:</p> <ul><li>基于encrypt工具.</li></ul> <p><strong>制作自定义droplet</strong></p> <p>内置 droplets 只是针对最常见的情况的范例。制作自定义的krpano droplet是非常简单的。你只需要编辑配置文件，然后复制并重命名一个已有的krpano droplet并对droplet本身进行编辑即可。</p> <ul><li>Windows下编辑krpano droplet</li> <li>krpano droplet实际上是批处理文件 (.bat).</li> <li>可以在任意文本编辑器下进行编辑.</li> <li>用文本编辑器打开krpano droplet，将配置文件的名字和路径修改为你自己的配置文件.</li> <li>Mac OSX下编辑krpano droplet</li> <li>droplet实际上是”AppleScript Droplet’.</li> <li>可以使用 ‘Apple Script Editor’打开</li> <li>在 Apple Script Editor打开krpano droplet，将配置文件的名字和路径修改为你自己的配置文件.</li></ul> <h4 id="两个txt文件"><a href="#两个txt文件" class="header-anchor">#</a> 两个txt文件</h4> <p>krpano授权的法律声明以及版本发行说明。</p> <h4 id="krpanotools"><a href="#krpanotools" class="header-anchor">#</a> krpanotools</h4> <p>包含 32/64 位的 krpanotools32.exe 与 krpanotools64.exe，该两个文件为 krpano 项目核心，会在命令行中调用它们。</p> <h4 id="krpano-testing-server"><a href="#krpano-testing-server" class="header-anchor">#</a> krpano Testing Server</h4> <p>krpano 自带的静态文件本地服务环境，使用它可以路过本地文件案例限制来查看 Flash 与 HTML5 效果，另外它还可以控制浏览器缓存、限制下载速度模拟网络条件。</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092041123.jpeg" alt=""></p> <h4 id="krpano-tools"><a href="#krpano-tools" class="header-anchor">#</a> krpano tools</h4> <p>用来加密保护全景项目的可视化工具，需要注册才可以使用，这里就不扩展。</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092041161.jpeg" alt=""></p> <h3 id="成果文件说明"><a href="#成果文件说明" class="header-anchor">#</a> 成果文件说明</h3> <h4 id="vtour-文件夹结构"><a href="#vtour-文件夹结构" class="header-anchor">#</a> vtour 文件夹结构</h4> <p>以下是默认与比较基础文件结构与文件名，根据droplet的不同，文件可能更多或更少，同时文件名也并不一定和这些一样。</p> <div class="language- extra-class"><pre class="language-text"><code>vtour/
| -- panos/             #存放全景切片图片的文件夹
| -- skin/              #存放皮肤相关文件
| -- plugins/           #用来存放插件
| -- tour.swf           #krpano flash viewer
| -- tour.js            #krpano HTML5 viewer
| -- tour.xml           #生成全景的相关配置
| -- tour.html          #用来浏览全景的页面，需要本地服务环境
| -- tour_editor.html   #添加热点（hotspot）与初始化视角设置的编辑器
| -- tour_testingserver.exe #windows系统中打开测试服务器并打开html文件进行本地浏览。
| -- tour_testingserver_macos #mac系统中打开测试服务器并打开html文件进行本地浏览。
</code></pre></div><h4 id="vtour-运作机制"><a href="#vtour-运作机制" class="header-anchor">#</a> vtour 运作机制</h4> <p>Krpano 是通过viewer引擎来实现浏览静态图片时产生“三维”效果，而这一切则是通过tour.html这个入口文件。</p> <p>过滤掉一些没用的代码，可以看到入口文件主代码如下：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tour.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span>
    embedpano({
        swf: &quot;tour.swf&quot;, //有则表示加载flash引擎，如果设置html5:only则不需要该值
        xml: &quot;tour.xml&quot;, //启动时的配置文件
        target: &quot;pano&quot;, //要渲染到的目标容器ID
        html5: &quot;only&quot;, //如果有需要用到flash，可设置为auto
        //id: &quot;krpanoSWFObject&quot;, //默认的krpano对象，每一个viewer对应唯一id，与JS交互时要用到
        mobilescale: 1.0, //移动设备缩放，1表示不缩放，默认0.5
        passQueryParameters: false //是否接受URL传参，例如：tour.html?html5=only&amp;startscene=scene2
    });
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><img src="https://esqbs.github.io/image_store/blog/202404092042988.png" alt="图片描述"></p> <hr> <h2 id="载入全景"><a href="#载入全景" class="header-anchor">#</a> 载入全景</h2> <p><strong>引入脚本（html5渲染器）</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./tour.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>创建嵌入容器</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width:100%;height:100%;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>创建对象及配置参数</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">embedpano</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">swf</span><span class="token operator">:</span><span class="token string">&quot;krpano.swf&quot;</span><span class="token punctuation">,</span> <span class="token comment">// flash渲染器 </span>
    <span class="token literal-property property">xml</span><span class="token operator">:</span><span class="token string">&quot;krpano.xml&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 主配置文件   缺省的时候会调用krpano.xml和krpano.swf  不加载设置0即可</span>
    <span class="token literal-property property">target</span><span class="token operator">:</span><span class="token string">&quot;pano&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 嵌入容器id </span>
    <span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">&quot;krpanoSWFObject&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 当前全景id，javascript接口调用会使用此id</span>
    <span class="token literal-property property">bgcolor</span><span class="token operator">:</span><span class="token string">&quot;#000000&quot;</span><span class="token punctuation">,</span><span class="token comment">// 背景颜色 </span>
    <span class="token literal-property property">html5</span><span class="token operator">:</span><span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span> <span class="token comment">// html5模式（auto：自动；prefer：优先使用html5；fallback：优先flash；only：只使用html5；always：始终使用html5-仅用于测试；never：始终使用flash；可加上webgl或css3d渲染技术，如auto+css3d） </span>
    flash：<span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span><span class="token comment">// flash模式（auto,prefer,fallback,only,never和html设置类似） </span>
    <span class="token literal-property property">wmode</span><span class="token operator">:</span><span class="token string">&quot;window&quot;</span><span class="token punctuation">,</span><span class="token comment">// flash模式设置（window：窗口；opaque：不透明；opaque-flash：不透明，仅限flash；transparent：透明的；transparent-flash：透明的，仅限flash；direct：最佳性能，但可能不兼容旧系统和浏览器）     </span>
    <span class="token literal-property property">localfallback</span><span class="token operator">:</span><span class="token string">&quot;http://localhost:8090&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">vars</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">// 在xml加载解析后设置启动变量 </span>
    initvars：<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">// 在xml加载解析前设置启动变量，可以在地址进行查询（our.html?initvars.variable=value）</span>
    <span class="token literal-property property">basepath</span><span class="token operator">:</span><span class="token operator">...</span><span class="token comment">// 基本路径 （相对于krpano.swf）</span>
    <span class="token literal-property property">consolelog</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">// 是否在浏览器控制台打印日志信息</span>
    <span class="token literal-property property">mwheel</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 是否启用鼠标滚轮</span>
    <span class="token literal-property property">focus</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 获得焦点 </span>
    <span class="token literal-property property">webglsettings</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">preserveDrawingBuffer</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">depth</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">stencil</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//webgl设置</span>
    <span class="token literal-property property">mobilescale</span><span class="token operator">:</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token comment">// 移动设备缩放 </span>
    <span class="token literal-property property">fakedevice</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token comment">// &quot;mobile&quot;, &quot;tablet&quot;, &quot;desktop&quot;；模拟设备 （仅限测试）</span>
    <span class="token function-variable function">onready</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">// 准备就绪回调函数，一般当javascript调用krpano接口的时候，需要在此方法内</span>
    <span class="token function-variable function">onerror</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">// 错误回调函数 </span>
    <span class="token literal-property property">passQueryParameters</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 启用url查询参数（ html5, flash, wmode, mobilescale, fakedevice, initvars）作为变量传递，如tour.html?html5=only&amp;startscene=scene2&amp;initvars.design=flat</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>移除全景</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">removepano</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>官网文档：<a href="https://link.segmentfault.com/?enc=jdRAkroaEa98y7BMThkK8g%3D%3D.c3tFMSEq2h2vy9vboN%2Fb9AcRtzumC6HArmtxFE2eV%2FNEBBDh75OBQ7dDayc7GNxe" target="_blank" rel="noopener noreferrer">https://krpano.com/docu/html/...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <hr> <h2 id="krpano-xml语法"><a href="#krpano-xml语法" class="header-anchor">#</a> Krpano XML语法</h2> <p><strong>krpano xml</strong></p> <p>xml本身是一种<strong>传输格式</strong>，这意味着只能用于在krpano viewer内传输数据。当xml被解析时，xml元素才会被传输/映射到krpano的内部数据结构。这就是说当解析结束后，本质上就再也没有xml。</p> <p>krpano xml 本身是xml 语言，但有着自己特定的元素和语法。krpano xml 包括静态代码和动态代码部分。</p> <p>静态代码就是由 26 个krpano 元素（包含废弃的两个）组成的代码，它们有着自己的属性，通常属性的值都是字符串或者数字或者是布尔值，因为这些属性的默认值规定了只能用这些类型。</p> <p>相关的数值类型包括 string （字符串）、number （浮点数）、int（整数）、boolean （布尔
值， true 或者false ）。</p> <ul><li>有些属性只在 Flash 下有意义，例如<code>layer[name].smoothing</code>;</li> <li>有些属性只在 HTML 下有意义，例如<code>layer[name].jsborder</code></li> <li>有些属性是只读属性， 你不能就这样写在上面的静态代码中， 只能通过get() 来获取其数值，</li></ul> <p>如<code>layer[name].pressed 、layer[name].imagewidth 、layer[name].imageheight</code></p> <ul><li>还有一些属性是比较特别的，他们的数值类型是 Action Event 、也就是属性的数值实际上是填入动态代码，例如我们一开始遇到的<code>onclick =&quot;openurl('http://...');&quot;</code>，类似的还有几个 on 字辈的属性，像</li></ul> <div class="language- extra-class"><pre class="language-text"><code>onover =&quot;&quot;
onhover =&quot;&quot;
onout =&quot;&quot;
onclick =&quot;&quot;
ondown =&quot;&quot;
onup =&quot;&quot;
onloaded =&quot;&quot;
</code></pre></div><p><strong>xml标签/节点</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>element</span> <span class="token punctuation">/&gt;</span></span> //无子元素
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>element</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>element</span><span class="token punctuation">&gt;</span></span> //有子元素
</code></pre></div><p><strong>属性</strong></p> <p>一个xml元素可以有一个或多个属性,由属性名和属性值构成，属性值必须放在单引号或者双引号中，且属性不允许重复</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>element</span> <span class="token attr-name">attribute</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>childrenelement</span> <span class="token attr-name">test1</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">test2</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>element</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>根元素krpano</strong></p> <p>所有元素需要位于krpano元素内部</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>krpano</span> <span class="token attr-name">onstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   ...
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cube</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
   ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>krpano</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>注释</strong></p> <p>不能包含两个连字符--
<code>&lt;!-- --&gt;</code> <strong>大小写</strong>
xml元素的名称和xml属性都会被转换成小写，所以是不区分大小写的
<strong>编码</strong>
为了避免字符编码问题，所有xml文件应保存为utf-8或utf-16文件
<strong>自定义元素</strong>
krpano允许添加自定义的元素、允许在系统定义的元素中添加自定义属性，方便我们进行其它操作。krpano在载入xml文件解析静态代码时会忽略掉自定义元素。自定义的元素和属性除了语法上不能违反krpano的规定，在属性值设置上更为自由。
<strong>其他</strong>
xml元素间的空格字符空格、制表符和换行符将被忽略</p> <p>保留字，不能直接使用，需要使用转义</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092042451.png" alt="图片描述"></p> <p>出现相同name的元素后面会覆盖前面的</p> <p>注意：html5模式会比flash模式严格，两种模式均需调试</p> <hr> <p>官方文档：<a href="https://link.segmentfault.com/?enc=Z49v431QOojl7aowc5wu2Q%3D%3D.3W41qowH63exrr0R3Fg79%2BvQ9PrDh0G7OPnYs4IMH%2FCcIELUeoHM3drfDQzikhgw" target="_blank" rel="noopener noreferrer">https://krpano.com/docu/xml/s...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="krpano-xml内置元素"><a href="#krpano-xml内置元素" class="header-anchor">#</a> Krpano XML内置元素</h2> <p>krpano的XML结构</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>krpano</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>autorotate</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hotspot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>events</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scene</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>krpano</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>krpano xml中的所有xml元素和属性是可选的,可以定义多次。 当相同的元素将再次定义两个或两个以上的时候,那么以后/声明 将会覆盖之前的。</p> <p>&lt; krpano &gt; 根元素内 也可以包含&lt; krpano &gt; 元素</p> <p>xml本身只是一个 传送格式 ——这意味着它将只用于传送krpano view的数据。 当xml解析,那么xml元素将转换/映射到krpano内部数据结构。 这意味着xml解析后就没有了。</p> <p>官方文档：<a href="https://link.segmentfault.com/?enc=bVM%2Fnlwmh8HdIWpX5aPJyg%3D%3D.MCNUZrtRxzfBQpbakGP1y%2FKi501VezZIkVyXgYZDHcHKemZ0KUhZdzZBHBbzf1wz" target="_blank" rel="noopener noreferrer">https://krpano.com/docu/xml/#top<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="特殊属性"><a href="#特殊属性" class="header-anchor">#</a> 特殊属性</h3> <h4 id="name"><a href="#name" class="header-anchor">#</a> name</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>name属性 ⇒定义Array元素:</p> <p>当一个xml元素有name属性,那么这个元素将被解释为元素的Array 。 neme名字的 Array 即是该元素本身。</p> <p>当没有 Array 这个名字已经存在,它将被自动创建。</p> <p>当元素已经存在,然后被定义 xml元素将仍然创建，但会覆盖已经存在的元素。</p> <p><strong>名称属性名字规范：</strong></p> <ol><li>必须以英文字母开始，不能使用数字，汉字开始 !</li> <li>当一个名称仍以数字字符开始，然后将解释为Array索引名称。</li> <li>所有名称会自动转换成小写,允许直接不分大小写访问!</li></ol> <h4 id="url"><a href="#url" class="header-anchor">#</a> url</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>资源路径，用于引入插件、图片、音频等。</p> <p>可以根据需要使用下面的占位符：</p> <div class="language-xml extra-class"><pre class="language-xml"><code>%FIRSTXML% – 第一个载入的xml文件的路径。
%CURRENTXML% – 当前载入的主xml文件路径（非嵌入的文件）。
%SWFPATH% – viewer文件的路径。
%HTMLPATH% -html文件的路径。
%BASEDIR% – 使用basedir的路径。
%$VARIABLE% – 使用指定的“VARIABLE” – 这可以是任意的krpano变量，但必须当前xml或场景完全载入之前定义，例如已经存在于HTML文件中或在loadpano()、loadscene()调用之前。
</code></pre></div><h4 id="devices"><a href="#devices" class="header-anchor">#</a> devices</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">...</span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>childrenelement</span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>xmlelement</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>如果xml元素在某个设备渲染或者忽略，可以给该元素设置devices属性，可以设置多个。它可以在每个xml元素上设置，当xml文件将被解析并转换为krpano内部数据结构时,将会检查每个xml元素的devices属性。当当前设备不匹配devices属性,那么这个xml元素及其所有子元素将被忽略。</p> <div class="language- extra-class"><pre class="language-text"><code>+  .and.  且
|  .or.   或
！  no-   否
</code></pre></div><p>属性值（可以通过逻辑运算符组合使用）</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092042163.png" alt="图片描述"></p> <p>例子</p> <div class="language- extra-class"><pre class="language-text"><code>devices=&quot;all&quot;（默认）
devices=&quot;html5&quot;
devices=&quot;flash|webgl&quot; 
devices=&quot;flash.or.webgl&quot;
</code></pre></div><h4 id="attribute-devicecheck"><a href="#attribute-devicecheck" class="header-anchor">#</a> attribute.devicecheck</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">attribute.devicecheck</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">attribute.devicecheck</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">...</span>
            <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>可以设置不同的属性值，属性值同device</p> <div class="language- extra-class"><pre class="language-text"><code>+  .and.  且
|  .or.   或
！  no-   否
</code></pre></div><p>例子</p> <div class="language-js extra-class"><pre class="language-js"><code>scale<span class="token punctuation">.</span>normal<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> 
width<span class="token punctuation">.</span>desktop<span class="token operator">=</span><span class="token string">&quot;200&quot;</span>
visible<span class="token punctuation">.</span>fullscreensupport<span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
visible<span class="token punctuation">.</span>html5<span class="token punctuation">.</span>and<span class="token punctuation">.</span>webgl<span class="token punctuation">.</span>or<span class="token punctuation">.</span>flash<span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
visible<span class="token punctuation">.</span>html5<span class="token punctuation">.</span>and<span class="token punctuation">.</span>no<span class="token operator">-</span>webgl<span class="token operator">=</span><span class="token string">&quot;false&quot;</span>
</code></pre></div><h4 id="if"><a href="#if" class="header-anchor">#</a> if</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">...</span> <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>condition<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>childrenelement</span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>xmlelement</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>根据条件渲染元素</p> <p>例子</p> <div class="language-xml extra-class"><pre class="language-xml"><code>embedpano({..., initvars:{design:&quot;flat&quot;}, ...});
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design_default.xml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design == default<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design_flat.xml<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design == flat<span class="token punctuation">&quot;</span></span>    <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h4 id="style"><a href="#style" class="header-anchor">#</a> style</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylename<span class="token punctuation">&quot;</span></span> <span class="token attr-name">attributes</span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">...</span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylename<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>调用styleneme属性集，并应用到该元素，优先级低于行间，可用行间属性覆盖</p> <p>例子</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spotstyle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spotimage.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hotspot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spot1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spotstyle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hotspot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spot2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spotstyle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h4 id="get、calc"><a href="#get、calc" class="header-anchor">#</a> get、calc</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">attribute</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get:variable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>xmlelement</span> <span class="token attr-name">attribute</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>calc:expression<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>获取、计算属性值</p> <p>例子：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span> <span class="token attr-name">...</span> 
       <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get:settings.width<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>calc:settings.height * 2<span class="token punctuation">&quot;</span></span>
       <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h4 id="keep"><a href="#keep" class="header-anchor">#</a> keep</h4> <p>场景之间的转换时（包括场景内外的切换），layer元素、hotspot元素以及events元素是否保留，默认为false。</p> <p>注：</p> <ul><li>我们平常实际上每个项目开始时都是先从scene之外到scene内，所以一开始就有场景的切换。因此说，你写在scene外面的layer元素、hotspot元素以及event元素，你应该设置一个keep=”true”，才能够让场景切换时这些元素或事件不会移除。</li> <li>静态元素会继承父元素的keep属性；动态创建的为false，不会继承。</li></ul> <h3 id="krpano"><a href="#krpano" class="header-anchor">#</a> krpano</h3> <p>krpano 根元素,当xml进入解析数据结构阶段，会将该标签移除，你可以在当前krpano内定义另外的krpano</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;krpano version=&quot;1.19&quot;     //版本号
        onstart=&quot;&quot;         //进入漫游时，xml加载和解析后执行的动作
        basedir=&quot;%FIRSTXML%&quot; //设置程序根目录
        bgcolor=&quot;&quot;      //全景播放器的背景色，不设置则为透明
        idletime=&quot;0.5&quot;  //无用户交互操作的多长时间后执行onidle动作
        colorcorrection=&quot;default&quot; //改变Flashplayer 10的色彩修正设置(Flash only)　可选的值：default、on、off
        logkey=&quot;true&quot;     //当为Ture时，按O可查看log日志
        strict=&quot;false&quot;            //严格代码模式
        showerrors=&quot;true&quot;  //是否输出错误信息
        debugmode=&quot;false&quot;  //当为True时，显示来自插件中的trace(0,text)中的text信息
    &gt;
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>krpano</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>krpano作为XML文件唯一根元素，必须设置！</p> <p><strong>进阶提示</strong> – 当xml进入解析数据结构阶段，则主标签“krpano”将被移除。所以你可以在当前krpano标签内定义另一个krpano元素，定义新的设置或重新定义先前的设置。</p> <p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>krpano</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 仅仅使用网格预览全景(节约下载空间--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid(cube,16,16,512,0xCCCCCC,0xFFFFFF,0x999999);<span class="token punctuation">&quot;</span></span>
<span class="token attr-name">details</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>krpano</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>grid(type，xsteps，ysteps，res，lincol，bkcol，pntcol)</code> 可选参数： xsteps =行像素之间的水平距离，默认= 10 ysteps =行像素之间的垂直距离，默认= 10 res =解决 gridimage，默认= 400 lincol = hex-format 线条的颜色(默认= 0 x666666) bkcol =背景颜色(默认= 0 x222222) pntcol =点的颜色(默认= linecolor)</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>krpano</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.17<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loadscene(scene1);<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scene</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scene1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  ...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scene</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>krpano</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="preview"><a href="#preview" class="header-anchor">#</a> preview</h3> <p>preview 预览图设置，指定一张全景预览图，以便在读取过程中，过渡显示，即全景完全载入之前的模糊图像，一般自动生成</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;preview type=&quot;&quot;                   //全景图的类型（SPHERE，CYLINDER，CUBESTRIP，grid(type,xsteps,ysteps,res,linecol,bgcol,pntcol) ）
         url=&quot;previewpano.jpg&quot;  //全景图路径
         striporder=&quot;LFRBUD&quot;       //定义图像顺序
         details=&quot;16&quot;              //图像细节质量调整，越大越清晰
         /&gt;
</code></pre></div><p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_preview.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>grid(CUBE,16,16,512,0xCCCCCC,0xFFFFFF,0x999999);<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SPHERE<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spherepreview.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">details</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CUBESTRIP<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cspreview.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="image"><a href="#image" class="header-anchor">#</a> image</h3> <p>image全景图设置，包括全景图类型、渐进分辨率切片显示等</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;image type=&quot;CUBE&quot;                全景图类型（六面体）CUBE、CUBESTRIP、SPHERE、CYLINDER
       tiled=&quot;false&quot;              是否使用平铺图像
       tiledimagewidth=&quot;...&quot;      平铺图像宽度
       tiledimageheight=&quot;...&quot;     平铺图像高度
       tilesize=&quot;...&quot;             平铺图像大小
       baseindex=&quot;1&quot;              图像读取默认索引数字(第一个)
       frames=&quot;1&quot;                 当前图像帧数
       frame=&quot;1&quot;
       prealign=&quot;&quot;                prealign,采用X|Y|Z轴对齐方式
       hfov=&quot;&quot;                    水平视野
       vfov=&quot;&quot;                        垂直视野
       multires=&quot;&quot;                   多级精度
        multiresthreshold=“0.025” 
       stereo=&quot;&quot;                    立体
        stereolabels=&quot;&quot;
        stereoformat=&quot;&quot;             
        fisheye.fov=&quot;&quot;                鱼眼
    fisheye.align=&quot;&quot;
    fisheye.crop=&quot;&quot;
    fisheye.lenscp=&quot;&quot;
    voffset=“0.0” 垂直偏移度
    progressive=“false” 多分辨率加载（仅限flash）
    cubelabels=“u‘b r f l | | | | | d‘”
    sphere.mapping  定义/投影球面输入图像的映射（仅限html5）
    mjpegstream    mjpeg流(只支持HTML5和WebGL)
 &gt;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cube</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_%s.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>以上是数字索引方式读取切片图片，以下是通过定义六个方向的图片路径读取切片，文件后缀要加上_l，_f....方式来识别。
相关方法</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code>image<span class="token punctuation">.</span>layer   仅限as3 usage
image<span class="token punctuation">.</span>level<span class="token punctuation">.</span>count   只读
level<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tiledimagewidth 
level<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tiledimageheight
level<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tilesize
level<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span>aspreview
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CUBE<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">tiled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">tiledimagewidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">tiledimageheight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">tilesize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">baseindex</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">frames</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">frame</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">prealign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
 <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>left</span>  <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_l.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">flip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>front</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_f.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">flip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>right</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_r.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">flip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>back</span>  <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_b.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">flip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>up</span>    <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_u.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">flip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>down</span>  <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_d.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">flip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>例子</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cube</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_%s.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cubestrip</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cubestrip.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SPHERE<span class="token punctuation">&quot;</span></span> <span class="token attr-name">multires</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tilesize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">tiledimagewidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tiledimageheight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sphere</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_%v_%h.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CYLINDER<span class="token punctuation">&quot;</span></span> <span class="token attr-name">multires</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tilesize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">tiledimagewidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tiledimageheight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cylinder</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pano_%v_%h.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fisheye</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fisheye.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fov</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CYLINDER<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hfov</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">multires</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tilesize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">tiledimagewidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tiledimageheight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cylinder</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image_%v_%h.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">url.flash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.swf<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">url.html5</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.js<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">videourl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video.m4v|video.webm<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sphere</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>plugin:video<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="view"><a href="#view" class="header-anchor">#</a> view</h3> <p>view 元素控制全景的视野，例如起始位置、视域范围、可缩放范围、是否限制，限制观看的区域等等。当要设置限制视角或设定特定的初始视角时，需要自行设定或使用插件获取代码。</p> <p>观看方向由hlookat/vlookat属性定义，当前视场由fov属性定义。要限定部分全景的视场，可以使用limitview属性。</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;view hlookat=&quot;0.0&quot;    水平视角  -180 至  180 之间
      vlookat=&quot;0.0&quot;    垂直视角  -90  至  90  之间
      camroll=&quot;0.0&quot;    镜头旋转视角
      fovtype=&quot;VFOV&quot;   定义视场角类型

•vfov -垂直视场，基于屏幕的高度
•HFOV -水平视野，基于屏幕宽度
•DFOV -看对角线场，基于屏幕的对角线
•MFOV -最大的视场（动态混合vfov和HFOV）

注意：在手机和平板设备的默认值将MFOV！


      fov=&quot;90.0&quot;        默认视角的缩放
      hfov=&quot;&quot; 当前水平视野（只读）
    vfov=&quot;&quot; 当前垂直视野（只读）
      fovmin=&quot;1.0&quot;      默认视角缩放最大值
      fovmax=&quot;179.0&quot;    默认视角缩放最小值
      maxpixelzoom=&quot;&quot;   默认视角最大缩放倍数      
      mfovratio=&quot;1.333333&quot; 最大的屏幕尺寸的宽高比例
      distortion=&quot;0.0&quot;                鱼眼视角失真设置 0.0 至  1.0 之间（扭曲程度）
      fisheye=&quot;0.0&quot;     #鱼眼视角设置 0.0 至  1.0 之间（扭曲程度）（旧）
      distortionfovlink=&quot;0.5&quot;    fov值与鱼眼视角的关联值，默认0.5(0.0-3.0之间)
      fisheyefovlink=&quot;0.5&quot;  #fov值与鱼眼视角的关联值，默认0.5(0.0-3.0之间)（旧）
      stereographic=&quot;true&quot; 是否启动立体鱼眼投影效果（小行星）
      pannini=&quot;0.0&quot;       设置“Pannini / vedutismo”投影效果
      architectural=&quot;0.0&quot;   建筑视角设置 0.0 至  1.0 之间
      architecturalonlymiddle=&quot;true&quot;  是否只对中间区域的图像实行建筑投影
      limitview=&quot;auto&quot;    视角限制类型

•off--不限制在所有
•auto--自动限制（默认）
•lookat--限制查看变量直接“hlookatmin”，“hlookatmax”，“vlookatmin”，“vlookatmax”
•range--限制的地区设置由“hlookatmin”，“hlookatmax”，“vlookatmin”，“vlookatmax”，只有在这个范围内，允许观察
•fullrage--的地区设置由“hlookatmin”，“hlookatmax”，“vlookatmin”，“vlookatmax”，但允许放大看到整个图像
•offrange---限制的地区设置由“hlookatmin”，“hlookatmax”，“vlookatmin”，“vlookatmax”，但不以任何方式限制缩放。


      hlookatmin=&quot;&quot;   最小水平视角范围  (-180 .. +180).
      hlookatmax=&quot;&quot;   最大水平视角范围  (-180 .. +180).
      vlookatmin=&quot;&quot;   最小垂直视角范围  (-90 .. +90).
      vlookatmax=&quot;&quot;   最大垂直视角范围  (-90 .. +90).
      hlookatrange=&quot;&quot;(只读)  当前最大水平范围（等同于 hlookatmax - hlookatmin）
    vlookatrange=&quot;&quot;（只读）当前最大垂直范围(等同于vlookatmax - vlookatmin)
      /&gt;
</code></pre></div><p>默认视角的参数设置和视角限制设置</p> <p>样例：</p> <p>normal: <code>&lt;view hlookat=&quot;0&quot; vlookat=&quot;0&quot; fov=&quot;80&quot; /&gt;</code></p> <p>little planet view:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">hlookat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">vlookat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">fisheye</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">stereographic</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">fov</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">fovmax</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>flat pano:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">hlookat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">vlookat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">maxpixelzoom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">limitview</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fullrange<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="area"><a href="#area" class="header-anchor">#</a> area</h3> <p>area 全景图在浏览器中的显示区域大小， 定义全景图像展示的区域/窗口。有两种定义区域位置和尺寸的模式：</p> <ul><li>通过定义尺寸和位置 (mode=align)</li> <li>定义边界边距 (mode=border)</li></ul> <p>可在onresize事件中动态改变/调整这些设定。如果在onresize事件之外改动了area设置，那么在下一次屏幕刷新时候将会调用一个onresize事件，对于新的区域/窗口尺寸作出回应。</p> <p><strong>注意</strong> – 所有的<code>&lt;layer&gt; / &lt;plugin&gt;</code>元素都要放在这个区域内。如果要把<code>&lt;layer&gt; / &lt;plugin&gt;</code>元素放在区域外面，需设置layer/plugin的STAGE属性。</p> <p><strong>对齐方式:</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>area</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>align<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">定义区域的模式，排列align和边界border两种</span>　<span class="token attr-name">可选的值：align、border</span>
      <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lefttop<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">排列对齐时[X,Y]的坐标参考系</span>　<span class="token attr-name">可选的值：lefttop、left、leftbottom、top、center、bottom、righttop、right、rightbottom</span>
      <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">基于排列方式偏移的X坐标</span>
      <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">基于排列方式偏移的y坐标</span>
      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">区域宽度，可以是像素值也可以是百分比</span>
      <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span>          <span class="token attr-name">区域高度，可以是像素值也可以是百分比</span>
      <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p><strong>边界填充模式:</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>area</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>border<span class="token punctuation">&quot;</span></span>          <span class="token attr-name">定义区域的模式：边界</span>
      <span class="token attr-name">left</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">距左边的像素数</span>
      <span class="token attr-name">top</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">距顶部的像素数</span>
      <span class="token attr-name">right</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>              <span class="token attr-name">距右边的像素数</span>
      <span class="token attr-name">bottom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>             <span class="token attr-name">距底部的像素数</span>
      <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>样例：</p> <p><code>&lt;area align=&quot;center&quot; width=&quot;640&quot; height=&quot;480&quot; /&gt; &lt;area mode=&quot;border&quot; top=&quot;10&quot; bottom=&quot;100&quot; /&gt; &lt;area x=&quot;25%&quot; width=&quot;75%&quot; /&gt; &lt;events onresize=&quot;fixaspectresize(16,9);&quot; /&gt;</code></p> <h3 id="display"><a href="#display" class="header-anchor">#</a> display</h3> <p>*display 全景图显示品质，定义渲染的质量和性能</p> <p><strong>html5状态下显示质量设置</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;display  stereo=&quot;false&quot;  立体
         stereooverlap=&quot;0.0&quot;
            hardwarelimit=&quot;&quot;      限制只对目标硬件输出
              • Desktop(桌面) with WebGL - 4096
              • Desktop with CSS3D - 2560
              • Android / BlackBerry / Kindle / Windows Phone - 1024
              • iPad - 1024
              • iPhone (Retina) with iOS 5.1 (or higher) - 1024
              • iPhone 5/5S and higher - 1024
              • iPhone (Retina) with iOS below 5.1 - 800
              • iPod (Retina) - 640
              • iPhone / iPod Touch (Non-Retina) - 600
         usedesktopimages=&quot;&quot;    设置是否在PC桌面使用html5输出
         mipmapping=&quot;auto&quot;      定义切片输出模式，可选的值：auto、force、off
         loadwhilemoving=&quot;auto&quot; 控制在移动时平滑显示模式（auto\true\false）
         framebufferscale=&quot;1.0&quot;   调整/规模WebGL帧缓冲区的大小。
/&gt;
</code></pre></div><p><strong>flash状态下显示质量设置</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display</span> <span class="token attr-name">fps</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span>               <span class="token attr-name">flash播放时的帧速率，默认为60（30-100）</span>
         <span class="token attr-name">details</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>24<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">细碎程度,数值越高,Flash渲染越细腻(Flash</span> <span class="token attr-name">only)</span>
         <span class="token attr-name">tessmode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-1<span class="token punctuation">&quot;</span></span>          <span class="token attr-name">设置Flash材质排列方式,-1表示自动(球体时为0;立方体时为3)(Flash</span> <span class="token attr-name">only)</span>　<span class="token attr-name">可选的值：-1、1、2、3、4、5</span>
         <span class="token attr-name">movequality</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>LOW<span class="token punctuation">&quot;</span></span>      <span class="token attr-name">移动时呈现质量(Flash</span> <span class="token attr-name">only)</span>　<span class="token attr-name">可选的值：LOW、HIGH、BEST、HIGHSHARP</span>
         <span class="token attr-name">stillquality</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>HIGH<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">静止时呈现质量(Flash</span> <span class="token attr-name">only)</span>　<span class="token attr-name">可选的值：LOW、HIGH、BEST、HIGHSHARP</span>
         <span class="token attr-name">flash10</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>on<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">启动flash10渲染，该项启动后上两项（movequality、stillquality）设置无效</span>
         <span class="token attr-name">movequality10</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>HIGH<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">移动时呈现质量(Flash10使能时有效)(Flash</span> <span class="token attr-name">only)</span>　<span class="token attr-name">可选的值：LOW、HIGH、BEST、HIGHSHARP</span>
         <span class="token attr-name">stillquality10</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>HIGH<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">静止时呈现质量(Flash10使能时有效)(Flash</span> <span class="token attr-name">only)</span>　<span class="token attr-name">可选的值：LOW、HIGH、BEST、HIGHSHARP</span>
         <span class="token attr-name">sharpen</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">图像锐化程度,仅当影像品质为HIGHSHARP时有效,值域0-14(Flash</span> <span class="token attr-name">only)</span>
         <span class="token attr-name">stilltime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.25<span class="token punctuation">&quot;</span></span>       <span class="token attr-name">从</span> <span class="token attr-name">“移动改变到静止”之前的等待时间(Flash</span> <span class="token attr-name">only)</span>
         <span class="token attr-name">showpolys</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>      <span class="token attr-name">显示3D几何形状线条(Flash</span> <span class="token attr-name">only)</span>
         <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display</span> <span class="token attr-name">flash10</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span> <span class="token attr-name">details</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>28<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display</span> <span class="token attr-name">flash10</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stillquality</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>HIGHSHARP<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display</span> <span class="token attr-name">html5rendermode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iPad+Retina<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display</span> <span class="token attr-name">hardwarelimit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>512<span class="token punctuation">&quot;</span></span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Android<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display</span> <span class="token attr-name">usedesktopimages</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hardwarelimit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1800<span class="token punctuation">&quot;</span></span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iPad+Retina+iOS6<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="control"><a href="#control" class="header-anchor">#</a> control</h3> <p>control 设置鼠标、键盘及触摸设备对全景浏览的控制方式</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>control</span> <span class="token attr-name">usercontrol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>all<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">用户控制方式（all,mouse,keyb,off）</span>
         <span class="token attr-name">mouse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">控制方式（drag，moveto，drag3d（仅限flash））</span>
         <span class="token attr-name">touch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">控制方式（drag，moveto，drag3d（仅限flash））</span>
         <span class="token attr-name">dragrelative</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">参数设置</span>
         <span class="token attr-name">draginertia</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">惯性</span>
         <span class="token attr-name">dragfriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.9<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">摩擦力</span>
         <span class="token attr-name">drag_oldmode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">旧模式（html5）</span>
         <span class="token attr-name">movetorelative</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">参数设置</span>
         <span class="token attr-name">movetoaccelerate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">加速度</span>
         <span class="token attr-name">movetospeed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10.0<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">最大速度</span>
         <span class="token attr-name">movetofriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.8<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">摩擦力</span>
         <span class="token attr-name">movetoyfriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">垂直摩擦力</span>
         <span class="token attr-name">keybaccelerate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.5<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">加速度</span>
         <span class="token attr-name">keybspeed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10.0<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">速度</span>
         <span class="token attr-name">keybfriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.9<span class="token punctuation">&quot;</span></span>                    <span class="token attr-name">摩擦力</span>
         <span class="token attr-name">keybinvert</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>                    <span class="token attr-name">反转</span>
         <span class="token attr-name">keybfovchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.75<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">按钮改变视角</span>
         <span class="token attr-name">mousefovchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">鼠标滚轮改变视角</span>
         <span class="token attr-name">fovspeed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3.0<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">改变视角速度</span>
         <span class="token attr-name">fovfriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.9<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">改变摩擦力</span>
         <span class="token attr-name">zoomtocursor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">放大</span>
         <span class="token attr-name">zoomoutcursor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">缩小</span>
         <span class="token attr-name">touchzoom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">手势缩放</span>
         <span class="token attr-name">keycodesleft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>37<span class="token punctuation">&quot;</span></span>     <span class="token attr-name">左键</span>
         <span class="token attr-name">keycodesright</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>39<span class="token punctuation">&quot;</span></span> <span class="token attr-name">右键</span>
         <span class="token attr-name">keycodesup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>38<span class="token punctuation">&quot;</span></span> <span class="token attr-name">上键</span>
         <span class="token attr-name">keycodesdown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">下键</span>
         <span class="token attr-name">keycodesin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">放大键</span>
         <span class="token attr-name">keycodesout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">缩小键</span>
         <span class="token attr-name">keydownrepeat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">连续按键</span>
         <span class="token attr-name">bouncinglimits</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">反弹（仅限html5）</span>
         <span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>control</span> <span class="token attr-name">mouse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">touch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">dragrelative</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">draginertia</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">dragfriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.9<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">movetorelative</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">movetoaccelerate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">movetospeed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">movetofriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.8<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">keybaccelerate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.5<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">keybspeed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">keybfriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.9<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">keybfovchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.75<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">mousefovchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">fovspeed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">fovfriction</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.9<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">zoomtocursor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">zoomoutcursor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">touchzoom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">bouncinglimits</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token punctuation">/&gt;</span></span>
</code></pre></div><ul><li>mouse、touch</li> <li>drag - drag the pano image.</li> <li>moveto - move the pano image.</li> <li>drag3d - free-axis 3d dragging (Flash only)</li></ul> <p>鼠标键盘的控制设置</p> <p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>control</span> <span class="token attr-name">mousetype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag2D<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cursors</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag-cursors.png<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">move</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2|0|30|32<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">drag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>37|0|30|32<span class="token punctuation">&quot;</span></span>
         <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>control</span> <span class="token attr-name">mousetype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>moveto<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cursors</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>arrow-cursors.png<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4way<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">move</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>112|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">drag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>112|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>28|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_l</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>56|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_u</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>84|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="cursors"><a href="#cursors" class="header-anchor">#</a> cursors</h3> <p>cursors 鼠标光标样式
html5可以使用 standard, dragging and moving 调用系统样式，flash模式可以自定义图片</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cursors</span>  <span class="token attr-name">standard</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">标准</span>
         <span class="token attr-name">dragging</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>move<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">拖动</span>
         <span class="token attr-name">moving</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>move<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">移动</span>
        <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>            <span class="token attr-name">光标图片地址</span>
         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8way<span class="token punctuation">&quot;</span></span>       <span class="token attr-name">光标方向模式，是4个方向移动更换图片，还是8个方向移动都更换图片（drag，4way，8way）</span>
         <span class="token attr-name">move</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>           <span class="token attr-name">设定光标移动时显示图片</span>
         <span class="token attr-name">drag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>           <span class="token attr-name">设定鼠标按下时显示图片</span>
         <span class="token attr-name">arrow_l</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>        <span class="token attr-name">以下是8个方向移动时对应显示的鼠标图片</span>
         <span class="token attr-name">arrow_r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_u</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_lu</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_ru</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_ld</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_rd</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>自定义光标的样式
样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>control</span> <span class="token attr-name">mousetype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag2D<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cursors</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag-cursors.png<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>drag<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">move</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2|0|30|32<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">drag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>37|0|30|32<span class="token punctuation">&quot;</span></span>
         <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>control</span> <span class="token attr-name">mousetype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>moveto<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cursors</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>arrow-cursors.png<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4way<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">move</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>112|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">drag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>112|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_r</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_d</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>28|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_l</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>56|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">arrow_u</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>84|0|28|28<span class="token punctuation">&quot;</span></span>
         <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="autorotate"><a href="#autorotate" class="header-anchor">#</a> autorotate</h3> <p>autorotate 自动旋转</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;autorotate enabled=&quot;false&quot;     是否开启自动旋转
            waittime=&quot;1.5&quot;      用户不对屏幕操作后，开始自动旋转的等待时间
            accel=&quot;1.0&quot;         旋转加速度：角度/秒
            speed=&quot;10.0&quot;        自动旋转速度：角度/秒
            horizon=&quot;0.0&quot;      例如-45表示向上45度仰视;45表示向下45度俯视
            tofov=&quot;off&quot;         缩放到特定的视区
            zoomslowdown=&quot;true&quot;   相对于当前的缩放/视场速度，减慢自动旋转速度，以获得相同的视觉速度在所有的缩放距离。
            interruptionevents=&quot;userviewchange|layers|keyboard&quot;  定义哪些事件将中断自动旋转(以及onidle事件)，可以组合
            /&gt;
</code></pre></div><p>相关属性</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>autorotate<span class="token punctuation">.</span>isrotating  是否旋转状态（只读）
autorotate<span class="token punctuation">.</span>ispaused    是否停止状态（只读）
</code></pre></div><p>相关设置方法，事件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>autorotate<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token function">直接开始自动旋转</span><span class="token punctuation">(</span>无需等待 autorotate<span class="token punctuation">.</span>waittime<span class="token punctuation">)</span>
autorotate<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    停止当前自动旋转并且禁用它
autorotate<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 中断自动旋转，但自动旋转功能自身仍然可用，会再过 autoratate<span class="token punctuation">.</span>waittime 后自再次开始
autorotate<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    暂停自动旋转。例如当鼠标划过某个热点时就有必要让旋转暂停下来
autorotate<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 重启刚才暂停的旋转
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>onautorotatestart<span class="token punctuation">,</span> 
onautorotatestop<span class="token punctuation">,</span> 
onautorotateoneround
onautorotatechange
</code></pre></div><p>当无用户交互时．自动旋转、扭曲／移动，缩放</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">开始旋转：set</span><span class="token punctuation">(</span>autorotate<span class="token punctuation">.</span>enabled<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">停止旋转：set</span><span class="token punctuation">(</span>autorotate<span class="token punctuation">.</span>enabled<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
交替旋转：<span class="token keyword">switch</span><span class="token punctuation">(</span>autorotate<span class="token punctuation">.</span>enabled<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>autorotate</span> <span class="token attr-name">enabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>autorotate</span> <span class="token attr-name">enabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">waittime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5.0<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">speed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-3.0<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">horizon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">tofov</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>120.0<span class="token punctuation">&quot;</span></span>
            <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="plugin-layer"><a href="#plugin-layer" class="header-anchor">#</a> plugin/layer</h3> <p><strong>plugin/layer功能相同， 可以调用插件，也可插入图片或容器，类似div ，习惯系统插件用plugin，插入图片视频或容器用layer</strong></p> <p>注：parent及keep属性会自动继承父元素的对应属性</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;plugin name=&quot;...&quot;        定义引入的元素名称
       type=&quot;image&quot;       引入元素的类型，可以为image、container、text（textfield），container为容器，可在容器内继续引入多个媒体元素
       url=&quot;...&quot;          引入元素的路径（支持格式：SWF, JPG, PNG, GIF.）
       html=&quot;&quot;                显示文字时的内容
       keep=&quot;false&quot;       是否在跳入新场景时仍然保留显示该元素
       parent=&quot;&quot;          设置父容器名称，可以直接是 plugin的name,也可以是全称：parent=&quot;layer[name]&quot;或parent=&quot;hotspot[name]&quot;
       alturl=&quot;&quot;          #引入元素的路径（支持格式：SWF, JPG, PNG, GIF.），只在html5浏览器使用
       devices=&quot;all&quot;      设置显示的设备类型（详见设备列表）
       visible=&quot;true&quot;     设置插入元素是否可见
       enabled=&quot;true&quot;     设置插入元素是否接受鼠标事件
       handcursor=&quot;true&quot;  鼠标移动该元素上时，是否变为小手
       maskchildren=&quot;false&quot;  设置是否将子控件变为蒙板，设置为TRUE后，除子控件范围显示外，子控件边框与父控件边框之间区域将不显示
       scalechildren=&quot;false&quot; 设置是否子空间跟随父控件一同缩放
       zorder=&quot;&quot;              插入元素的次序索引，可以是字符也可以是数字，html5输出必须是0-100整数
       capture=&quot;true&quot;        只是该元素接受事件，false时子元素也可接受事件
       children=&quot;true&quot;    启用当前元素的子元素来接收鼠标事件。
       preload=&quot;false&quot;    预加载，在加载pano之前先加载图层/插件的url，然后执行任何操作。
       blendmode=&quot;normal&quot; 混合/混合模式（ normal, layer, screen, add, subtract, difference, multiply, overlay, lighten, darken, hardlight, invert）仅flash
       style=&quot;&quot;               调用已在文件中定义好的style的名称
       align=&quot;&quot;               元素在屏幕对齐方式，lefttop, left, leftbottom, top, center, bottom, righttop, right, rightbottom （见示意图）
       edge=&quot;&quot;                元素的边缘或描点层对齐方式，lefttop, left, leftbottom, top, center, bottom, righttop, right, rightbottom （见示意图）
       x=&quot;&quot;                   对齐边界到对齐点的X横向距离
       y=&quot;&quot;                   对齐边界到对齐点的y横向距离
       ox=&quot;&quot;                偏移
       oy=&quot;&quot;                偏移
       rotate=&quot;0.0&quot;           插入元素显示时旋转度数
       width=&quot;&quot;               插入元素的显示宽度(prop:自适应)
       height=&quot;&quot;              插入元素的显示高度
       minwidth=&quot;0&quot;
        maxwidth=&quot;0&quot;
        minheight=&quot;0&quot;
        maxheight=&quot;0&quot;
        autowidth=&quot;false&quot;  根据内容自适应宽度
        autoheight=&quot;false&quot; 根据内容自适应高度
       scale=&quot;1.0&quot;            插入元素的缩放比例
       pixelhittest=&quot;false&quot;   仅flash
       smoothing=&quot;true&quot;   平滑  仅flash
       accuracy=&quot;0&quot;         精度
       alpha=&quot;1.0&quot;            插入元素的不透明度
       autoalpha=&quot;false&quot;   自动透明度
       usecontentsize=&quot;false&quot;  满画布  仅flash
       scale9grid=&quot;&quot;    定义9格网格（scale9grid=&quot;x-position|y-position|width|height|prescale*&quot;）
       crop=&quot;&quot;                定义元素坐标及宽高  crop=&quot;x-position|y-position|width|height&quot;
       onovercrop=&quot;&quot;          设置元素鼠标移到上方后的坐标及宽高
       ondowncrop=&quot;&quot;          设置元素鼠标按下状态后的坐标及宽高
       mask=&quot;&quot;    遮罩  仅flash
       effect=&quot;&quot;    位图效果适用于层/插件的形象     仅flash
       background=&quot;&quot;  可以设置false 去掉背景
       bgcolor=&quot;0x000000&quot;      type=&quot;container&quot;状态下的背景颜色，非container状态下无效
       bgalpha=&quot;0.0&quot;           背景不透明度
       bgborder=&quot;0&quot;       （bgborder=&quot;widths color alpha&quot;）边框
       bgroundedge=&quot;0&quot;   圆角
       bgshadow=&quot;&quot;     （基本：bgshadow=&quot;xoffset yoffset blur color alpha&quot;；高级：gshadow=&quot;xoffset yoffset blur spread color alpha inset, ...&quot;）阴影
       bgcapture=&quot;false&quot;       是否捕抓在背景容器上事件（type=&quot;container&quot;状态下生效）
       onover=&quot;&quot;               鼠标在经过上方时执行动作
       onhover=&quot;&quot;              鼠标停在上方时执行动作
       onout=&quot;&quot;                鼠标停移出范围时时执行动作
       onclick=&quot;&quot;              鼠标停点击时执行动作
       ondown=&quot;&quot;               鼠标按下时执行动作
       onup=&quot;&quot;                 鼠标按键松开时执行动作
       onloaded=&quot;&quot;             加载元素完成后执行动作
    background=&quot;false&quot; 
    backgroundcolor=&quot;0xFFFFFF&quot; 
    backgroundalpha=&quot;1.0&quot;
    border=&quot;false&quot; 
    bordercolor=&quot;0x000000&quot; 
    borderalpha=&quot;1.0&quot; 
    borderwidth=&quot;1.0&quot; 
           roundedge=&quot;0&quot;
           shadow=&quot;0.0&quot; 
           shadowrange=&quot;4.0&quot; 
           shadowangle=&quot;45&quot; 
           shadowcolor=&quot;0x000000&quot; 
           shadowalpha=&quot;1.0&quot;
           textshadow=&quot;get:skin_settings.design_text_shadow&quot; 
           textshadowrange=&quot;6.0&quot; 
           textshadowangle=&quot;90&quot; 
           textshadowcolor=&quot;0x000000&quot; 
           textshadowalpha=&quot;1.0&quot;/&gt;
</code></pre></div><p><strong>相关方法</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code>layer<span class="token punctuation">.</span>layer
layer<span class="token punctuation">.</span>count   layer数量（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>index 索引（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>imagewidth  图片宽（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>imageheight（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>pixelwidth  宽（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>pixelheight 高（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>pixelx x坐标（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>pixely y坐标（只读）
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loading=“false”（只读）  是否正在加载
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loaded=“false（只读） 是否加载完成
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loadedurl（只读） 加载的url
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>hovering=“false（只读） 是否hover
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>pressed=“false（只读）  是否按下
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loader  加载器
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>sprite 
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">loadstyle</span><span class="token punctuation">(</span>stylename<span class="token punctuation">)</span>  加载属性集</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">registercontentsize</span><span class="token punctuation">(</span>width、height<span class="token punctuation">)</span>  设置宽高</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">resetsize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  尺寸改变回调</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">updatepos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 更新回调</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">changeorigin</span><span class="token punctuation">(</span>align<span class="token punctuation">,</span>edge<span class="token punctuation">)</span> 更新对齐、边缘</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">getfullpath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 返回完整路径 <span class="token punctuation">(</span>仅plugininterface<span class="token punctuation">)</span> </span>
</code></pre></div><p><strong>载入其他flash程序，图片或者按钮，图标</strong>
样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logo<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logoimage.png<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rightbottom<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>openurl('http://...');<span class="token punctuation">&quot;</span></span>
       <span class="token punctuation">/&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imagebar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100%<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>leftbottom<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0x000000<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bgalpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.5<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image1.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>left<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image2.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>left<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>110<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image3.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>left<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>210<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>layer</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>插入html标签</strong> <code>&lt;layer name=&quot;fullscreen_btn_text&quot; style=&quot;btn_text&quot; html=&quot;[h1 class='demo'] 全屏 [/h1]&quot; onclick=&quot;togglefullscreen()&quot;/&gt;</code></p> <p><img src="https://esqbs.github.io/image_store/blog/202404092042070.png" alt=""></p> <h3 id="hotspot"><a href="#hotspot" class="header-anchor">#</a> hotspot</h3> <p>热点，可在 3D 空间中插入图片，使之随着 3D 空间一同运动，可制作很多特效。</p> <ul><li>一般热点：</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;hotspot name=&quot;...&quot;              定义热点名称
         type=&quot;image&quot;            定义热点类型，image，text（textfield.）
         url=&quot;...&quot;               热点图像路径，支持SWF, JPG, PNG, GIF
         alturl=&quot;...&quot;            #html5状态下显示的图像路径
         keep=&quot;false&quot;            是否在下一场景跳转后保持显示
         renderer=&quot;webgl&quot;   渲染方式  webgl、css3d
         devices=&quot;all&quot;           支持设备类型
         visible=&quot;true&quot;          是否可见
         enabled=&quot;true&quot;          设置热点是否接收鼠标事件
         handcursor=&quot;true&quot;       设置是否鼠标移到上面显示小手
         maskchildren=&quot;false&quot;    设置是否将子控件变成蒙板
         zorder=&quot;&quot;               插入元素的次序索引，可以是字符也可以是数字，html5输出必须是0-100整数
         zorder2=&quot;0.0&quot;           （仅html5）设置为0.0和1.0，分别对应当前热点在扭曲控件之下和之上
         capture=&quot;true&quot;          与enabled配合使用，都为true只对热点传递动作，capture=&quot;false&quot;可对子控件传递动作
         children=&quot;true&quot;         设置子控件是否接收热点鼠标事件
         blendmode=&quot;normal&quot;      设置混合模式，可选：normal, layer, screen, add, subtract, difference, multiply, overlay, lighten, darken, hardlight, invert.
         mipmapping=&quot;false&quot;   热点图像应该mip-mapped期间呈现缩小时(例如避免混淆) 仅html5
         premultiplyalpha=&quot;false&quot;   透明通道   仅html5
         style=&quot;&quot;                读入已设置好的style名称
         ath=&quot;0.0&quot; atv=&quot;0.0&quot;     球坐标
         edge=&quot;center&quot;           热点的边界对齐点
         ox=&quot;0&quot;                  边界到对齐点的偏移量
         oy=&quot;0&quot;
         zoom=&quot;false&quot;            设置是否场景缩放时，热点跟随缩放
         distorted=&quot;false&quot;    设置热点是否跟随场景进行3D扭曲    
         rx=&quot;0.0&quot; ry=&quot;0.0&quot; rz=&quot;0.0&quot;  三维旋转度，distorted=&quot;true&quot;可用 
         depth=&quot;1000&quot;         深度  仅html5
         tx=&quot;0.0&quot; ty=&quot;0.0&quot; tz=&quot;0.0&quot;  三维偏移量
         details=&quot;8&quot;              热点显示的细节数量，默认为8 仅flash
         inverserotation=&quot;false&quot;  设置是否逆向旋转3D扭曲
         flying=&quot;0.0&quot;             自动设置ath/atv/scale的值，0.0-1.0，1.0热点将被锁定在屏幕中间，高度1000
         scaleflying=&quot;true&quot;   当热点从pano-space-size到screen-space-size是否缩放
         width=&quot;&quot; height=&quot;&quot;       设置热点宽高
         scale=&quot;1.0&quot;              设置热点缩放
         rotate=&quot;0.0&quot;             设置热点旋转角度
         pixelhittest=&quot;false&quot;     是否启动精确像素测试   仅flash
         smoothing=&quot;true&quot;         #设置缩放时，是否平滑化处理
         accuracy=&quot;1&quot;             设置像素渲染值（flash下）
         accuracy2=&quot;1&quot;            设置精度控制（html5下）
         alpha=&quot;1.0&quot;              设置透明度
         autoalpha=&quot;false&quot;        设置是否自动变更透明度
         usecontentsize=&quot;false&quot;   是否使用用户指定flash大小，默认false原始大小
         scale9grid=&quot;&quot;            定义是否支持矢量缩放，scale9grid=&quot;x-position|y-position|width|height|prescale*&quot;         
         stereo=&quot;&quot;                       SBS，TB  仅html5和WebGL
         crop=&quot;&quot;                  定义元素坐标及宽高  crop=&quot;x-position|y-position|width|height&quot;
         onovercrop=&quot;&quot;          设置元素鼠标移到上方后的坐标及宽高
         ondowncrop=&quot;&quot;          设置元素鼠标按下状态后的坐标及宽高
         scalechildren=&quot;false&quot;   子元素是否跟随缩放
         mask=&quot;&quot;                 #mask=&quot;name&quot;  mask=&quot;layer[name]&quot;  mask=&quot;hotspot[name]&quot;
         effect=&quot;&quot;                #热点位图效果3种：glow(color,alpha,range,strength);
                                  dropshadow(depth,angle,color,range,strength);
                                  blur(radius);

         onover=&quot;&quot;               鼠标在经过上方时执行动作
         onhover=&quot;&quot;              鼠标停在上方时执行动作
         onout=&quot;&quot;                鼠标停移出范围时时执行动作
         onclick=&quot;&quot;              鼠标停点击时执行动作
         ondown=&quot;&quot;               鼠标按下时执行动作
         onup=&quot;&quot;                 鼠标按键松开时执行动作
         onloaded=&quot;&quot;             加载元素完成后执行动作
         /&gt;
</code></pre></div><ul><li>多边形热点</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hotspot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">keep</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">visible</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">enabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">handcursor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">zorder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">capture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">blendmode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>normal<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">alpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">autoalpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">fillcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xFFFFFF<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fillcolorhover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xFFFFFF<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">填充颜色及鼠标移上后颜色</span>
         <span class="token attr-name">fillalpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fillalphahover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span>             <span class="token attr-name">填充颜色透明度及鼠标移上后颜色透明度</span>
         <span class="token attr-name">borderwidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">borderwidthhover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.0<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">边界宽度及鼠标移上后边界宽度</span>
         <span class="token attr-name">bordercolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xFFFFFF<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bordercolorhover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xFFFFFF<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">边界颜色及边界鼠标移上后颜色</span>
         <span class="token attr-name">borderalpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">borderalphahover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.8<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">边界透明度及鼠标移上后边界透明度</span>
         <span class="token attr-name">fadeintime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.15<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fadeincurve</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.1<span class="token punctuation">&quot;</span></span>               <span class="token attr-name">悬停状态变化时间及形式</span>
         <span class="token attr-name">fadeouttime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fadeoutcurve</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.7<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">polyline</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onhover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onloaded</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">ondown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>point</span> <span class="token attr-name">ath</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">atv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>            <span class="token comment">&lt;!-- 多边形热点坐标 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>point</span> <span class="token attr-name">ath</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">atv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>point</span> <span class="token attr-name">ath</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">atv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hotspot</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>可用方法</li></ul> <div class="language-stylus extra-class"><pre class="language-stylus"><code>hotspot<span class="token punctuation">.</span>count    热点个数（只读）
hotspot<span class="token punctuation">.</span>layer     <span class="token punctuation">(</span>as3 usage only<span class="token punctuation">)</span>
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>index  索引（只读）
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>point<span class="token punctuation">.</span>count   多边形点数   （只读）
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>point<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ath
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>point<span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">.</span>atv
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loading（只读）  是否正在加载
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loaded（只读） 是否加载完成
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loadedurl（只读） 加载的url
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>hovering（只读） 是否hover
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>imagewidth   （只读） 图片宽
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span>imageheight   （只读）图片高
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>pressed（只读）  是否按下
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>loader  加载器
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>sprite  雪碧图
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">loadstyle</span><span class="token punctuation">(</span>stylename<span class="token punctuation">)</span>  加载属性集</span>
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">resetsize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  尺寸改变回调</span>
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">getfullpath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 返回完整路径 <span class="token punctuation">(</span>仅plugininterface<span class="token punctuation">)</span> </span>
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">getcenter</span><span class="token punctuation">(</span>ath<span class="token punctuation">,</span>atv<span class="token punctuation">)</span> 获取中心位置 </span>
</code></pre></div><h3 id="events"><a href="#events" class="header-anchor">#</a> events</h3> <p>events 可调用各类型的事件，如载入过程中不同阶段触发的不同行为,设置事件的响应。</p> <p><strong>全局krpano事件:</strong></p> <p>一个不具有name属性的<code>&lt;events&gt;</code>元素定义的事件都是全局事件。通常只有一个全局事件。当有另一个<code>&lt;events&gt;</code>标签定义相同的事件时，之前定义的同一事件就会被覆写。</p> <p><strong>注意</strong>–当载入另一个xml文件或其他场景时，所有全局事件将保留，它们不会发生改变，除非在新的xml文件或场景中被再次定义。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>events</span>     <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">keep</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onenterfullscreen</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>          <span class="token attr-name">进入全屏时执行</span>
        <span class="token attr-name">onexitfullscreen</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>           <span class="token attr-name">退出全屏时执行</span>
        <span class="token attr-name">onxmlcomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>              <span class="token attr-name">XML文件加载完成时执行</span>
        <span class="token attr-name">onpreviewcomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>          <span class="token attr-name">预览图加载完成时执行</span>
        <span class="token attr-name">onloadcomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>             <span class="token attr-name">全景切片加载完毕时执行</span>
        <span class="token attr-name">onnewpano</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">启动新的全景场景时执行</span>
        <span class="token attr-name">onremovepano</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>               <span class="token attr-name">场景被移除时执行（加载新场景前）</span>
        <span class="token attr-name">onnewscene</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                 <span class="token attr-name">新场景加载完成时执行</span>
        <span class="token attr-name">onloaderror</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                <span class="token attr-name">加载错误时执行，执行被设置后，屏幕将不显示默认的错误信息</span>
        <span class="token attr-name">onkeydown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">键盘按下时执行</span>
        <span class="token attr-name">onkeyup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                    <span class="token attr-name">键盘抬起时执行</span>
        <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                    <span class="token attr-name">鼠标点击时执行</span>
        <span class="token attr-name">onsingleclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>            <span class="token attr-name">单击</span>
        <span class="token attr-name">ondoubleclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>             <span class="token attr-name">双击</span>
        <span class="token attr-name">onmousedown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                <span class="token attr-name">当鼠标按下时执行</span>
        <span class="token attr-name">onmouseup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">当鼠标松开时执行</span>
        <span class="token attr-name">onmousewheel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>               <span class="token attr-name">当鼠标滚轮滚动时执行</span>
        <span class="token attr-name">oncontextmenu</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">右键菜单</span>
        <span class="token attr-name">onidle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                     <span class="token attr-name">无交互空闲时执行</span>
        <span class="token attr-name">onviewchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>               <span class="token attr-name">场景视图改变时执行（渲染开始时）</span>
        <span class="token attr-name">onviewchanged</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>              <span class="token attr-name">场景视图改变后执行（渲染完成时）</span>
        <span class="token attr-name">onresize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                   <span class="token attr-name">全景尺寸改变时执行</span>
        <span class="token attr-name">onautorotatestart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>    <span class="token attr-name">自动旋转开始时执行</span>
        <span class="token attr-name">onautorotatestop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>    <span class="token attr-name">自动旋转停止时执行</span>
        <span class="token attr-name">onautorotateoneround</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">自动旋转一圈时执行</span>
        <span class="token attr-name">onautorotatechange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>  <span class="token attr-name">自动旋转状态改变时执行</span>
        <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p><strong>独立局部krpano事件:</strong></p> <p>一个具有name属性的<code>&lt;events&gt;</code>元素定义的事件都是独立事件。它可以包含所有类型的事件，但它们不会覆写全局事件，它们是另外进行调用的。这些被“命名”的<code>&lt;events&gt;</code>元素同样具有keep属性（默认值为false）。这意味着没有keep=”true”的<code>&lt;events&gt;</code>元素在新全景载入时将会被自动移除。</p> <p><strong>提示</strong>–命名的事件能够在不影响其他插件或xml代码的基础下在独立的插件和代码中发生作用。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>events</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">keep</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">...</span> <span class="token attr-name">any</span> <span class="token attr-name">events</span> <span class="token attr-name">...</span>
        <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="action"><a href="#action" class="header-anchor">#</a> action</h3> <p>action自定义动态代码，类似js中的function 需要时才载入</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>   
<span class="token attr-name">autorun</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>    <span class="token attr-name">在开始自动运行</span>
<span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>global<span class="token punctuation">&quot;</span></span> <span class="token attr-name">(</span> <span class="token attr-name">global,local,parent</span> <span class="token attr-name">)</span> <span class="token attr-name">作用域类型</span> 
<span class="token attr-name">args</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>        <span class="token attr-name">参数列表</span>
<span class="token attr-name">secure</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">安全将被设置为true时,行动将由Javascript调用接口,</span> <span class="token attr-name">即使是禁用Javascript接口。</span> 
<span class="token attr-name">protect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>   <span class="token attr-name">保护</span>   <span class="token attr-name">为true变量将无法访问</span>
<span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>   secure为是否支持JS接口调用
    action1();         动作函数名称();
    action2();
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>参数传递的两种方式：</strong></p> <ol><li><p>%占位符（所有版本可用）</p> <div class="language- extra-class"><pre class="language-text"><code>参数可以使用“%数字” 占位符来表示，范围为  %0-%99，    %0表示action本身的名字，%1为第一个参数，%2为第二个，以此类推，在代码被解析和执行的时候占位符会被传入的值替代，如果没有传入参数，将会使用“0”替代（%0除外，它始终是表示action本身的名字），使用%符号用%%替代。
</code></pre></div><ol><li>args变量映射（1.19-pr13+可用）。</li> <li>可以用caller占位符来代替调用者，<code>如caller.linkedscene等价linkedscene</code></li></ol></li></ol> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>local<span class="token punctuation">&quot;</span></span> <span class="token attr-name">args</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>var1, var2, var3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  showlog();
  trace('var1=',get(var1));
  trace('var2=',get(var2));
  trace('var3=',get(var3));
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>使用未传递的参数，将使用‘0’代替，每个参数将映射到action内部的一个新变量，在使用包含引号或逗号字符的值时，使用变量映射方式非常有用。在这种情况下，%占位符方式可能有问题。</p> <p><strong>使用javascript</strong></p> <p>通过JavaScript操作，可以直接为动作代码使用JavaScript代码。对于更复杂的事物，这可能更快，但仅可在html5中使用</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 使用js，仅限html5 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[
    ...
    Javascript code
    ...
]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>定义行为．需要用脚本语言解释器解释</p> <p>可用方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>action<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>content   获取内容
action<span class="token punctuation">.</span>count    获取数量 只读
</code></pre></div><p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>krpano</span> <span class="token attr-name">onstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>intro();<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  ...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>intro<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    lookat(0,0,90);
    wait(LOAD);
    lookto(120,10,110);
    lookto(-50,40,110);
    lookto(0,0,90);
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
  ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>krpano</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>overaction<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  tween(scale, 2.0);
  tween(alpha, 1.0);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pic1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...</span>
        <span class="token attr-name">onover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>overaction();<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>outaction();<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="contextmenu"><a href="#contextmenu" class="header-anchor">#</a> contextmenu</h3> <p>contextmenu 自定义右键菜单</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>contextmenu</span> <span class="token attr-name">fullscreen</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">是否显示[全屏]菜单项</span>
             <span class="token attr-name">native</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>               <span class="token attr-name">是否使用本地菜单方式，为False时将启用HTML5兼容菜单模式。(Flash</span> <span class="token attr-name">only)</span>
             <span class="token attr-name">versioninfo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">是否显示krPano</span> <span class="token attr-name">Viewer及Flash</span> <span class="token attr-name">Player版本信息</span>
             <span class="token attr-name">touch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">在触摸设备上是否可用</span>
             <span class="token attr-name">customstyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>         <span class="token attr-name">自定义菜单风格（仅html5）customstyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>font|fontsize|lineheight|backgroundcolor|textcolor|disabled-textcolor|borderwidth|bordercolor|borderradius|shadow-x-offset|shadow-y-offset|shadow-blur-range|shadow-color|innerborder|innerbordercolor|padding-top|padding-bottom|seperator-margin|seperator-color|seperator-second-line-color|item-padding|item-borderwidth|item-bordercolor|item-borderradius|item-margin|item-hover-backgroundcolor|item-hover-bordercolor|item-hover-textcolor|item-text-left-margin|item-text-right-margin<span class="token punctuation">&quot;</span></span>
             <span class="token attr-name">enterfs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Fullscreen<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">进入全屏菜单文字</span>
             <span class="token attr-name">exitfs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Exit Fullscreen<span class="token punctuation">&quot;</span></span>     <span class="token attr-name">退出全屏菜单文字</span>
             <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">自定义项目名称</span>
          <span class="token attr-name">caption</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>             <span class="token attr-name">显示的标题</span>
          <span class="token attr-name">enabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">是否点击生效</span>
          <span class="token attr-name">visible</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">是否可见</span>
          <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">是否显示分隔条</span>
          <span class="token attr-name">showif</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>         <span class="token attr-name">showif</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>view.vlookatrange GE 180<span class="token punctuation">&quot;</span></span> <span class="token attr-name">本item只在该条件为真显示</span>
          <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>             <span class="token attr-name">点击后执行</span>
          <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">caption</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
          <span class="token punctuation">/&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>contextmenu</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>相关方法：
<code>contextmenu.item.count</code></p> <h3 id="network"><a href="#network" class="header-anchor">#</a> network</h3> <p>network 图像下载、缓存与解码</p> <div class="language-abnf extra-class"><pre class="language-abnf"><code>&lt;network  <span class="token rule">retrycount</span><span class="token operator">=</span><span class="token string">&quot;2&quot;</span>               当服务器或网络故障时，在提示出错信息前的重试次数
         <span class="token operator">/</span>&gt;
</code></pre></div><h3 id="memory"><a href="#memory" class="header-anchor">#</a> memory</h3> <p>memory 内存分配，单位兆</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memory</span> <span class="token attr-name">maxmem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>    <span class="token attr-name">最大内存分配</span>
        <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">设备</span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>maxmem默认设置：</p> <div class="language- extra-class"><pre class="language-text"><code>Flash: 350 MB
HTML5
Desktop: 150-400 MB (depending on the full screen size)
Tablet / Mobile: 50 MB (Android, Windows, Silk, Blackberry, ...)
iOS (before 7.1): 40 MB
iOS (7.1 and above): 50 MB
iPhone 4/4S: 40 MB
</code></pre></div><p>设置内存使用情况</p> <p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memory</span> <span class="token attr-name">maxmem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>350<span class="token punctuation">&quot;</span></span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Desktop+Flash<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memory</span> <span class="token attr-name">maxmem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Desktop+HTML5<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memory</span> <span class="token attr-name">maxmem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Mobile|Tablet<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memory</span> <span class="token attr-name">maxmem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iOS<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>memory</span> <span class="token attr-name">maxmem</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iOS7.1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="security"><a href="#security" class="header-anchor">#</a> security</h3> <p>security flashplayer和html5相关的安全/跨域设置</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>security</span> <span class="token attr-name">cors</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>                                             设置是否开启跨网络认证，off\anonymous\use-credentials
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>crossdomainxml</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>       设置加载文件的url    （仅flash）
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allowdomain</span> <span class="token attr-name">domain</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>              允许被访问的域名设置    只读
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>security</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="lensflareset"><a href="#lensflareset" class="header-anchor">#</a> lensflareset</h3> <p>定义一个镜头光晕样式，用于lensflare 元素调用（仅限flash）</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lensflareset</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.<span class="token punctuation">&quot;</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%SWFPATH%/krpano_default_flares.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>    定义样式名称，指定灯光照片
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>flare</span> <span class="token attr-name">pixsize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>128<span class="token punctuation">&quot;</span></span>          <span class="token attr-name">耀斑大小设置</span>
           <span class="token attr-name">pixupos</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">耀斑水平像素位置</span>
           <span class="token attr-name">pixvpos</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">耀斑垂直像素位置</span>
           <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xFFFFFF<span class="token punctuation">&quot;</span></span>       <span class="token attr-name">耀斑颜色</span>
           <span class="token attr-name">pos</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>              <span class="token attr-name">耀斑起始位置</span>
           <span class="token attr-name">scale</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">耀斑相对于屏幕的大小比值（0.01-0.10）</span>
           <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>flare</span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>flare</span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>lensflareset</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>相关方法：</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code>lensflareset<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>index
lensflareset<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>flare<span class="token punctuation">.</span>count
lensflareset<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>flare<span class="token punctuation">[</span>…<span class="token punctuation">]</span><span class="token punctuation">.</span>index
</code></pre></div><h3 id="lensflare"><a href="#lensflare" class="header-anchor">#</a> lensflare</h3> <p>定义一个镜头光晕（仅限flash）</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>lensflare</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>               <span class="token attr-name">定义名称</span>
           <span class="token attr-name">set</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEFAULT<span class="token punctuation">&quot;</span></span>            <span class="token attr-name">设置默认样式，还是已定义的lensflareset样式</span>
           <span class="token attr-name">visible</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">是否可见</span>
           <span class="token attr-name">keep</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>             <span class="token attr-name">是否在场景切换时持续显示</span>
           <span class="token attr-name">ath</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">全景中球体坐标的水平位置</span>
           <span class="token attr-name">atv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">全景中球体坐标的垂直位置</span>
           <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.8<span class="token punctuation">&quot;</span></span>               <span class="token attr-name">耀斑大小设置</span>
           <span class="token attr-name">blind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.6<span class="token punctuation">&quot;</span></span>              <span class="token attr-name">耀斑盲点大小</span>
           <span class="token attr-name">blindcurve</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.0<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">耀斑曲线强度设置</span>
           <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>相关方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>lensflare<span class="token punctuation">.</span>count
lensflare<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>index
</code></pre></div><h3 id="data"><a href="#data" class="header-anchor">#</a> data</h3> <p>data 可以放置任何数据，krpano不会解析其内容，整个data元素的内容将被存储在<code>data[neme]</code>对象中。需要时才载入</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token operator">&lt;</span><span class="token keyword">data</span> <span class="token hvariable">name</span><span class="token operator">=</span><span class="token string">&quot;...&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">...</span>
<span class="token operator">&lt;/</span><span class="token keyword">data</span><span class="token operator">&gt;</span>
</code></pre></div><p>避免xml解析CDATA:</p> <div class="language-xml extra-class"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[
    ...
]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>data</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>所有data元素的个数 <code>data.count</code></li> <li>索引 <code>data[name].index</code></li> <li>内容<code>data[name].content</code></li></ul> <p>CDATA避免xml解析,包裹的内容不会被解析:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token cdata">&lt;![CDATA[
    ...
]]&gt;</span>
</code></pre></div><h3 id="scene"><a href="#scene" class="header-anchor">#</a> scene</h3> <p>scene 场景，可以放置任何元素，在任何情况都不会被解析或使用，除非在被loadscene调用时才会载入浏览器解析，在浏览器载入xml文件时，不会加载其内容和属性，相当于一个封闭的集装箱，对浏览器而言，它只知道其属性。</p> <p>使用loadpano()载入外部xml文件时，当前定义过的scene元素将被移除。</p> <p>可以在scene元素中存储任何自定义属性——viewer本身会忽略这些属性，但可以用自定义action使用这些元素。</p> <div class="language-abnf extra-class"><pre class="language-abnf"><code>&lt;scene <span class="token rule">name</span><span class="token operator">=</span><span class="token string">&quot;...&quot;</span> <span class="token definition keyword">onstart</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>&gt;    <span class="token rule">onstart</span> 场景开始渲染时加载<span class="token rule">action</span>
    ...
<span class="token rule"><span class="token punctuation">&lt;</span>/scene<span class="token punctuation">&gt;</span></span>
</code></pre></div><p>内容</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>scene<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>content
scene<span class="token punctuation">.</span>count
scene<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>index
scene<span class="token punctuation">.</span>onstart
</code></pre></div><p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scene</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scene_1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">heading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">lng</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>103.76300000<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">thumbx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>75<span class="token punctuation">&quot;</span></span> <span class="token attr-name">lat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>31.51229500<span class="token punctuation">&quot;</span></span> <span class="token attr-name">thumburl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panos/1.tiles/thumb.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">thumby</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">fovtype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DFOV<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxpixelzoom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fov</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90<span class="token punctuation">&quot;</span></span> <span class="token attr-name">vlookat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-80<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fisheye</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.35<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hlookat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fovmin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>70<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fovmax</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>140<span class="token punctuation">&quot;</span></span> <span class="token attr-name">limitview</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>range<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hlookatmin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-90<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hlookatmax</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>preview</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panos/1.tiles/preview.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">multires</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tilesize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>512<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>CUBE<span class="token punctuation">&quot;</span></span> <span class="token attr-name">progressive</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">tiledimageheight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1592<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tiledimagewidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1592<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cube</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panos/1.tiles/%s/l2/%v/l2_%s_%v_%h.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span> <span class="token attr-name">tiledimageheight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>796<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tiledimagewidth</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>796<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cube</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panos/1.tiles/%s/l1/%v/l1_%s_%v_%h.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mobile</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cube</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>panos/1.tiles/mobile_%s.jpg<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mobile</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hotspot</span> <span class="token attr-name">atv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-7.482<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spot1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin_hotspotstyle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ath</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>32.158<span class="token punctuation">&quot;</span></span> <span class="token attr-name">linkedscene</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scene_22<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scene</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="style-2"><a href="#style-2" class="header-anchor">#</a> style</h3> <p>style 属性集合，类似css中的class样式</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name">...</span> <span class="token attr-name">any</span> <span class="token attr-name">plugin</span> <span class="token attr-name">or</span> <span class="token attr-name">hotspot</span> <span class="token attr-name">or</span> <span class="token attr-name">self</span> <span class="token attr-name">defined</span> <span class="token attr-name">attributes</span> <span class="token attr-name">...</span>
    <span class="token attr-name">插入</span> <span class="token attr-name">plugin</span> <span class="token attr-name">或</span> <span class="token attr-name">hotspot</span> <span class="token attr-name">或</span> <span class="token attr-name">自定义属性</span>
<span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin_glow<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name">ondown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>copy(skin_lockglow,name); skin_buttonglow(get(name)); if(ondown2, ondown2() );<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name">onover</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>if(skin_lockglow === null, copy(skin_lockglow,name); skin_buttonglow(get(name),0.3) ); <span class="token punctuation">&quot;</span></span>
   <span class="token attr-name">onout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>if(skin_lockglow === name, ifnot(pressed, skin_buttonglow(null);delete(skin_lockglow); ));<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name">onup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>if(hovering, skin_buttonglow(get(name),0.3), skin_buttonglow(null);delete(skin_lockglow); ); if(onup2, onup2() );<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>获取style中的某个属性加global：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">trace</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>style<span class="token punctuation">[</span>mystyle<span class="token punctuation">]</span><span class="token punctuation">.</span>bgborder<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="include"><a href="#include" class="header-anchor">#</a> include</h3> <p>include元素可以用来加载和导入其他xml文件，krpano在解析xml文件前，它会搜索所有include的xml元素，然后加载对应的xml内容，将其插入到当前xml文件并替换include元素。当所有<code>&lt;include&gt;</code>加载解析完成,那么主要的xml才开始解析。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>path/name-of-the-other-xml-file.xml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin/vtourskin.xml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%SWFPATH%/global.xml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p><code>&lt;action&gt; / &lt;data&gt; / &lt;scene&gt;</code> 都是特殊的元素，在xml解析时将被忽略。这些元素的内容将作为字符串存储在变量中。</p> <h3 id="progress-废弃"><a href="#progress-废弃" class="header-anchor">#</a> progress（废弃）</h3> <p>progress 载入进度（废弃）,官方不再将其作为内置元素写进文档</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>progress</span> <span class="token attr-name">showload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>auto<span class="token punctuation">&quot;</span></span>

<span class="token attr-name">设置进度条样式</span>  <span class="token attr-name">none</span> <span class="token attr-name">or</span> <span class="token attr-name">auto</span> <span class="token attr-name">or</span> <span class="token attr-name">bar(...)，</span>

<span class="token attr-name">bar(origin,width,height,offsetx,offsety,style,backcolor,loadcolor,decodecolor,bordercolor,borderwidth,glowcolor,glowwidth)</span>

          <span class="token attr-name">showwait</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loopings()<span class="token punctuation">&quot;</span></span>       <span class="token attr-name">显示等待中程序模式</span> <span class="token attr-name">none</span> <span class="token attr-name">or</span> <span class="token attr-name">auto</span> <span class="token attr-name">or</span> <span class="token attr-name">loopings(...)</span>
          <span class="token attr-name">showreloads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">是否在新场景重新显示滚动条</span>
          <span class="token attr-name">parent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                   <span class="token attr-name">设置父元素名称和路径</span>
          <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="textstyle-废弃"><a href="#textstyle-废弃" class="header-anchor">#</a> textstyle（废弃）</h3> <p>textstyle 针对showtext的第三个参数的文本样式（废弃），新版showtext.xml</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textstyle</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span>                       <span class="token attr-name">定义样式名称</span>
           <span class="token attr-name">font</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Times<span class="token punctuation">&quot;</span></span>                     <span class="token attr-name">定义文字字体</span>
           <span class="token attr-name">fontsize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12.0<span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">定义文字大小</span>
           <span class="token attr-name">bold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>                      <span class="token attr-name">是否粗体</span>
           <span class="token attr-name">italic</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>                   <span class="token attr-name">是否斜体</span>
           <span class="token attr-name">background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">是否加载文字背景</span>
           <span class="token attr-name">backgroundcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xFFFFFF<span class="token punctuation">&quot;</span></span>       <span class="token attr-name">背景颜色</span>
           <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>                    <span class="token attr-name">是否加载边框</span>
           <span class="token attr-name">bordercolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0x000000<span class="token punctuation">&quot;</span></span>           <span class="token attr-name">边框颜色</span>
           <span class="token attr-name">textcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0x000000<span class="token punctuation">&quot;</span></span>             <span class="token attr-name">文字颜色</span>
           <span class="token attr-name">alpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>                      <span class="token attr-name">文字不透明度</span>
           <span class="token attr-name">blendmode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>normal<span class="token punctuation">&quot;</span></span>               <span class="token attr-name">选择混合模式：</span> <span class="token attr-name">&quot;normal&quot;,</span> <span class="token attr-name">&quot;add&quot;,</span> <span class="token attr-name">&quot;difference&quot;,</span> <span class="token attr-name">&quot;multiply&quot;,</span> <span class="token attr-name">&quot;screen&quot;</span>
           <span class="token attr-name">effect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>                        <span class="token attr-name">选择加载特效</span>
                                            <span class="token attr-name">•glow(color,alpha,range,strength);</span>
                                            <span class="token attr-name">•dropshadow(depth,angle,color,range,strength);</span>
                                            <span class="token attr-name">•blur(radius);</span>

           <span class="token attr-name">origin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cursor<span class="token punctuation">&quot;</span></span>                 <span class="token attr-name">文本原点位置</span> <span class="token attr-name">cursor(鼠标光标)，lefttop,</span> <span class="token attr-name">left,</span> <span class="token attr-name">leftbottom,top,</span> <span class="token attr-name">center,</span> <span class="token attr-name">bottom,</span> <span class="token attr-name">righttop,</span> <span class="token attr-name">right,</span> <span class="token attr-name">rightbottom</span>
           <span class="token attr-name">edge</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bottom<span class="token punctuation">&quot;</span></span>                   <span class="token attr-name">底部阴影效果</span>
           <span class="token attr-name">textalign</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>none<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">文本对齐方式</span> <span class="token attr-name">none,</span> <span class="token attr-name">left,</span> <span class="token attr-name">center,</span> <span class="token attr-name">right</span>
           <span class="token attr-name">xoffset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>                     <span class="token attr-name">文本原点位置X轴偏移量</span>
           <span class="token attr-name">yoffset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-3<span class="token punctuation">&quot;</span></span>                    <span class="token attr-name">文本原点位置Y轴偏移量</span>
           <span class="token attr-name">showtime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">显示文本的时间</span>
           <span class="token attr-name">fadetime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>                  <span class="token attr-name">文本淡出显示时间</span>
           <span class="token attr-name">fadeintime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>                <span class="token attr-name">文本淡入显示时间</span>
           <span class="token attr-name">noclip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>                   <span class="token attr-name">是否避免文字超出屏幕边缘</span>
           <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>定义文本样式，只在flash播放情况下有效</p> <p>样例：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textstyle</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DEFAULT<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">font</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Arial<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fontsize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">italic</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">textcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0x000000<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">blendmode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>layer<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">effect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>glow(0xFFFFFF,0.85,4,4);dropshadow(2,45,0x000000,4,1);<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">origin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cursor<span class="token punctuation">&quot;</span></span> <span class="token attr-name">edge</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bottom<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">xoffset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15<span class="token punctuation">&quot;</span></span> <span class="token attr-name">yoffset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-5<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">showtime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fadeintime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fadetime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.1<span class="token punctuation">&quot;</span></span>
           <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h2 id="action脚本语法"><a href="#action脚本语法" class="header-anchor">#</a> action脚本语法</h2> <h3 id="语法及使用"><a href="#语法及使用" class="header-anchor">#</a> 语法及使用</h3> <p><code>actionname(parameters); ...</code></p> <ul><li>语法格式：动作名(参数);</li> <li>动作名可以为以下几种:</li></ul> <ol><li>内置的krpano动作名…</li> <li>在xml任何地方定义的action元素名…</li> <li>包含动作代码的变量/属性名。</li></ol> <ul><li>不在引号内（单或双引号字符）的空白字符（如空格，制表，新行）将被忽略。</li> <li>可以同时编写若干条动作，只需在每条动作尾部加上';'字符。</li> <li>动作将被逐条执行。</li> <li>在动作调用之间及参数之间的空白(如空格、tabs以及换行)将被忽略。</li> <li>参数数量取决于被调用的动作实体。</li> <li>参数之间需要使用逗号','来分开。</li> <li>要想在参数中使用空白或逗号，那么参数就需要用单引号或双引号进行封闭。</li> <li>所有给定参数都视为字符。当使用变量名作为参数时，不会被自动解析为对应值。一些动作可以自动处理变量名参数，但是那要依赖与动作体本身。要想使用变量作为参量来传递，必须使用get动作。注 - 一些动作可以自动解析变量参数的值，但这仅限少数动作的自身特性。</li></ul> <h3 id="表达式"><a href="#表达式" class="header-anchor">#</a> 表达式</h3> <p>表达式将被使用在：if语句；条件循环(for,loop)语句；和 calc 动作中。用于判断逻辑条件是否成立，计算数学表达式或拼接字符串。</p> <ul><li>基本语法：a 操作符 b</li> <li>其中a或b项可以是变量，值或字符串。</li> <li>操作符可以是下表罗列之一。</li> <li>运算顺序取决于具体的操作符，但在等价操作符内运算顺序是从左向右。</li> <li>可以使用括号实现一个自定义运算顺序 - 例如：（a 操作符 b）操作符（c 操作符 d）</li></ul> <p><img src="https://esqbs.github.io/image_store/blog/202404092043184.png" alt=""></p> <div class="language-jboss-cli extra-class"><pre class="language-text"><code>.GT. 大于
.GE. 大于或等于
.LT. 小于
.LE. 小于或等于
.EQ. 等于
.NE. 不等于 .AND. 逻辑与
.OR. 逻辑或
.NOT. 逻辑非
.EQV. 逻辑等
.NEQV. 逻辑不等
运算符优先级由高到低顺序为:()→**→*或/→+或-→.GT.或.GE.或.LT.或.LE.或.EQ.或.NE.→.NOT.→.AND.→.OR.→.EQV.或.NEQV
</code></pre></div><h3 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h3> <ul><li>每个xml带name的元素是一个数组的 element / item。</li> <li>xml元素的名称是数组的名称和名称属性定义数组元素的名称/项目。</li> <li>一个数组在krpano总是一个对象数组。</li> <li>这样的数组项对象可以包含任何类型的自定义属性/属性。</li> <li>数组可以预先定义或定义在运行时动态地设置一个数组项值,当第一次设置项值,然后自动将创建一个数组。</li></ul> <p>*<strong>静态XML语法: (在定义在xml结构)*</strong> <code>&lt;array_name name=&quot;item_name&quot; value=&quot;...&quot; /&gt;</code></p> <p>*<strong>动态行为的语法: (当访问或设置在运行时)*</strong> <code>array_name[item_name].value</code> <strong>数组可用方法：</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token property-declaration"><span class="token property">count</span>    统计</span>
<span class="token func"><span class="token function">sortby</span><span class="token punctuation">(</span>attribute<span class="token punctuation">,</span> parameters<span class="token operator">*</span><span class="token punctuation">)</span>    排序</span>
<span class="token func"><span class="token function">removearrayitem</span><span class="token punctuation">(</span>name <span class="token operator">or</span> index<span class="token punctuation">)</span>   移除</span>
</code></pre></div><h3 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h3> <div class="language-avrasm extra-class"><pre class="language-text"><code>onclick:鼠标点击

onover:鼠标经过 

onhover:鼠标停留 

onout:鼠标移开

ondown:鼠标按下

onup:鼠标抬起
</code></pre></div><h3 id="count"><a href="#count" class="header-anchor">#</a> count</h3> <p><code>lensflareset[name].flare.count</code></p> <h3 id="index"><a href="#index" class="header-anchor">#</a> index</h3> <p><code>lensflareset[name].flare[...].index</code></p> <ul><li><ul><li><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul></li></ul></li></ul> <p>官方文档：<a href="https://link.segmentfault.com/?enc=9Zn9RsAC9a1ik%2BS5k5sb1w%3D%3D.lFmMppwT%2Fzq93XU7Szzh2UUeX%2FWoWJUeHnFOX1YGmzvTL8wXb4XxTgIclAVB7UQp" target="_blank" rel="noopener noreferrer">https://krpano.com/docu/actio...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="全局变量"><a href="#全局变量" class="header-anchor">#</a> 全局变量</h3> <h4 id="版本"><a href="#版本" class="header-anchor">#</a> 版本</h4> <p><strong>version：</strong>（只读）版本信息</p> <p><strong>xmlversion：</strong>（只读）xml版本</p> <p><strong>build：</strong>（只读）构建时间</p> <h4 id="鼠标、键盘"><a href="#鼠标、键盘" class="header-anchor">#</a> 鼠标、键盘</h4> <p><strong>mouse.x</strong> （只读）相对于区域，坐标原点为area的左上角</p> <p><strong>mouse.y</strong> （只读）</p> <p><strong>mouse.stagex</strong> （只读）相对于屏幕，坐标原点为screen的左上角</p> <p><strong>mouse.stagey</strong> （只读）</p> <p><strong>mouse.downx</strong> （只读）相对于区域，存贮最后一次鼠标按下时的位置(右键或右键)，该值以area的左上角为原点。</p> <p><strong>mouse.downy</strong> （只读）</p> <p><strong>mouse.clickx</strong> （只读）相对于区域</p> <p><strong>mouse.clicky</strong>（只读）</p> <p><strong>keycode：</strong> 0 （只读） 键码</p> <p><strong>wheeldelta：</strong> 0（只读）滚轮的标准滚动值，在大多数系统上通常为 +3(前滚) 或 -3(后滚)</p> <p><strong>wheeldelta_raw：</strong> Number.NaN
（只读）未缩放未取整前的原始滚动值，注意：在flash模式下，仅当在窗口模式(非全屏)且使用默认embedding脚本时才有效；而在html5下，始终有效。</p> <p><strong>wheeldelta_touchscale：</strong> 0.0 （只读）虽然触摸设备没有鼠标滚轮，但是当双指缩放时，仍然可能触发onmousewheel事件，该变量将提供相对的比例缩放详细信息。</p> <p>注意： 仅适用于触摸设备！在其他装置上的值将永远是0。</p> <h4 id="屏幕信息-设置"><a href="#屏幕信息-设置" class="header-anchor">#</a> 屏幕信息/设置</h4> <p><strong>fullscreen:</strong> false 该变量可以用来检查或更改全屏模式的当前状态。若变量被改变，说明全屏模式被改变。</p> <p>例子</p> <div class="language-abnf extra-class"><pre class="language-abnf"><code>切换全屏状态
<span class="token definition keyword">onclick</span><span class="token operator">=</span><span class="token string">&quot;set(fullscreen,true);&quot;</span>
<span class="token definition keyword">onclick</span><span class="token operator">=</span><span class="token string">&quot;toggle(fullscreen);&quot;</span>
</code></pre></div><p>注意：</p> <ul><li>在使用该设置前，应该检查当前设备/浏览器是否支持全屏模式，这可以在静态xml中使用devices=&quot;fullscreensupport&quot;或动态语句中使用device.fullscreensupport变量来完成。</li> <li>由于Flash Player和HTML5安全限制，切换到全屏模式需要用户操作动作(如点击鼠标或按下键盘)，这意味着切换全屏模式需要在onclick或onKeyDown事件中进行。</li> <li>当HTML5浏览器不支持全屏模式时(如iOS)，全屏设置将仅改变viewer的大小以匹配整个浏览器窗口的大小。由于技术限制，无法在IFRAME中及嵌套HTML中工作。</li> <li>若尝试从IFRAME内部使用全屏模式，那么有必要在IFRAME的声明中加入allowFullScreen，以告诉浏览器该IFRAME是充许切换到全屏的。</li></ul> <p>例子
<code>&lt;iframe ... allowfullscreen=&quot;true&quot; mozallowfullscreen=&quot;true&quot; webkitallowfullscreen=&quot;true&quot;&gt;&lt;/iframe&gt;</code></p> <p><strong>stagewidth/stageheight：</strong>（只读）当前视图窗口的宽/高 单位像素</p> <p><strong>stagescale：</strong> 1.0 整体缩放比例设置 （html5）
该设置将缩放所有krpano的元素大小。</p> <p>通过缩放所有元素，舞台尺寸(屏幕尺寸/分辨率)本身将反比例增加，比如stagescale=0.5时，舞台尺寸将为200%。
该默认值取决于具体的设备、浏览器、js的window.devicePixelRatio值，在桌面和平板上该默认值通常为1.0；在移动设备上通常为0.5。</p> <p>这意味着，在移动设备上的元素大小通常为桌面和平板的一半。
要禁用该行为(例如要实现一些自定义的响应式布局)可以将下面代码放到第一个xml中。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mobilescale<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autorun</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preinit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mobile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
mul(stagescale,2);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>例子</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mobilescale<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autorun</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preinit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">devices</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mobile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   mul(stagescale,2);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>bgcolor：</strong> 视图的背景颜色。在全景图像装载前的显示颜色；以及局部全景未覆盖区域的显示颜色。
当设置为有效的十六进制色值时（例如：&quot;0xFFFFFF&quot;表达白色），那么一个使用该颜色的形状将作为背景在全景图后面呈现。
未设置或设置无效时，则表现为透明，并且将显示FlashPlayer的默认背景色(在html文件中修改)，当embedding设置中wmode=&quot;transparent&quot;时将显示Html页面</p> <p>仅限Flash：当设置时，它允许在全景图像“外部”使用鼠标进行导航（例如使用局部全景图时），并且它允许不同尺寸局部全景之间的正确混合。</p> <h4 id="设备信息"><a href="#设备信息" class="header-anchor">#</a> 设备信息</h4> <p><strong>browser.useragent</strong> 用户代理字符串，user-agent 字符串。等同于js的 navigator.userAgent（只读）</p> <p><strong>browser.platform</strong> 浏览平台，在HTML5中为platform字符串，等同于js的navigator.platform；在Flash中一直为“Flash”（只读）</p> <p><strong>browser.location</strong> 当前页面的完整url（只读）</p> <p><strong>browser.domain</strong> 域名（只读）</p> <p><strong>browser.protocol</strong> 协议（只读）</p> <ul><li>注：仅当使用默认的 embedding.js 时，以上变量才有效。</li></ul> <p><img src="https://esqbs.github.io/image_store/blog/202404092043643.png" alt="图片描述">
例子</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">if</span><span class="token punctuation">(</span>device.html5<span class="token punctuation">,</span> ...<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">if</span><span class="token punctuation">(</span>device.flash<span class="token punctuation">,</span> ...<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">if</span><span class="token punctuation">(</span>device.android<span class="token punctuation">,</span> <span class="token function">if</span><span class="token punctuation">(</span>device.flash<span class="token punctuation">,</span> ...<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">if</span><span class="token punctuation">(</span>device.iOSversion GT 5.1<span class="token punctuation">,</span> ...<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="时间、随机值"><a href="#时间、随机值" class="header-anchor">#</a> 时间、随机值</h4> <p><strong>timertick</strong> （只读）查看器启动到当前时刻经历的毫秒数</p> <p><strong>random</strong> 0.0-1.0 （只读）返回一个0到1范围内的随机值</p> <p><strong>idletime</strong> 0.5 设置当无人操作时，经过多少秒会触发 Onidle 事件</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token comment">//示例-生成一个1到10之间的随机数</span>
<span class="token function">mul</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> random<span class="token punctuation">,</span> 9<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">roundval</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'random value='</span><span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="math常量"><a href="#math常量" class="header-anchor">#</a> math常量</h4> <p><strong>Math.PI</strong> 数学常数π（圆周率）的值(3.141592)</p> <h4 id="键盘-按钮移动"><a href="#键盘-按钮移动" class="header-anchor">#</a> 键盘/按钮移动</h4> <p>这些变量可以用来设置移动视图。</p> <p>它们的主要用途是键盘或按钮动作控制。</p> <p><strong>hlookat_moveforce</strong> 0.0 小于0时向左旋转；大于0时向右旋转</p> <p><strong>vlookat_moveforce</strong> 0.0 小于0时向上旋转；大于0时向下旋转</p> <p><strong>fov_moveforce</strong> 0.0 小于0时放大；大于0时缩小</p> <p>当用键盘控制全景时，这些变量会返回不同的数值(0、1或-1)。可以在自已的程序代码中读取或设置它们，用来判断键盘操作状态或实现自动旋转的效果。</p> <p>旋转加速度、速度及刹车速度分别取决于control.keybaccelerate、control.keybspeed、control.keybfriction</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token comment">//示例-自动向左旋转3秒后停止</span>
<span class="token function">set</span><span class="token punctuation">(</span>hlookat_moveforce<span class="token punctuation">,</span>-1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">delayedcall</span><span class="token punctuation">(</span>3<span class="token punctuation">,</span><span class="token function">set</span><span class="token punctuation">(</span>hlookat_moveforce<span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="多重分辨率信息"><a href="#多重分辨率信息" class="header-anchor">#</a> 多重分辨率信息</h4> <p><strong>multireslevel</strong> 当前的层级数(范围:0到image.level.count-1) （只读）</p> <p><strong>lockmultireslevel：</strong> 1 限定在某个层级，当为-1时取消限定。</p> <p><strong>downloadlockedlevel：</strong> false 为true时表示当前限定的层将被全部下载</p> <h4 id="加载信息"><a href="#加载信息" class="header-anchor">#</a> 加载信息</h4> <p><strong>progress.progress：</strong> 0.0 当前加载进度值(0.0~1.0)，它可以用来制作自定义加载动画，使用 onxmlcomplete 事件来启动加载动画，在 onloadcomplete 事件中停止它，加载过程中通过该变量的值来影响进度显示内容。</p> <h4 id="xml-场景-只读"><a href="#xml-场景-只读" class="header-anchor">#</a> XML / 场景（只读）</h4> <p><strong>xml.url</strong> (只读)当前加载的xml文件路径</p> <p><strong>xml.content</strong> (只读)当前xml文件的全部文本内容。当使用loadscene()方法加载一个场景后，该变量中的内容将仅为<code>&lt;scene&gt;</code>元素</p> <p><strong>xml.scene</strong> (只读)当使用loadscene()方法加载一个场景后，该变量存贮着当前场景的名称</p> <p><strong>xml.view</strong> (只读)保存当前xml或scene中<code>&lt;view&gt;</code>元素的一个备份。例如可以通过 xml.view.hlookat 来获取原始的 view.hlookat</p> <ul><li>注意-这里仅存贮明确定义的值，不含默认值，这意味着，在使用它取值之前要选检查一下该是否存在。</li></ul> <p><strong>network.viewerpath</strong> krpano渲染器路径</p> <p><strong>network.htmlpath</strong> html路径</p> <p><strong>network.firstxmlpath</strong> 首次加载xml路径</p> <p><strong>network.currentxmlpath</strong> 当前xml路径</p> <div class="language-lasso extra-class"><pre class="language-text"><code>//例如
if(xml.view.fov !== null, ...);
</code></pre></div><h4 id="调试-错误处理"><a href="#调试-错误处理" class="header-anchor">#</a> 调试/错误处理</h4> <p><strong>debugmode</strong> false 为true时显示调试跟踪 trace() 信息</p> <p><strong>showerrors</strong> true 当有错误发生时自动显示错误信息窗口</p> <p><strong>lasterror</strong> （只读） 用于在 onloaderror 事件中获取最近一次的出错信息。</p> <p><strong>haveexternalinterface</strong> true（只读）用来检测扩展接口功能是否有效。尤其是在使用 openurl()这个功能时，有必要使用该变量判断一下环境是否支持扩展接口。
浏览在网络服务器上的全景时该变量始终为true(扩展接口始终有效)，但是在本地的Flash模式下，只有在浏览器打开本地受信任文件夹中的Flash SWF文件，扩展接口才会有效。关于受信任文件夹管理，可以在Flasyplayer安全选项中进行。</p> <p><strong>havenetworkaccess</strong> true （只读）该变量用来检查网络访问是否有效。这可以用来避免错误的发生，如在使用谷歌地图或必应地图时，如若没有网络，就会发生未知错误。
浏览在网络服务器上的全景时该变量始终为true(网络访问始终有效)，但是在本地的Flash模式下，只有在浏览器打开本地受信任文件夹中的Flash SWF文件，网络访问才会有效。
关于受信任文件夹管理，可以在Flasyplayer安全选项中进行。</p> <h4 id="layers-仅flash"><a href="#layers-仅flash" class="header-anchor">#</a> Layers (仅flash)</h4> <p><strong>image.layer</strong> 仅as3用法)pano image layer 的 Actionscript 3 Sprite 对象</p> <p><strong>layer.enabled / plugin.enabled</strong> true 启用所有图层或插件</p> <p><strong>layer.visible / plugin.visible</strong> true 让所有图层或插件可见或不可见(也支持HTML5)</p> <p><strong>layer.alpha / plugin.alpha</strong> 1.0 设置所有图层或插件的透明度</p> <p><strong>layer.layer / plugin.layer</strong> (仅as3用法)layer / plugin 的 Actionscript 3 Sprite 对象</p> <p><strong>hotspot.enabled</strong> true 启用所有热点</p> <p><strong>hotspot.visible</strong> true 让所有热点可见或不可见</p> <p><strong>hotspot.alpha</strong> 1.0 设置所有热点的透明度</p> <p><strong>hotspot.layer</strong> (仅as3用法)hotspot 的 Actionscript 3 Sprite 对象</p> <h3 id="变量、语句"><a href="#变量、语句" class="header-anchor">#</a> 变量、语句</h3> <p><strong>定义一个变量或对象：</strong> <code>def(variable, type, value*)</code></p> <ul><li>type</li></ul> <p>指定变量的类型
变量类型包括：</p> <div class="language-applescript extra-class"><pre class="language-applescript"><code>    <span class="token class-name">boolean</span> <span class="token operator">-</span> <span class="token keyword">true</span> 或者 <span class="token keyword">false</span>
    <span class="token class-name">number</span> <span class="token operator">-</span> 数字类型<span class="token punctuation">(</span>含整数和小数<span class="token punctuation">)</span>
    <span class="token class-name">integer</span> <span class="token operator">-</span> 整数类型
    string <span class="token operator">-</span> 字符类型
    object <span class="token operator">-</span>包含属性的对象类型
</code></pre></div><ul><li>value(可选参数)</li></ul> <p>该变量的初始值
当未附初始值并且变量已存在时，那么该变量的当前值将被转换成给定的类型
当未附初始值并且变量不存在时，那么默认的初始值自动为以下内容：
boolean=false
number=NaN(表示 Not a Number)
integer=0
string=null
对象类型不能指定初始值</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">def</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> boolean<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">def</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> number<span class="token punctuation">,</span> 123.456<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">def</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> string<span class="token punctuation">,</span> <span class="token string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">def</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">def</span><span class="token punctuation">(</span>obj.x<span class="token punctuation">,</span> number<span class="token punctuation">,</span> 0.0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">def</span><span class="token punctuation">(</span>obj.y<span class="token punctuation">,</span> number<span class="token punctuation">,</span> 0.0<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>赋值语句：</strong> <code>set({variable},{value})</code> <em>注意- 当这里为某个变量名称时，不会从该名称所表示变量自动取值，应该使用get(variable)来取变量值</em></p> <div class="language-pgsql extra-class"><pre class="language-text"><code>set(plugin[{name}].{attribute},{value});
set (layer[skin_map].visible, true);
</code></pre></div><p><strong>获取变量：</strong> <code>get({variable}) 、 array[ get(variable) ] 、 &lt;xmlelement attribute=&quot;get:variable&quot; ... /&gt;</code>
获取给定变量的实际值
<em>注意- 个别内置动作会自动获取参数中变量名对应的实际值，这时就无需使用 get() 语句。比如 add() sub() mul()等</em></p> <div class="language-routeros extra-class"><pre class="language-text"><code>set(dstvar, get(srcvar));
looktohotspot(get(name));
lookto(get(h), get(v), get(f));
showtext(get(msg));
tween(var,get(dstval));
set(pic, spot1);
set(hotspot[get(pic)].visible, false);
trace('xyz=', xyz, ' get(xyz)=', get(xyz));
txtadd(msg, 'fov=', get(view.fov));
</code></pre></div><p><strong>计算语句：</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token func"><span class="token function">calc</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> expression<span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">action</span><span class="token punctuation">(</span> <span class="token func"><span class="token function">calc</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">)</span></span></span>
array<span class="token punctuation">[</span> <span class="token func"><span class="token function">calc</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span> <span class="token punctuation">]</span>  </span>
&lt;xmlelement attribute=<span class="token string">&quot;calc:expression&quot;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> /&gt;
</code></pre></div><p>expression：数学或逻辑表达式</p> <div class="language-routeros extra-class"><pre class="language-text"><code>set(y_new, calc(y_old - offset1 + offset2));
set(animationtime, calc('%1' == 'instant' ? 0.0 : 0.5));
&lt;layer url=&quot;calc:'%CURRENTXML%/skin/' + settings.image1&quot; /&gt;
</code></pre></div><p><strong>变量复制:</strong> <code>copy(destination, source)==set(destination, get(source) )</code>
将原变量(source)中的值复制到目标变量(destination)中
当两个变量类类型不同时，原变量的值将被转换成目标变量的类型
copy()动作的同效语句为 set(destination, get(source));</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">copy</span><span class="token punctuation">(</span>dstvar<span class="token punctuation">,</span> srcvar<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">copy</span><span class="token punctuation">(</span>cur_hlookat<span class="token punctuation">,</span> view.hlookat<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">copy</span><span class="token punctuation">(</span>layer[text].x<span class="token punctuation">,</span> mouse.x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">copy</span><span class="token punctuation">(</span>layer[text].y<span class="token punctuation">,</span> mouse.y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>变量移除:</strong> <code>delete(variable,...)</code>
充许同时移除多个变量，变量之间使用逗号(,)分开即可</p> <div class="language-lasso extra-class"><pre class="language-text"><code>set(tmp1, ...);
set(tmp2, ...);
... do something ...
delete(tmp1, tmp2);
</code></pre></div><p><strong>判断语句：</strong> <code>if(condition, then-actions, else-actions*)</code>
条件成立时执行相应 then语句，否则执行 else语句</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code>if<span class="token punctuation">(</span><span class="token car">fullscreen</span>, fullscreensetup<span class="token punctuation">(</span><span class="token punctuation">)</span>, windowsetup<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token car">fullscreen</span>, set<span class="token punctuation">(</span><span class="token car">layer</span><span class="token punctuation">[</span>controls<span class="token punctuation">]</span>.visible, false<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token car">i</span> LT 10, loop<span class="token punctuation">(</span><span class="token car">next</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token car">var</span> === null, set<span class="token punctuation">(</span><span class="token car">var</span>,0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token car">hotspot</span><span class="token punctuation">[</span>spot1<span class="token punctuation">]</span> === null, trace<span class="token punctuation">(</span><span class="token car">there</span> is no spot1 hotspot<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token car">varA</span> GT <span class="token number">5</span><span class="token punctuation">)</span> AND <span class="token punctuation">(</span><span class="token car">varA</span> LT <span class="token number">10</span><span class="token punctuation">)</span>,
    trace<span class="token punctuation">(</span><span class="token quoted-symbol variable symbol">'varA</span> is between <span class="token number">5</span> and 10'<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token car">varA</span> AND varB AND varC, trace<span class="token punctuation">(</span><span class="token quoted-symbol variable symbol">'all</span> vars are true'<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token car">var1</span> GT var2,
    trace<span class="token punctuation">(</span><span class="token quoted-symbol variable symbol">'condition</span> is true'<span class="token punctuation">)</span><span class="token comment">;</span>
    lookto<span class="token punctuation">(</span>100,20,50<span class="token punctuation">)</span><span class="token comment">;</span>
  ,
    trace<span class="token punctuation">(</span><span class="token quoted-symbol variable symbol">'condition</span> is false'<span class="token punctuation">)</span><span class="token comment">;</span>
    lookto<span class="token punctuation">(</span>0,0,100<span class="token punctuation">)</span><span class="token comment">;</span>
  <span class="token punctuation">)</span><span class="token comment">;</span>
if<span class="token punctuation">(</span><span class="token car">a*2+b</span> GT <span class="token punctuation">(</span><span class="token car">c+3</span><span class="token punctuation">)</span>*1.5 OR teststring == '123', ...<span class="token punctuation">)</span><span class="token comment">;</span>
</code></pre></div><p><strong>反向判断：</strong><code>ifnot(condition, then-actions, else-actions*)</code>
逻辑上与 if 相反，用法相同。</p> <p><strong>延时调用：</strong> <code>delayedcall(delay , actions) / delayedcall(id, delay, actions)</code>
给定的时间后调用或执行指定的动作，为该动作指定一个唯一的标识 ID ，这样一来，就可以通过 stopdelayedcall(id) 来取消该延时动作的执行</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">delayedcall</span><span class="token punctuation">(</span>5.0<span class="token punctuation">,</span> <span class="token function">hidelogo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">delayedcall</span><span class="token punctuation">(</span>id1<span class="token punctuation">,</span>5.0<span class="token punctuation">,</span> <span class="token function">hidelogo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//id用于其他动作控制该delayedcall</span>
<span class="token function">delayedcall</span><span class="token punctuation">(</span>10<span class="token punctuation">,</span> <span class="token function">looktohotspot</span><span class="token punctuation">(</span>spot1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">loadpano</span><span class="token punctuation">(</span>pano2.xml<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>移除延时回调：</strong><code>stopdelayedcall(id)</code>
取消并停止指定id的延时动作</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>events</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>introimage_events<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onnewpano</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>delayedcall(introimage, 5.0, hide_introimage() );<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onremovepano</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stopdelayedcall(introimage);<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p><strong>在某个actions后执行：</strong><code>nexttick(actions)</code>
在当前动作体(一个action元素结点内的动作集)执行完成后立即执行指定的动作</p> <div class="language-abnf extra-class"><pre class="language-abnf"><code><span class="token operator">/</span><span class="token operator">/</span>执行以下动作会先显示<span class="token string">&quot;测试nexttick&quot;</span>
&lt;action <span class="token rule">name</span><span class="token operator">=</span><span class="token string">&quot;nexttick_test&quot;</span>&gt;
<span class="token rule">showlog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">;</span>
<span class="token rule">nexttick</span><span class="token punctuation">(</span><span class="token rule">trace</span><span class="token punctuation">(</span><span class="token string">&quot;这是nexttic中k的动作!&quot;</span><span class="token punctuation">)</span><span class="token comment">;</span>
<span class="token rule">trace</span><span class="token punctuation">(</span><span class="token string">&quot;测试nexttick&quot;</span><span class="token punctuation">)</span><span class="token comment">;</span>
<span class="token rule"><span class="token punctuation">&lt;</span>/action<span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>在condition为真时执行指定actions：</strong><code>callwhen(condition, actions)</code>
当表达式(condition)值为 true 会执行指定的动作(actions)
若表达式的值此时不为 true ，那么该语句动作会一直等待，直到值为 true 并执行指定的动作
<em>注意- 与 if() 语句主要不同是，callwhen() 具有充许滞后特性，这里强调的是当表达式的值变为true时才执行且仅执行一次</em></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token function">callwhen</span><span class="token punctuation">(</span>plugin[video].loaded<span class="token punctuation">,</span> plugin[video].<span class="token function">playvideo</span><span class="token punctuation">(</span>...<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">callwhen</span><span class="token punctuation">(</span>plugin[maps].loaded<span class="token punctuation">,</span> plugin[maps].<span class="token function">setcenter</span><span class="token punctuation">(</span>...<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>循环语句：</strong><code>for(startactions, condition, nextactions, loopactions) //startactions循环前执行</code>
首先执行起始动作(startactions)，然后检查表达式(condition)，若值为 true 则执行要循环的动作(loopactions)，每执行一次循环动作就执行一次步进动作(nextactions)，然后再检查表达式的值，若为 true 则继续执行循环动作…直到表达式为 false 时终止循环</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">for</span><span class="token punctuation">(</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">,</span> i LT 10<span class="token punctuation">,</span> <span class="token function">inc</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'i='</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>.
<span class="token function">for</span><span class="token punctuation">(</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">,</span> i LT layer.count<span class="token punctuation">,</span> <span class="token function">inc</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> 
  <span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'layer['</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span><span class="token string">'].name='</span><span class="token punctuation">,</span>layer[<span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>].name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p><strong>持续循环：</strong><code>loop(condition, loopactions)</code> <code>asyncloop(condition, loopactions, doneactions*)</code>
只要表达式(condition)值为 true 则一直执行循环动作(loopactions)
对于 loop() 语句，只有当循环体执行结束后才会执行后续的其它动作；而 asyncloop() 则是在循环期间继续其它事件和动作，只是在当表达式为 true 时就每帧执行一次循环动作(loopactions)，asyncloop() 循环结束后还可以执行可选的完成动作(doneactions)</p> <div class="language-routeros extra-class"><pre class="language-text"><code>ondown=&quot;asyncloop(pressed, layer[scrollarea].scrollby(+2,0) );&quot;
onover=&quot;asyncloop(hovering, updatemousepos(), hideinfo() );&quot;
asyncloop(true, framehandler() );
</code></pre></div><p><strong>定时器</strong>：<code>setinterval(id, delay, actions) 、 clearinterval(id)</code>
按给定的时间定时重复执行指定的动作</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code>setinterval<span class="token punctuation">(</span><span class="token car">time</span>, 1.0, 
    jsget<span class="token punctuation">(</span><span class="token car">time</span>, <span class="token punctuation">(</span><span class="token car">new</span> Date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>.toLocaleTimeString<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">; );</span>
    trace<span class="token punctuation">(</span><span class="token quoted-symbol variable symbol">'time=</span>'<span class="token splice symbol variable">,time</span><span class="token punctuation">)</span><span class="token comment">;</span>
  <span class="token punctuation">)</span><span class="token comment">;</span>
&lt;events onkeydown=<span class="token string">&quot;setinterval(get(keycode), 0.1, trace(keycode); );&quot;</span>
        onkeyup=<span class="token string">&quot;clearinterval(get(keycode));&quot;</span>
        /&gt;
</code></pre></div><p><strong>切换：</strong><code>toggle(variable)</code>
针对指定逻辑变量的值，在 true 和 false 之间切换</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">toggle</span><span class="token punctuation">(</span>fullscreen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">toggle</span><span class="token punctuation">(</span>layer[button1].visible<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>交替真假：</strong><code>switch({variable})、switch({variable},{valueA},{valueB})</code>
转变变量的值</p> <ul><li>如果仅给一个变量，没有 value 参数，此时等效于 toggle() ，变量将在 true 与 false 之间变换 ；</li> <li>如果给定两个或更多的 value 参数，那么将依次从左到右转变 variable 的值。</li></ul> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">switch</span><span class="token punctuation">(</span>fullscreen<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">switch</span><span class="token punctuation">(</span>layer[button1].visible<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">switch</span><span class="token punctuation">(</span>layer[button1].alpha<span class="token punctuation">,</span> 1.0<span class="token punctuation">,</span> 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">switch</span><span class="token punctuation">(</span>layer[child].parent<span class="token punctuation">,</span> button1<span class="token punctuation">,</span> button2<span class="token punctuation">,</span> button3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">switch</span><span class="token punctuation">(</span>destpos<span class="token punctuation">,</span> -100<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> +100<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">tween</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>destpos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>跳出、中止：</strong><code>break()</code>
中断或停止当前的动作 ，当在 for()循环或 loop()循环中使用时，将仅停止循环自身
<strong>调用绑定：</strong><code>callwith(caller, actions)</code>
可以使用指定的 plugin/layer 或 hotspot 作为调用者，用于直接访问这些元素的属性或事件</p> <ul><li>caller</li></ul> <p>该元素将作为调用者，只能使用 plugin/layer 或 hotspot 元素</p> <ul><li>action</li></ul> <p>任意动作语句，这些语句将在调用者的语境中执行，这意味着可以直接访问元素的属性和事件</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token comment">//这里的onclick实际是指 layer[test].onclick();</span>
<span class="token function">callwith</span><span class="token punctuation">(</span>layer[test]<span class="token punctuation">,</span> onclick<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">callwith</span><span class="token punctuation">(</span>layer[test]<span class="token punctuation">,</span> <span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'test pos='</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//其中的alpha是指layer[test].alpha</span>
<span class="token function">callwith</span><span class="token punctuation">(</span>layer[test]<span class="token punctuation">,</span> <span class="token function">tween</span><span class="token punctuation">(</span>alpha<span class="token punctuation">,</span> 0.0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>style属性复制：</strong><code>assignstyle(elementname, styles)</code></p> <div class="language-bash extra-class"><pre class="language-bash"><code>assignstyle<span class="token punctuation">(</span>layer<span class="token punctuation">[</span>test<span class="token punctuation">]</span>, <span class="token string">'teststyle'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
assignstyle<span class="token punctuation">(</span>layer<span class="token punctuation">[</span>test<span class="token punctuation">]</span>, <span class="token string">'style1|style2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>将属性从一个或多个style元素的属性复制到目标元素。</p> <p><strong>属性克隆：</strong><code>copyattributes(destobject, srcobject)</code></p> <p>将一个对象的所有属性从复制到另一个。
<code>copyattributes(get(layer[test]), get(style[style1]));</code></p> <p><strong>从所有<code>&lt;events&gt;</code>元素中执行指定的事件：</strong><code>events.dispatch(eventname, instantly*)</code>
instantly一个布尔值设置(true或false，默认为false)。当设置为true时，事件将被调用并立即执行，当没有设置或设置为false时，事件将在当前的操作调用后被调用。</p> <div class="language-abnf extra-class"><pre class="language-abnf"><code>&lt;events <span class="token rule">name</span><span class="token operator">=</span><span class="token string">&quot;events1&quot;</span> <span class="token definition keyword">myevent</span><span class="token operator">=</span><span class="token string">&quot;trace(events1...);&quot;</span> <span class="token operator">/</span>&gt;
&lt;events <span class="token rule">name</span><span class="token operator">=</span><span class="token string">&quot;events2&quot;</span> <span class="token definition keyword">myevent</span><span class="token operator">=</span><span class="token string">&quot;trace(events2...);&quot;</span> <span class="token operator">/</span>&gt;
...
<span class="token rule">events</span>.<span class="token rule">dispatch</span><span class="token punctuation">(</span><span class="token rule">myevent</span><span class="token punctuation">)</span><span class="token comment">;</span>
</code></pre></div><h3 id="计算相关方法"><a href="#计算相关方法" class="header-anchor">#</a> 计算相关方法</h3> <p><strong>数学运算符</strong>
充许使用两到三个参数。</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">add</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> valueA<span class="token punctuation">,</span> valueB*<span class="token punctuation">)</span>
 <span class="token function">sub</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> valueA<span class="token punctuation">,</span> valueB*<span class="token punctuation">)</span>
 <span class="token function">mul</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> valueA<span class="token punctuation">,</span> valueB*<span class="token punctuation">)</span>
 <span class="token function">div</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> valueA<span class="token punctuation">,</span> valueB*<span class="token punctuation">)</span>
 <span class="token function">mod</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> valueA<span class="token punctuation">,</span> valueB*<span class="token punctuation">)</span>
 <span class="token function">pow</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> valueA<span class="token punctuation">,</span> valueB*<span class="token punctuation">)</span>
</code></pre></div><ul><li>两个参数的情况</li></ul> <div class="language-gcode extra-class"><pre class="language-gcode"><code>add(dst,val1) 等效于 dst = dst + val1
sub(dst,val1) 等效于 dst = dst - val1
mul(dst,val1) 等效于 dst = dst <span class="token punctuation">*</span> val1
div(dst,val1) 等效于 dst = dst / val1
mod(dst,val1) 等效于 dst = dst % val1
pow(dst,val1) 等效于 dst = dst ^ val1
</code></pre></div><ul><li>三个参数的情况</li></ul> <div class="language-gcode extra-class"><pre class="language-gcode"><code>add(dst,val1,val2) 等效于 dst = val1 + val2
sub(dst,val1,val2) 等效于 dst = val1 - val2
mul(dst,val1,val2) 等效于 dst = val1 <span class="token punctuation">*</span> val2
div(dst,val1,val2) 等效于 dst = val1 / val2
mod(dst,val1,val2) 等效于 dst = val1 % val2
pow(dst,val1,val2) 等效于 dst = val1 ^ val2
</code></pre></div><p><em>提示-var1与var2可以是具体的值也可是变量，当为变量时，会自动使用它们的真实值</em></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'val should be 2: val='</span><span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mul</span><span class="token punctuation">(</span>doublewidth<span class="token punctuation">,</span> width<span class="token punctuation">,</span> 2.0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mul</span><span class="token punctuation">(</span>scale<span class="token punctuation">,</span> 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">div</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> vala<span class="token punctuation">,</span> valb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span>rotate<span class="token punctuation">,</span>360<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">tween</span><span class="token punctuation">(</span>rotate<span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">,</span>5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add</span><span class="token punctuation">(</span>xpos<span class="token punctuation">,</span> mouse.x<span class="token punctuation">,</span> mouse_x_offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sub</span><span class="token punctuation">(</span>destx<span class="token punctuation">,</span> stagewidth<span class="token punctuation">,</span>  destwidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">div</span><span class="token punctuation">(</span>aspect<span class="token punctuation">,</span>16<span class="token punctuation">,</span>9<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mod</span><span class="token punctuation">(</span>cur_hlookat<span class="token punctuation">,</span>cur_hlookat<span class="token punctuation">,</span>360<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">pow</span><span class="token punctuation">(</span>sqrt<span class="token punctuation">,</span>val<span class="token punctuation">,</span>0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>自增加：</strong> <code>inc(variable, byvalue*, max*, min*)</code></p> <p><strong>自减少：</strong> <code>dec(variable, byvalue*, min*, max*)</code></p> <ul><li>variable</li></ul> <p>指定的变量</p> <ul><li>byvalue</li></ul> <p>每次增加或减少的量，如果无该参数，指定的量将被增加或减小 1</p> <ul><li>max / min</li></ul> <p>限定指定变量的最大值和最小值
当指定的变量达到其中一个限制时，该变量将被设置为另一个限制的值。这可以用来让指定的变量落在一定的范围或夹限在特定区域(使用 min=max)</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">inc</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">inc</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span>1<span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span>lastframe<span class="token punctuation">)</span><span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">inc</span><span class="token punctuation">(</span>ypos<span class="token punctuation">,</span>30<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">inc</span><span class="token punctuation">(</span>view.hlookat<span class="token punctuation">,</span> 2<span class="token punctuation">,</span> 90<span class="token punctuation">,</span> -90<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>限定：</strong><code>clamp(variable, min, max)</code>
限制变量的值在给定的最小和最大之间的值。</p> <ul><li>variable</li></ul> <p>欲被裁剪的变量</p> <ul><li>min</li></ul> <p>最小值 - 当指定的变量小于该值时，将被设置与该值相同</p> <ul><li>max</li></ul> <p>最大值 - 当指定的变量大于该值时，将被设置与该值相同</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code>clamp<span class="token punctuation">(</span><span class="token car">percent</span>, 0, <span class="token number">100</span><span class="token punctuation">)</span><span class="token comment">;</span>
screentolayer<span class="token punctuation">(</span><span class="token car">bar</span>, mouse.stagex<span class="token splice symbol variable">,mouse</span>.stagey, lx<span class="token splice symbol variable">,ly</span><span class="token punctuation">)</span><span class="token comment">;</span>
div<span class="token punctuation">(</span><span class="token car">fill</span>, lx, layer<span class="token punctuation">[</span>bar<span class="token punctuation">]</span>.pixelwidth<span class="token punctuation">)</span><span class="token comment">;</span>
mul<span class="token punctuation">(</span><span class="token car">fill</span>, <span class="token number">100</span><span class="token punctuation">)</span><span class="token comment">;</span>
clamp<span class="token punctuation">(</span><span class="token car">fill</span>, 0, <span class="token number">100</span><span class="token punctuation">)</span><span class="token comment">;</span>
txtadd<span class="token punctuation">(</span><span class="token car">layer</span><span class="token punctuation">[</span>barfill<span class="token punctuation">]</span>.width, get<span class="token punctuation">(</span><span class="token car">fill</span><span class="token punctuation">)</span>, <span class="token quoted-symbol variable symbol">'%</span>'<span class="token punctuation">)</span><span class="token comment">;</span>
</code></pre></div><p><strong>数学函数：</strong><code>Math.*</code>
Math对象提供一些用于数学运算的常量和动作；
大部份 Math 动作都有两种使用方式：一是只提供一个变量作为参数，此时该参数即是运算对象，同时又是运算后结果的存贮变量；二是提供两个参数，前一个用于存贮结果，后一个为运算对象。</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092049124.png" alt="图片描述"></p> <p><strong>数字取值（四舍五入）：</strong><code>roundval(variable, decimalplaces*)</code> //decimalplaces保留小位点位数，无此参数时表示不保留小数位(取整)</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code>roundval<span class="token punctuation">(</span><span class="token car">val</span><span class="token punctuation">)</span><span class="token comment">;</span>
roundval<span class="token punctuation">(</span><span class="token car">val</span>,2<span class="token punctuation">)</span><span class="token comment">;</span>
copy<span class="token punctuation">(</span><span class="token car">cur_hlookat</span><span class="token splice symbol variable">,view</span>.hlookat<span class="token punctuation">)</span><span class="token comment">;</span>
mod<span class="token punctuation">(</span><span class="token car">cur_hlookat</span>,360<span class="token punctuation">)</span><span class="token comment">;</span>
roundval<span class="token punctuation">(</span><span class="token car">cur_hlookat</span>,2<span class="token punctuation">)</span><span class="token comment">;</span>
copy<span class="token punctuation">(</span><span class="token car">cur_vlookat</span><span class="token splice symbol variable">,view</span>.vlookat<span class="token punctuation">)</span><span class="token comment">;</span>
roundval<span class="token punctuation">(</span><span class="token car">cur_vlookat</span>,2<span class="token punctuation">)</span><span class="token comment">;</span>
txtadd<span class="token punctuation">(</span><span class="token car">msg</span>,<span class="token quoted-symbol variable symbol">'looking</span> at '<span class="token splice symbol variable">,get</span><span class="token punctuation">(</span><span class="token car">cur_hlookat</span><span class="token punctuation">)</span>,<span class="token quoted-symbol variable symbol">'/</span>'<span class="token splice symbol variable">,get</span><span class="token punctuation">(</span><span class="token car">cur_vlookat</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">;</span>
</code></pre></div><h3 id="字符处理相关"><a href="#字符处理相关" class="header-anchor">#</a> 字符处理相关</h3> <p><strong>转16进制：</strong><code>tohex(variable, prefix*, length*)</code>
将给定的变量转换为十六进制字符串 ，可以用来生成 html/css 的色值字串</p> <ul><li>variable</li></ul> <p>给定的变量</p> <ul><li>prefix(可选)</li></ul> <p>前导字符(如 '0x' 或 '#')</p> <ul><li>length(可选)</li></ul> <p>返回值的长度</p> <div class="language-processing extra-class"><pre class="language-processing"><code><span class="token function">tohex</span><span class="token punctuation">(</span><span class="token type class-name">color</span><span class="token punctuation">,</span><span class="token string">'#'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span><span class="token type class-name">color</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>an_external_integer_input<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">tohex</span><span class="token punctuation">(</span><span class="token type class-name">color</span><span class="token punctuation">,</span><span class="token string">'#'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">txtadd</span><span class="token punctuation">(</span>layer<span class="token punctuation">[</span>text1<span class="token punctuation">]</span><span class="token punctuation">.</span>css<span class="token punctuation">,</span><span class="token string">'color:'</span><span class="token punctuation">,</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token type class-name">color</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>大小写转换：</strong><code>tolower(variable)</code>、<code>toupper(variable)</code></p> <p><strong>字符拼接：</strong><code>txtadd(destination, txt1, txt2*, txt3*, ...)</code>
若只有两个参数，则将第二个参数中的字符连接到目标变量(destination)的后面。多于两个参数时，则是将从每二个参数开始的所有参数依次连接在一起，并存贮到目标变量中</p> <ul><li>destination</li></ul> <p>用于存贮连接结果的目标变量
该变量不存在时将被自动创建</p> <ul><li>txt1,txt2,txt3,…(可选)</li></ul> <p>将被连接到一起的字符串
当只有一个txt参数时，该txt将被直接连接到当前目标变量(destination)的尾部
如果使用变量作为txt参数，一定要用get()来获取该变量的实际值</p> <div class="language-routeros extra-class"><pre class="language-text"><code>txtadd(picfilename,'%CURRENTXML%/pic_',get(pic),'.jpg');
txtadd(crop,'0|',get(ypos),'|333|285');
txtadd(pname, 'thumbbar_image_', get(i));
txtadd(layer[text].html,'[p]',get(data[txt1].content),'[/p]');
txtadd(msg,get(view.fovtype),'=',get(fov),'°');
</code></pre></div><p><strong>字符截取：</strong><code>subtxt(dstvar, srcvar, startpos, len)</code></p> <ul><li>dstvar</li></ul> <p>用于存贮所提取子串的目标变量，如果该变量不存在则会被自动创建</p> <ul><li>srcvar</li></ul> <p>来源字符串的变量</p> <ul><li>startpos</li></ul> <p>子串在源字符串中的起始位置</p> <ul><li>len</li></ul> <p>欲提取子串的长度</p> <div class="language-haxe extra-class"><pre class="language-haxe"><code><span class="token function">subtxt</span><span class="token punctuation">(</span>newvar<span class="token punctuation">,</span> abcdefg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">&gt;</span>  newvar<span class="token operator">==</span>bcd<span class="token punctuation">,</span>  第二个开始截取，截取<span class="token number">3</span>字符
</code></pre></div><p><strong>字符串搜索：</strong><code>indexoftxt(index, txt, searchtxt, startindex*)</code>
返回搜索字符(searchtxt)在字符串(txt)中的起始位置(index)</p> <ul><li>index</li></ul> <p>用于存贮返回值的变量，若返回 -1 则表示搜索字符串(searchtxt)不存在字符串(txt)中；如果该变量不存在则自动创建</p> <ul><li>txt</li></ul> <p>源字符串</p> <ul><li>searchtxt</li></ul> <p>欲搜索的子字符串</p> <ul><li>startindex(可选)</li></ul> <p>指定从源字符串的搜索子串时的起始位置(默认为0)</p> <p><strong>字符串替换：</strong><code>txtreplace(var, searchtext, replacetext)、 txtreplace(dstvar, srcvar, searchtext, replacetext)</code>
用字符串replacetext替换源字符串var/srcvar中的searchtext字符串</p> <ul><li>var / srcvar / dstvar</li></ul> <p>用于搜索的源字符串变量(var, srcvar)以及用于存贮返回结果的变量(var, dstvar)。如果该变量不存在则自动创建</p> <ul><li>searchtxt</li></ul> <p>将要被替换掉的旧字符串</p> <ul><li>replacetxt</li></ul> <p>欲替换旧字符串的新字符串</p> <p><strong>字符串分割：</strong><code>txtsplit(string, separator, resultingarray)、txtsplit(string, separator, var1, var2, ...)</code></p> <ul><li>string</li></ul> <p>欲分割的字符串，可以为实际的字符或字符串变量</p> <ul><li>separator</li></ul> <p>分割标记字符</p> <ul><li>resultingarray当用三个参数使用txtsplit()时</li></ul> <p>用于存贮分割结果的数组变量名，分割的字符逐个放个该数组成员的'value'属性中</p> <ul><li>var1,var2,…当用四个或更多参数使用txtsplit()时，分割出来的字符串将依次存入这些给定的变量中</li></ul> <div class="language-routeros extra-class"><pre class="language-text"><code>Split into separate variables:
txtsplit('1|2|3', '|', a, b, c);
trace('a=',get(a), ' b=',get(b), ' c=',get(c));
Result:
a=1 b=2 c=3
Split into an array:
txtsplit('x|y|z', '|', arr);
for(set(i,0), i LT arr.count, inc(i),
  trace('arr[',get(i),'].value=',arr[get(i)].value);
);
Result:
arr[0].value=x
arr[1].value=y
arr[2].value=z
</code></pre></div><p><strong>转码：</strong><code>fromcharcode(var, charcode)</code>
将一个Unicode字符编码值转换为字符并存入变量(var)中</p> <ul><li>var</li></ul> <p>用于存贮转换结果的变量</p> <ul><li>carcode</li></ul> <p>Unicode字符编码值
<strong>转义和反转义：</strong><code>escape(var)、escape(var, text)</code>、<code>unescape(var)、unescape(var, text)</code>
对字符串进行编码、解码</p> <ul><li>var</li></ul> <p>无 text 参数时 - 该变量自身将被编码或解码；
有 text 参数时 - 该变量将用来存贮 text 编码或解码后的字符</p> <ul><li>text(可选)</li></ul> <p>将被编码或解码的字符串</p> <h3 id="动画"><a href="#动画" class="header-anchor">#</a> 动画</h3> <p><strong>动画语句：</strong><code>tween(variable, value, time*, tweentype*, donecall*, updatecall*)</code></p> <p>补间动作，通过动态改变指定变量值实现动画效果
颜色支持 当指定的变量名中含有'color'这个关键字时，那么它的值将自动解析为32位的ARGB色值并且单独处理每个颜色通道
多变量支持 可以同时处理多个变量，这时要使用'|'来分隔这些变量(variable)、值(value)和被间动作类型(tweentype)，当变量有多个，而只有一个值或补间类型时，那么所有变量将使用相同补间动作类型或被转变到相同的值，并且对于所有变量来说，time、donecall以及updatecall也都是相同的</p> <ul><li>variable</li></ul> <p>将被改变的变量
使用|字符来分隔多个变量
当变量名中含有关键字'color'时，变量值将被处理为32位的ARGB色值</p> <ul><li>value</li></ul> <p>变量的目标值
若值前面有'%'字符，将按百分比方式处理
使用|字符来分隔多个变量对应的不同值
当使用变量来作为value参数时，需使用 get() 动作来获取变量的实际值</p> <ul><li>time(可选)</li></ul> <p>从当前值改变到目标值所需秒数(默认 0.5 秒)
还可以通过 distance() 语句来动态指定时间(不支持多变量补间)，distance()的原理是通过设置指定值域变化的最大时间来动态设置本次补间所需的实际时间，这样一来，对于变化量小的补量则用时短；相反对于变化量大的补间则用时就长，主要是改善用户体验。
下面是 distance() 语句用法</p> <div class="language-leaf extra-class"><pre class="language-text"><code>#distance(dvalue,dtime)
#dvalue - 值变化的区间
#dtime - 值在区间内变化完成需要时间
</code></pre></div><ul><li>tweentype(可选)</li></ul> <p>补间动作的插值计算类型(默认 easeOutQuad )
更多补间动作类型：tweentypes</p> <ul><li>donecall(可选)</li></ul> <p>当补间动作完成且指定变量已达到目标值时，执行本参数中的动作
除了常规动作，还可以在这里使用特殊关键字 WAIT ，在这种情况下，用户界面以及后续的动作将被阻止，直到指定变量达到目标的值</p> <ul><li>updatecall(可选)</li></ul> <p>指定变量在每一次(每一帧)更新时，都会执行该参数中动作
<em>警告- 谨慎使用！会增加系统负担拖慢帧速率</em></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">tween</span><span class="token punctuation">(</span>view.vlookat<span class="token punctuation">,</span> 90.0<span class="token punctuation">,</span> 2.0<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//视觉转为向上垂直90度，转换视觉过程为2秒</span>
<span class="token function">tween</span><span class="token punctuation">(</span>layer[skin_scroll_layer].y<span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span>mh<span class="token punctuation">)</span><span class="token punctuation">,</span> 0.5<span class="token punctuation">,</span> easeOutQuint<span class="token punctuation">,</span> <span class="token function">set</span><span class="token punctuation">(</span>layer[skin_map].visible<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//皮肤滚动条组件Y轴坐标改变到指定位置，转换坐标过程为0.5秒，转换模式为easeOutQuint，转换完成后执行set(layer[skin_map].visible,false)</span>
</code></pre></div><p><strong>停止动画：</strong><code>stoptween(variable, ...)</code>
停止当前运行中的补间动作</p> <ul><li>variable</li></ul> <p>当前正在对该变量进行补间操作的动作将被停止</p> <ul><li>… variable, variable, …(可选)</li></ul> <p>将被停止补间的其它的变量</p> <div class="language-abnf extra-class"><pre class="language-abnf"><code><span class="token definition keyword">ondown</span><span class="token operator">=</span><span class="token string">&quot;tween(layer[text].y, 10, distance(400,0.7), linear);&quot;</span>
<span class="token definition keyword">onup</span><span class="token operator">=</span><span class="token string">&quot;stoptween(layer[text].y);&quot;</span>
</code></pre></div><p><strong>动画类型tweentype：</strong></p> <p><img src="https://esqbs.github.io/image_store/blog/202404092043107.png" alt="图片描述"></p> <h3 id="动态加载"><a href="#动态加载" class="header-anchor">#</a> 动态加载</h3> <p><strong>加载新的全景</strong>
注意- 只有具备 keep=“true” 属性的图层、插件、热点、事件和光晕元素在新场景中才被保留</p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token func"><span class="token function">loadpano</span><span class="token punctuation">(</span>xmlpath<span class="token punctuation">,</span> vars<span class="token operator">*</span><span class="token punctuation">,</span> flags<span class="token operator">*</span><span class="token punctuation">,</span> blend<span class="token operator">*</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">loadscene</span><span class="token punctuation">(</span>scenename<span class="token punctuation">,</span> vars<span class="token operator">*</span><span class="token punctuation">,</span> flags<span class="token operator">*</span><span class="token punctuation">,</span> blend<span class="token operator">*</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">loadpanoscene</span><span class="token punctuation">(</span>xmlpath<span class="token punctuation">,</span> scenename<span class="token punctuation">,</span> vars<span class="token operator">*</span><span class="token punctuation">,</span> flags<span class="token operator">*</span><span class="token punctuation">,</span> blend<span class="token operator">*</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">loadxml</span><span class="token punctuation">(</span>xmlstring<span class="token punctuation">,</span> vars<span class="token operator">*</span><span class="token punctuation">,</span> flags<span class="token operator">*</span><span class="token punctuation">,</span> blend<span class="token operator">*</span><span class="token punctuation">)</span></span>
</code></pre></div><p><img src="https://esqbs.github.io/image_store/blog/202404092043468.png" alt="图片描述"></p> <p><img src="https://esqbs.github.io/image_store/blog/202404092044394.png" alt="图片描述"> <em>注意- 当选定的混合模式不被环境支持时(例如在Flashplayer下使用仅支持WebGL的模式)，那么将自动回退到默认的混合方式(NOBLEND)</em></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">loadpano</span><span class="token punctuation">(</span>pano2.xml<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span>pano2.xml<span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> MERGE<span class="token punctuation">,</span> <span class="token function">BLEND</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadscene</span><span class="token punctuation">(</span>scene1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadscene</span><span class="token punctuation">(</span>scene1<span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> MERGE<span class="token punctuation">,</span> <span class="token function">BLEND</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadxml</span><span class="token punctuation">(</span><span class="token string">'&lt;krpano&gt;&lt;image&gt;&lt;sphere url=&quot;pano.jpg&quot;/&gt;&lt;/image&gt;&lt;/krpano&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadxml</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>data[xml].content<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> KEEPALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span><span class="token string">'%SWFPATH%/pano.xml'</span><span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> MERGE<span class="token punctuation">,</span> <span class="token function">BLEND</span><span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span>sphere.xml<span class="token punctuation">,</span> image.hfov=1.0&amp;view.limitview=fullrange<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>打开地址：</strong><code>openurl(url, target*)</code></p> <ul><li>url</li></ul> <p>待打开的url</p> <ul><li>target(可选)</li></ul> <p>_blank - 在新窗口中打开(默认)
_self - 在当前窗口的当前帧中打开
_parent - 在当前帧的父窗口中打开
_top - 在当前窗口的顶层帧中打开
<em>Flash模式时要注意 - 该动作需要Flashplayer的扩展接口支持，它只在浏览器内部有效，当工作在离线或使用“file:“本地url浏览时就需要对Flashplayer进行安全设置</em></p> <div class="language-lisp extra-class"><pre class="language-lisp"><code>openurl<span class="token punctuation">(</span><span class="token quoted-symbol variable symbol">'http</span><span class="token lisp-property property">://krpano</span>.com'<span class="token splice symbol variable">,_self</span><span class="token punctuation">)</span><span class="token comment">;</span>
openurl<span class="token punctuation">(</span><span class="token quoted-symbol variable symbol">'help</span>.html'<span class="token punctuation">)</span><span class="token comment">;</span>
</code></pre></div><p><strong>调用js网页跳转：</strong> <code>js(eval(this.location=&quot;{url}&quot;))</code></p> <h3 id="视图、相机控制"><a href="#视图、相机控制" class="header-anchor">#</a> 视图、相机控制</h3> <p><strong>视图设置：</strong><code>lookat(h, v, fov*, distortion*, architectural*, pannini*)</code>
观看全景的指定位置</p> <ul><li>h - 球面坐标中的水平方向角度(-180 到 +180)-view.hlookat</li> <li>v - 球面坐标中的垂直方向角度(-90 到 +90)-view.vlookat</li> <li>fov(可选) - 视域度数(0 到 179)-view.fov</li> <li>distortion (可选) - 鱼眼扭曲设置 -view.distortion</li> <li>architectural (可选) - 建筑投影设置 -view.architectural</li></ul> <p>pannini1)(可选) - pannini投影设置 -view.pannini</p> <div class="language-apache extra-class"><pre class="language-text"><code>lookat(0,0);
lookat(0,0,90);
loadpano(pano.xml);
lookat(45.1, -20.2, 110.0);
</code></pre></div><p><strong>视图变化：</strong></p> <div class="language-elm extra-class"><pre class="language-elm"><code><span class="token hvariable">lookto</span><span class="token punctuation">(</span><span class="token hvariable">toH</span><span class="token punctuation">,</span><span class="token hvariable">toV</span><span class="token punctuation">,</span><span class="token hvariable">fov</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token hvariable">motiontype</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token hvariable">shortestway</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token hvariable">nonblocking</span><span class="token operator">*</span><span class="token punctuation">,</span><span class="token hvariable">donecall</span><span class="token operator">*</span><span class="token punctuation">)</span>
 <span class="token hvariable">looktohotspot</span><span class="token punctuation">(</span><span class="token hvariable">hotspotname</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token hvariable">fov</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token hvariable">motiontype</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token hvariable">shortestway</span><span class="token operator">*</span><span class="token punctuation">)</span>
 <span class="token hvariable">moveto</span><span class="token punctuation">(</span><span class="token hvariable">toH</span><span class="token punctuation">,</span> <span class="token hvariable">toV</span><span class="token punctuation">,</span> <span class="token hvariable">motiontype</span><span class="token operator">*</span><span class="token punctuation">)</span>
 <span class="token hvariable">zoomto</span><span class="token punctuation">(</span><span class="token hvariable">fov</span><span class="token punctuation">,</span> <span class="token hvariable">motiontype</span><span class="token operator">*</span><span class="token punctuation">)</span>
</code></pre></div><p>将视图从当前位置移动给定的位置</p> <p><em>注意- 在移动期间所有用户界面及其它动作都将被阻塞，这意味着其它动作只能在当前动作完成后才能执行。可以使用 oninterrupt() 来充许用户中断该动作</em></p> <p><img src="https://esqbs.github.io/image_store/blog/202404092044116.png" alt="">
例子</p> <div class="language-apache extra-class"><pre class="language-text"><code>moveto(100.0,5,linear(10));
zoomto(130,smooth());
lookto(33,-22,30,smooth(100,50,20));
looktohotspot(hotspot1);
looktohotspot(hotspot2, 40);
looktohotspot(hotspot3, 25, smooth(100,50,20));
looktohotspot(get(name));
</code></pre></div><p><strong>调整视图：</strong><code>adjusthlookat(desthlookat)</code>调整view.hlookat值</p> <p>解决360度环绕中到达目标水平位置(desthlookat)的最短路径</p> <ul><li>desthlookat</li></ul> <p>为 0 时，可以从 view.hlookat 中获取正确的当前水平位置值：-180 到 +180
为任意 0到360 的值时，则会修正从当前位置到达该水平位置的最短运动方式
可以直接使用变量，会自动获取实际值
此时当前的view.hlookat会被调整到与该参数的邻近值(不改变当前视图)</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token comment">//用途一:让读取的view.hlookat值正确落在 -180到+180 的范围内</span>
<span class="token function">adjusthlookat</span><span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">trace</span><span class="token punctuation">(</span>view.hlookat<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//用途二:修正view.hlookat，以期通过最短路径方式移动到目标水平位置</span>
<span class="token function">adjusthlookat</span><span class="token punctuation">(</span>140<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">tween</span><span class="token punctuation">(</span>view.hlookat<span class="token punctuation">,</span> 140<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>获得球面距离：</strong><code>getlooktodistance(result, toH, toV, fromH*, fromV*)</code>
获取球面坐标中两个位置之间的夹角度数(0到180度)</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092044448.png" alt="img"> <strong>停止 lookto / looktohotspot / moveto / zoomto事件：</strong><code>stoplookto()</code>
停止一个未阻塞的 lookto()/looktohotspot()/moeto()/zoomto()动作</p> <p><strong>停止用户操作：</strong><code>stopmovements()</code>
立即停止用户触发的(通过鼠标、键盘或触控板)所有panning投影和缩放行为</p> <p><strong>等待：</strong><code>wait(parameter)</code>
等待若干秒的时间或等待特定的事件(LOAD 或 BLEND)
<em>注意- 用户界面及所有后续动作将被阻塞，这意味着后面的动作只能在当前动作完成之后才能得到执行。可以使用 oninterrupt 以便让用户有中断能力</em></p> <ul><li>parameter 有以下三种可能</li></ul> <p>任意数字 - 等待的时间秒数
LOAD - 一直等待直到加载完成
BLEND - 一直等待直到混合效果处理完成</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">oninterrupt</span><span class="token punctuation">(</span>break<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lookto</span><span class="token punctuation">(</span>150<span class="token punctuation">,</span>30<span class="token punctuation">,</span>70<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">wait</span><span class="token punctuation">(</span>3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lookto</span><span class="token punctuation">(</span>242<span class="token punctuation">,</span>0<span class="token punctuation">,</span>150<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lookto</span><span class="token punctuation">(</span>280<span class="token punctuation">,</span>-10<span class="token punctuation">,</span>50<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">wait</span><span class="token punctuation">(</span>3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span>pano2.xml<span class="token punctuation">,</span><span class="token null keyword">null</span><span class="token punctuation">,</span>MERGE<span class="token punctuation">,</span><span class="token function">BLEND</span><span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lookat</span><span class="token punctuation">(</span>100<span class="token punctuation">,</span>50<span class="token punctuation">,</span>5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">wait</span><span class="token punctuation">(</span>BLEND<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lookto</span><span class="token punctuation">(</span>100<span class="token punctuation">,</span>50<span class="token punctuation">,</span>150<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>oninterrupt：</strong><code>oninterrupt(actions)</code>
在处理一些会阻塞用户界面的动作之前(如 lookto()、looktohotspot()、moveto()、zoomto()、wait()以及使用WAIT作为donecall参数的tween())，使用该语句，用户就可以随时通过操控界面(如点击动作)来中止这些动作的执行，同时执行参数内容中的动作。</p> <ul><li>action</li></ul> <p>用户中断后要执行的命令
另外这里还有一个特殊的命令：
break - 仅中断当前动作(无其它附加命令)</p> <h3 id="坐标相关"><a href="#坐标相关" class="header-anchor">#</a> 坐标相关</h3> <p><strong>屏幕坐标和球坐标之间的转换：</strong><code>screentosphere(x,y, h,v)、 spheretoscreen(h,v, x,y, stereoside*)</code>
屏幕坐标与球面坐标之间的相互转换</p> <ul><li>screentosphere - 将屏幕上的x/y转换为球面中的h/v</li> <li>spheretoscreen - 将球面中的h/v转换为屏幕上的x/y</li> <li>x/y - 以左上角为原点的屏幕像素坐标</li> <li>h/v - 球面上的方位角度(380×180)</li> <li>stereoside (可选)</li></ul> <p>针对分屏VR模式 - 定义哪一边的屏幕坐标，可能的设置有两种：l- 左屏；r- 右屏；或者不设置表示无分屏的普通坐标</p> <ul><li>注意：</li></ul> <p>x,y,h,v必须为变量名，不充许使用确切的数值
如果变量未定义，它将被自动创建
<code>screentosphere(mouse.x, mouse.y, toh, tov);</code></p> <p><strong>屏幕坐标和层的坐标：</strong><code>screentolayer(layer, screenx,screeny, layerx,layery)</code>、<code>layertoscreen(layer, layerx,layery, screenx,screeny)</code>
在真实屏幕与相对图层坐标之间转换</p> <ul><li>layer - 图层元素名称</li> <li>screenx/screeny - 屏幕上相对左上角的坐标像素值变量</li> <li>layerx/layery - 相对于左上角的图层坐标变量</li></ul> <p><strong>注意：</strong>
屏幕坐标系是从左上角 (x=0; y=0) 到右下角 (x=stagewidth; y=stateheight)
如果使能scalechildren，那么层坐标也会被缩放
不支持旋转的层
所有参数必须为变量，不充许使用常量
当变量不存在时，它将被创建</p> <div class="language-arduino extra-class"><pre class="language-arduino"><code><span class="token function">screentolayer</span><span class="token punctuation">(</span>bar<span class="token punctuation">,</span> mouse<span class="token punctuation">.</span>stagex<span class="token punctuation">,</span>mouse<span class="token punctuation">.</span>stagey<span class="token punctuation">,</span> lx<span class="token punctuation">,</span>ly<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">div</span><span class="token punctuation">(</span><span class="token builtin">fill</span><span class="token punctuation">,</span> lx<span class="token punctuation">,</span> layer<span class="token punctuation">[</span>bar<span class="token punctuation">]</span><span class="token punctuation">.</span>pixelwidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mul</span><span class="token punctuation">(</span><span class="token builtin">fill</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">clamp</span><span class="token punctuation">(</span><span class="token builtin">fill</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">txtadd</span><span class="token punctuation">(</span>layer<span class="token punctuation">[</span>barfill<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">width</span><span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token builtin">fill</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">'%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>remapfovtype：</strong><code>remapfovtype(fov, srcfovtype, dstfovtype)、 remapfovtype(fov, srcfovtype, dstfovtype, width, height)</code>
就当前视域范围，重新计算出另一种fovtype对应的新fov值
在改变fovtype及重新计算对应fov的过程中，当前视域(镜头变焦)不会变化</p> <ul><li><p>fov - 将被改变的fov变量, 返回的新值也将存贮在该变量中</p></li> <li><p>srcfovtype - 当前的fovtype, 可以是：HFOV,VFOV,DFOV或者MFOV</p></li> <li><p>dstfovtype - 新的fovtype, 可以是：HFOV,VFOV,DFOV或者MFOV</p></li> <li><p>bwidth (可选) - 指定视图区域的宽度像素数, 默认为当前视图尺寸</p></li> <li><p>height (可选) - 指定视图区域的高度像素数, 默认为当前视图尺寸</p></li></ul> <div class="language-sas extra-class"><pre class="language-sas"><code><span class="token function keyword">set</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>fovtype<span class="token punctuation">,</span> HFOV<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function keyword">set</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>fov<span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token function keyword">set</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>fovtype<span class="token punctuation">,</span> VFOV<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function keyword">remapfovtype</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>fov<span class="token punctuation">,</span> HFOV<span class="token punctuation">,</span> VFOV<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="更新重绘"><a href="#更新重绘" class="header-anchor">#</a> 更新重绘</h3> <p><strong>更新/重建pano对象的内部3D模型：</strong><code>updateobject(updateall*, updatefov*)</code>
重建全景对象的3D模型</p> <p>在浏览时动态改变display.details以及display.tessmode后必须使用这个语句以更新全景。当在交互方式更改image.hfov,image.vfov或者image.voffset这些设置时，应使用updatefov=true试调用该语句，以便得到更新后的全景对象</p> <p><em>注意-该语句很消耗系统资源，请谨慎使用!</em></p> <ul><li>updateall (可选)</li></ul> <p>针对多重分辨率 - 是否更新所有层
可能的设置：true 或 false (默认为 false)</p> <ul><li>updatefov (可选)</li></ul> <p>全景更新同时重新解析出新的image.hfov,image.vfov以及image.voffset
可能的设置：true 或 false (默认为 false)</p> <div class="language-processing extra-class"><pre class="language-processing"><code><span class="token function">set</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>hfov<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">updateobject</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>屏幕重绘：</strong><code>updatescreen()</code>
直接强制重绘当前屏幕内容</p> <p><strong>重绘屏幕，并重置idletime计数器：</strong><code>invalidatescreen()</code>
直接强制重绘当前屏幕内容，并全重置idletime计数(无用户交互时间计数)</p> <h3 id="热点添加及移除"><a href="#热点添加及移除" class="header-anchor">#</a> 热点添加及移除</h3> <p><strong>动态地创建和添加:</strong></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">addlayer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token function">addplugin</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token function">addhotspot</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token function">addlensflare</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> ath*<span class="token punctuation">,</span> atv*<span class="token punctuation">)</span>
</code></pre></div><p>动态创建一个新的图层、插件、热点或光晕</p> <ul><li>name - 待创建的新元素名称(最好使用小写英文,不要使用数字或其它字符开头)</li> <li>ath/atv (仅针对光晕) - 光晕的空间位置</li></ul> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">addlayer</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addhotspot</span><span class="token punctuation">(</span>newspot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addhotspot</span><span class="token punctuation">(</span>polyspot<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">addlensflare</span><span class="token punctuation">(</span>sun<span class="token punctuation">,</span> 20<span class="token punctuation">,</span> -60<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>移除：</strong></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">removelayer</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> removechildren*<span class="token punctuation">)</span>
<span class="token function">removeplugin</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> removechildren*<span class="token punctuation">)</span>
<span class="token function">removehotspot</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token function">removelensflare</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
</code></pre></div><p>动态删除一个图层、插件、热点或光晕</p> <ul><li>name - 待删除的元素名称</li> <li>removechildren (可选) - 设置为true时，该元素的所有子元素也将被删除</li></ul> <p><strong>layer/plugin/hotspot专属：</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token property-declaration"><span class="token property">layer</span> <span class="token operator">/</span> plugin <span class="token operator">/</span> hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span>.<span class="token func"><span class="token function">loadstyle</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span></span></span>
<span class="token property-declaration"><span class="token property">layer</span> <span class="token operator">/</span> plugin <span class="token operator">/</span> hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span>.<span class="token func"><span class="token function">registercontentsize</span><span class="token punctuation">(</span>imagewidth<span class="token punctuation">,</span>imageheight<span class="token punctuation">)</span></span></span>
<span class="token property-declaration"><span class="token property">layer</span> <span class="token operator">/</span> plugin <span class="token operator">/</span> hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span>.<span class="token func"><span class="token function">resetsize</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
<span class="token property-declaration"><span class="token property">layer</span> <span class="token operator">/</span> plugin <span class="token operator">/</span> hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span>.<span class="token func"><span class="token function">updatepos</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
<span class="token property-declaration"><span class="token property">layer</span> <span class="token operator">/</span> plugin <span class="token operator">/</span> hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span>.<span class="token func"><span class="token function">changeorigin</span><span class="token punctuation">(</span>align<span class="token punctuation">,</span>edge<span class="token punctuation">)</span></span></span>
<span class="token property-declaration"><span class="token property">layer</span> <span class="token operator">/</span> plugin <span class="token operator">/</span> hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span>.<span class="token func"><span class="token function">getfullpath</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></span>
hotspot<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">getcenter</span><span class="token punctuation">(</span>ath<span class="token punctuation">,</span>atv<span class="token punctuation">)</span></span>
</code></pre></div><h3 id="js扩展"><a href="#js扩展" class="header-anchor">#</a> JS扩展</h3> <p><strong>调用js函数：</strong><code>js( &quot;Javascript函数(参数)&quot; )</code></p> <p>调用一个Javascript函数，在实际调用js代码之前，其中的参数将预先被krpano解析，记得要使用get(var)语句去获取变量的确切值</p> <blockquote><p>Flash模式时注意 - 该语句需要使用Flashplayer的扩展接口，它仅在浏览器内部且在线时有效，当离线浏览或本地url浏览，那么就需要设置Flashplayer的安全设置项</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//以下是存在于js或 html文件中的Javascript代码</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>p1 <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> p2 <span class="token operator">+</span> <span class="token string">&quot; / &quot;</span> <span class="token operator">+</span> p3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//全景项目中的调用代码</span>
<span class="token function">js</span><span class="token punctuation">(</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Lookat'</span><span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>hlookat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>vlookat<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>调用js代码：</strong><code>jscall( &quot;...任意Javascript代码... &quot;)</code></p> <p>直接在全景中执行任何Javascript代码，可以在Javascript代码中直接读写krpano的js接口对象</p> <blockquote><p>Flash模式时注意 - 该语句需要使用Flashplayer的扩展接口，它仅在浏览器内部且在线时有效，当离线浏览或本地url浏览，那么就需要设置Flashplayer的安全设置项</p></blockquote> <div class="language-awk extra-class"><pre class="language-awk"><code><span class="token regex">//</span>改变html元素的风格
<span class="token function">jscall</span><span class="token punctuation">(</span>'document.<span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span>.style.display<span class="token operator">=</span><span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token regex">//</span>使用<span class="token function">calc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>语句构建js语句并使用krpano变量
<span class="token function">jscall</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>'console.<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;krpano version: ' + version + '&quot;</span><span class="token punctuation">)</span>'<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token regex">//</span>返回前一页面
<span class="token function">jscall</span><span class="token punctuation">(</span>'history.<span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>'<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>获取一个Javascript变量的值或一个Javascript函数的返回值：</strong><code>jsget(variable, ...Javascript代码... )</code></p> <p>获取Javascript变量或Javascript函数的值，可以在js代码读写krpano接口对象</p> <ul><li>variable</li></ul> <p>用于存贮返回值的变量名
如果变量不存在则自动创建</p> <blockquote><p>Flash模式时注意 - 该语句需要使用Flashplayer的扩展接口，它仅在浏览器内部且在线时有效，当离线浏览或本地url浏览，那么就需要设置Flashplayer的安全设置项</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//得到当前页面的地址</span>
<span class="token function">jsget</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> <span class="token string">'location.href'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'地址为：'</span><span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//让用户输入内容</span>
<span class="token function">jsget</span><span class="token punctuation">(</span>passwort<span class="token punctuation">,</span> <span class="token string">'prompt(&quot;请输入口令&quot;)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>password <span class="token operator">==</span> <span class="token string">'hidden'</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//得到当前日期(YYYY-MM-DD):</span>
<span class="token function">jsget</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token string">'new Date().toISOString().slice(0,10);'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">'日期为：'</span><span class="token punctuation">,</span> <span class="token function">get</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
js网页跳转： <span class="token function">js</span><span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>location<span class="token operator">=</span><span class="token string">&quot;{url}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
调用软窗口： <span class="token function">js</span><span class="token punctuation">(</span><span class="token function">openWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>width<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>height<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>yes<span class="token operator">/</span>no<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
调用搜索查询窗口： <span class="token function">js</span><span class="token punctuation">(</span><span class="token function">openWindow</span><span class="token punctuation">(</span>search<span class="token punctuation">.</span>html<span class="token punctuation">,</span><span class="token number">290</span><span class="token punctuation">,</span><span class="token number">330</span><span class="token punctuation">,</span>搜索查询<span class="token punctuation">,</span>no<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
提示窗口： <span class="token function">js</span><span class="token punctuation">(</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>弹出窗口<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="调试"><a href="#调试" class="header-anchor">#</a> 调试</h3> <p><strong>是否显示输出日志：</strong><code>showlog(state*)</code>
显示或隐藏日志信息</p> <ul><li>state (可选) - true: 显示日志信息(默认), false: 隐藏日志信息</li></ul> <p><strong>变量跟踪：</strong> <code>debugvar(varname)</code>
在输出日志中显示/跟踪关于变量的详细信息（值和类型），当变量是一个对象时，也将显示所有对象属性。</p> <p><strong>打印调试信息</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">debug</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token function">trace</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token function">warning</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token function">error</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre></div><p>将文本或变量输出到日志信息中</p> <ul><li>trace - 信息以”INFO:“开头(白色字体)</li> <li>error - 信息以”ERROR:“开头(黄色字体)</li> <li>warning - 信息以”WARNING:“开头(蓝色字体)</li> <li>debug - 信息以”DEBUG:“开头(绿色字体)，并且仅在 debugmode=true 时才显示</li></ul> <p><em>注意- 过多地输入跟踪信息会影响全景渲染效率，尤其不要在每一帧都有跟踪信息</em></p> <div class="language-xml extra-class"><pre class="language-xml"><code>trace('view.maxpixelzoom=', view.maxpixelzoom);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>events</span> <span class="token attr-name">onkeydown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>trace('keycode=',keycode);<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
onresize=&quot;trace('size=',stagewidth,'x',stageheight);&quot;
onclick=&quot;trace('mouse clicked at ', mouse.x, ' / ', mouse.y);&quot;
trace('xyz=',xyz,' get(xyz)=',get(xyz));
</code></pre></div><p><strong>显示一个错误消息,并阻止用户交互:</strong><code>fatalerror(errormessage)</code></p> <ul><li>errormessage - 待显示的错误信息</li></ul> <h3 id="文字"><a href="#文字" class="header-anchor">#</a> 文字</h3> <p><strong>显示文字（废弃）：</strong><code>showtext(text, textstyle*)</code>
在屏幕上显示字符串内容</p> <ul><li>注意：</li></ul> <ol><li>以前是内置语句，现在已由showtext.xml这个默认内含插件实现</li> <li>同一时刻只能显示一个字符串，再次显示新字符串时，当前字符将被清除</li></ol> <p><img src="https://esqbs.github.io/image_store/blog/202404092044188.png" alt="图片描述"></p> <div class="language-abnf extra-class"><pre class="language-abnf"><code><span class="token definition keyword">onhover</span><span class="token operator">=</span><span class="token string">&quot;showtext(you are hovering me);&quot;</span>
<span class="token definition keyword">onhover</span><span class="token operator">=</span><span class="token string">&quot;showtext(style text,TEXTSTYLE);&quot;</span> <span class="token operator">/</span><span class="token operator">/</span>样式调用
<span class="token definition keyword">onhover</span><span class="token operator">=</span><span class="token string">&quot;showtext(line 1[br]line 2[br]line 3);&quot;</span> <span class="token operator">/</span><span class="token operator">/</span>分行
<span class="token definition keyword">onhover</span><span class="token operator">=</span><span class="token string">&quot;showtext([b]bold[/b] [i]italic[/i]);&quot;</span> <span class="token operator">/</span><span class="token operator">/</span>字体
</code></pre></div><h3 id="汇总"><a href="#汇总" class="header-anchor">#</a> 汇总</h3> <p>官方地址：<a href="https://link.segmentfault.com/?enc=2K%2BSHm0AFDmb1iClRkqElA%3D%3D.KTjIuKl%2Fo01bxmHehRcOmKZwV0UfF9IerWzj0FNC%2BQ5RZXNKU5OiJ8YbBpbAzrQO" target="_blank" rel="noopener noreferrer">https://krpano.com/docu/quick...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="常用操作"><a href="#常用操作" class="header-anchor">#</a> 常用操作</h2> <h3 id="层级问题"><a href="#层级问题" class="header-anchor">#</a> 层级问题</h3> <p>方法1.在html中可以使用最大z-index：2147483647避免全屏下弹窗被覆盖问题（慎用）
方法2：将弹窗生成在全景容器内</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092044090.png" alt="图片描述"></p> <h3 id="音乐"><a href="#音乐" class="header-anchor">#</a> 音乐</h3> <p>预加载MP3文件：<code>preloadsound({mp3});</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">playsound</span><span class="token operator">:</span> <span class="token function">playsound</span><span class="token punctuation">(</span><span class="token punctuation">{</span>voice<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>mp3<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Cycle<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>execution<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">playsound2D</span><span class="token operator">:</span> <span class="token function">playsound2D</span><span class="token punctuation">(</span><span class="token punctuation">{</span>voice<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>mp3<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Volume<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Track <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Cycle<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>execution<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token literal-property property">playsound3D</span><span class="token operator">:</span> <span class="token function">playsound3D</span><span class="token punctuation">(</span><span class="token punctuation">{</span>voice<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>mp3<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>ath<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>atv<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>range<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Volume<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Cycle<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>execution<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">playsound3DHS</span><span class="token operator">:</span> <span class="token function">playsound3DHS</span><span class="token punctuation">(</span><span class="token punctuation">{</span>voice<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>mp3<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>range<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Volume <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>Cycle <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token operator">*</span><span class="token punctuation">{</span>execution<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>暂停声音：<code>pausesound({voice});</code></p> <p>恢复声音：<code>resumesound({voice});</code></p> <p>暂停/恢复声音：<code>pausesoundtoggle({voice});</code></p> <p>停止声音：<code>stopsound({voice});</code></p> <p>停止所有声音：<code>stopallsounds();</code></p> <h3 id="视频热点"><a href="#视频热点" class="header-anchor">#</a> 视频热点</h3> <p><strong>内部控制</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">播放视频</span><span class="token operator">:</span> <span class="token function">playvideo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>video<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token literal-property property">关闭视频</span><span class="token operator">:</span> <span class="token function">closevideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">停止</span><span class="token operator">:</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">暂停</span><span class="token operator">:</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token literal-property property">播放</span><span class="token operator">:</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

播放<span class="token operator">/</span>停止<span class="token operator">:</span> <span class="token function">togglepause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>外部控制</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">播放视频</span><span class="token operator">:</span> hotspot<span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">playvideo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>video<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">关闭视频</span><span class="token operator">:</span> hotspot<span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">closevideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">停止</span><span class="token operator">:</span> hotspot<span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token literal-property property">暂停</span><span class="token operator">:</span> hotspot<span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token literal-property property">播放</span><span class="token operator">:</span> hotspot<span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

播放<span class="token operator">/</span>停止<span class="token operator">:</span> hotspot<span class="token punctuation">[</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">togglepause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="全屏"><a href="#全屏" class="header-anchor">#</a> 全屏</h3> <p>切换全屏：<code>switch(fullscreen,true);</code></p> <p>进入全屏：<code>set(fullscreen,true);</code></p> <p>退出全屏：<code>set(fullscreen,false);</code></p> <h3 id="键盘鼠标"><a href="#键盘鼠标" class="header-anchor">#</a> 键盘鼠标</h3> <p><strong>鼠标类型：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">移动到</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>control<span class="token punctuation">.</span>mousetype<span class="token punctuation">,</span>moveto<span class="token punctuation">)</span><span class="token punctuation">;</span>

2D拖拽<span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>control<span class="token punctuation">.</span>mousetype<span class="token punctuation">,</span>drag2d<span class="token punctuation">)</span><span class="token punctuation">;</span>

3D拖拽<span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>control<span class="token punctuation">.</span>mousetype<span class="token punctuation">,</span>drag3d<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p><strong>旋转缩放：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">放大</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>fov_moveforce<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">缩小</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>fov_moveforce<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">停止缩放</span><span class="token operator">:</span> <span class="token punctuation">(</span>fov_moveforce<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">向左</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>hlookat_moveforce<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">向右</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>hlookat_moveforce<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">停止左右</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>hlookat_moveforce<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">向上</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>vlookat_moveforce<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token literal-property property">向下</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>vlookat_moveforce<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">停止上下</span><span class="token operator">:</span> <span class="token function">set</span><span class="token punctuation">(</span>vlookat_moveforce<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>鼠标控制类型：</strong><code>control.mousetype</code></p> <h3 id="场景"><a href="#场景" class="header-anchor">#</a> 场景</h3> <p><strong>前一场景：</strong> <code>_loadpano(%FIRSTXML%GigaMap/{scene_id}/scene.xml,MERGE,{blend})</code></p> <p><strong>后一场景：</strong> <code>_loadscene(get(SSet.Next_Scene_ID));</code></p> <p><strong>场景调用：</strong></p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token function">loadpano</span><span class="token punctuation">(</span><span class="token placeholder selector">%FIRSTXML</span><span class="token placeholder selector">%scene</span>/<span class="token punctuation">{</span>scene_id<span class="token punctuation">}</span>/scene.xml<span class="token punctuation">,</span>MERGE<span class="token punctuation">,</span><span class="token punctuation">{</span>blend<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span>pano2.xml<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span>pano2.xml<span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> MERGE<span class="token punctuation">,</span> <span class="token function">BLEND</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadscene</span><span class="token punctuation">(</span>scene1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadscene</span><span class="token punctuation">(</span>scene1<span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> MERGE<span class="token punctuation">,</span> <span class="token function">BLEND</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadxml</span><span class="token punctuation">(</span><span class="token string">'&lt;krpano&gt;&lt;image&gt;&lt;sphere url=&quot;pano.jpg&quot;/&gt;&lt;/image&gt;&lt;/krpano&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadxml</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>data[xml].content<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> KEEPALL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span><span class="token string">'%SWFPATH%/pano.xml'</span><span class="token punctuation">,</span> <span class="token null keyword">null</span><span class="token punctuation">,</span> MERGE<span class="token punctuation">,</span> <span class="token function">BLEND</span><span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">loadpano</span><span class="token punctuation">(</span>sphere.xml<span class="token punctuation">,</span> image.hfov=1.0&amp;view.limitview=fullrange<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>矩阵地图调用：</strong> <code>loadpano(%FIRSTXML%GigaMap/{scene_id}/scene.xml,MERGE,{blend})</code></p> <h3 id="js通信"><a href="#js通信" class="header-anchor">#</a> JS通信</h3> <p><strong>JavaScript 调用 Krpano 对象</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">embedpano</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//省略其它不相关设置...</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;krpanoSWFObject&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">onready</span><span class="token operator">:</span> krpanoReady
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">krpanoReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> krpano <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'krpanoSWFObject'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">krpano</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">&quot;webvr.enterVR()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//进入VR</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>krpano 对象默认 ID 为krpanoSWFObject，不过为了确定每次都能正常获取到，请在embedpano的onready函数中处理。</p> <p><strong>Krpano JavaScript 接口对象</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token func"><span class="token function">set</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">-</span> 将指定数值赋值给指定 krpano 对象</span>
<span class="token func"><span class="token function">get</span><span class="token punctuation">(</span>variable<span class="token punctuation">)</span> <span class="token operator">-</span> 返回指定 krpano 变量的数值</span>
<span class="token func"><span class="token function">call</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span> <span class="token operator">-</span> 调用和执行任意 krpano 动作代码</span>
<span class="token func"><span class="token function">spheretoscreen</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-</span> 直接调用 spheretoscreen 动作</span>
<span class="token func"><span class="token function">screentosphere</span><span class="token punctuation">(</span>x <span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token operator">-</span> 直接调用 screentosphere 动作</span>
</code></pre></div><p><strong>Krpano 调用 JavaScript</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token func"><span class="token function">jscall</span><span class="token punctuation">(</span><span class="token string">&quot;任何JS代码&quot;</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">jscall</span><span class="token punctuation">(</span><span class="token string">&quot;alert('11')&quot;</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">jscall</span><span class="token punctuation">(</span><span class="token string">&quot;window.funName()&quot;</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">jsget</span><span class="token punctuation">(</span>variable<span class="token punctuation">,</span> <span class="token string">&quot;javascript code&quot;</span><span class="token punctuation">)</span> <span class="token comment">//返回值所存储的krpano变量的名字，变量不存在则创建</span></span>
</code></pre></div><p><strong>js获取任何标签的属性</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Getinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
<span class="token keyword">var</span> krpano <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;krpanoSWFObject&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token keyword">var</span> ath <span class="token operator">=</span> krpano<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'hotspot[hotspot1].ath'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> atv <span class="token operator">=</span> krpano<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'hotspot[hotspot1].atv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ath:&quot;</span> <span class="token operator">+</span> ath<span class="token operator">+</span><span class="token string">&quot; atv:&quot;</span> <span class="token operator">+</span> atv<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>hotspot name<span class="token operator">=</span><span class="token string">&quot;hotspot1&quot;</span> url<span class="token operator">=</span><span class="token string">&quot;http://www.new720.com/images/logo.png&quot;</span>  onclick<span class="token operator">=</span><span class="token string">&quot;js(Getinfo())&quot;</span>  ath<span class="token operator">=</span><span class="token string">&quot;0&quot;</span> atv<span class="token operator">=</span><span class="token string">&quot;0&quot;</span> ondown<span class="token operator">=</span><span class="token string">&quot;draghotspot();&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><p>Flash 注意事项
该动作需要 Flashplayer 的外部接口，这样在浏览器运行时才可用。本地或离线使用有file://的路径时，使用 Flashplayer 的本地/离线调用设置。</p> <h4 id="js调用全景action-带参数"><a href="#js调用全景action-带参数" class="header-anchor">#</a> JS调用全景action(带参数)</h4> <p>在xml中编写一个action,如：</p> <div class="language-sqf extra-class"><pre class="language-sqf"><code><span class="token operator">&lt;</span><span class="token function">action</span> <span class="token function">name</span><span class="token operator">=</span><span class="token string">&quot;layerinfo&quot;</span><span class="token operator">&gt;</span>
trace<span class="token punctuation">(</span><span class="token operator">%</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token function">action</span><span class="token operator">&gt;</span>
</code></pre></div><p>在页面中编写js脚本，如：</p> <p>注意事项，embedpano中的ID名称和JS获取的ID名称要一致</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
 var krpano = document.getElementById(&quot;krpanoSWFObject&quot;);
 krpano.call(&quot;layerinfo('New720.cn');&quot;);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="获取中心坐标"><a href="#获取中心坐标" class="header-anchor">#</a> 获取中心坐标</h3> <p>方法一：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> krpano <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>‘krpanoSWFObject’<span class="token punctuation">)</span><span class="token punctuation">;</span>

krpano<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>“curscreen_x”<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
krpano<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>“curscreen_y”<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">krpano</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">“screentosphere</span><span class="token punctuation">(</span>curscreen_x<span class="token punctuation">,</span> curscreen_y<span class="token punctuation">,</span> curscreen_ath<span class="token punctuation">,</span> curscreen_atv<span class="token punctuation">)</span><span class="token punctuation">;</span>”<span class="token punctuation">)</span><span class="token punctuation">;</span>
ath <span class="token operator">=</span> krpano<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>“curscreen_ath”<span class="token punctuation">)</span><span class="token punctuation">;</span>
atv <span class="token operator">=</span> krpano<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>“curscreen_atv”<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>方法二：</p> <div class="language-abnf extra-class"><pre class="language-abnf"><code><span class="token rule">var</span> <span class="token rule">ath</span> <span class="token operator">=</span> <span class="token rule">krpano</span>.<span class="token rule">view</span>.<span class="token rule">hlookat</span><span class="token comment">;</span>
<span class="token rule">var</span> <span class="token rule">atv</span> <span class="token operator">=</span> <span class="token rule">krpano</span>.<span class="token rule">view</span>.<span class="token rule">vlookat</span><span class="token comment">;</span>
</code></pre></div><h3 id="全景视频"><a href="#全景视频" class="header-anchor">#</a> 全景视频</h3> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>krpano</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- include the videoplayer plugin --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">url.flash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.swf<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">url.html5</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.js<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">videourl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video.mp4|video.webm<span class="token punctuation">&quot;</span></span>
            <span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- define the pano image and refer to the videoplayer plugin --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sphere</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>plugin:video<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>krpano</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>方法：</strong> <code>plugin[video].playvideo('video2.mp4|video2.webm');</code></p> <h3 id="krpano-tools使用"><a href="#krpano-tools使用" class="header-anchor">#</a> krpano tools使用</h3> <p>具体使用方法参考官网：<a href="https://link.segmentfault.com/?enc=DqzIKVeihGYZOqxVzE6qpw%3D%3D.gGxUB0zQlCT2zyERlw2a5ki2yHFfoOkMqLCksGu5WdI%3D" target="_blank" rel="noopener noreferrer">https://krpano.com/tools/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="常用插件"><a href="#常用插件" class="header-anchor">#</a> 常用插件</h2> <p>krpano提供了一个小而简单的接口开发自己的插件，插件可以是Flash(. swf),Javascript(js),xml(xml)插件。
官网地址：<a href="https://link.segmentfault.com/?enc=f9HbTz68YRo2%2B5VJtwlI6Q%3D%3D.ZDESF9y1Z9Ip86LIw1li7I%2FyzGWTJYEmitVgoxz83ASCzKv37jozf8e6LogtaryJ" target="_blank" rel="noopener noreferrer">https://krpano.com/docu/plugi...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
可以自己开发插件，这里只介绍官方的免费插件</p> <h4 id="建议"><a href="#建议" class="header-anchor">#</a> 建议</h4> <p>在日常开发中，需要定制高级功能的时候建议按照插件来开发，每个插件可单独配置、低耦合，在需要的时候引入文件即可，不对其他功能造成影响，以下是个人开发结构，为了减少请求数，通过构建工具自动监听文件变化，最终合并成一个主文件，上线也只需要此文件即可。
如果您有更好的方案或者其他想法也可以一起探讨。</p> <p><img src="https://esqbs.github.io/image_store/blog/202404092044333.png" alt="图片描述"></p> <h3 id="combobox"><a href="#combobox" class="header-anchor">#</a> Combobox</h3> <p>首先需要导入插件<code>&lt;include url=&quot;plugins/combobox.xml&quot; /&gt;</code> <strong>创建静态列表框：</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>combobox</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">design</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span> <span class="token attr-name">...any</span> <span class="token attr-name">layer</span> <span class="token attr-name">settings...</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">caption</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Item 1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">caption</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Item 2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">caption</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Item 3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>combobox</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>动态创建列表框：</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>       
    addComboboxLayer(box1, default);
    set(layer[box1].align, 'lefttop');
    set(layer[box1].x, 20);
    set(layer[box1].y, 20);
    layer[box1].addItem('Item 1', trace(Item 1 clicked) );
    layer[box1].addItem('Item 2', trace(Item 2 clicked) );
    layer[box1].addItem('Item 3', trace(Item 3 clicked) );
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>action</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>大小位置：</strong></p> <ul><li>位置类似layer一样通过align，edeg，x，y，parent来设置</li> <li>如不设置宽度，将取item中的最大宽度</li> <li>无需设置高度，高度总是自适应的</li></ul> <p><strong>属性/事件</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token variable-declaration"><span class="token variable">design=&quot;default&quot;</span>  设计方案</span>
<span class="token property-declaration"><span class="token property">selecteditemindex</span>  选中项的索引（只读）</span>
<span class="token variable-declaration"><span class="token variable">onchange=&quot;&quot;</span>  选定项目改变时调用</span>
<span class="token variable-declaration"><span class="token variable">item=&quot;&quot;</span>  包含的项目，数组格式，layer<span class="token punctuation">[</span>cbname<span class="token punctuation">]</span>.item<span class="token punctuation">[</span>itemname<span class="token punctuation">]</span>.<span class="token operator">*</span><span class="token operator">/</span>layer<span class="token punctuation">[</span>cbname<span class="token punctuation">]</span>.item.count</span>
item<span class="token punctuation">[</span>itemname<span class="token punctuation">]</span><span class="token punctuation">.</span>caption   项目的标题文本
item<span class="token punctuation">[</span>itemname<span class="token punctuation">]</span><span class="token punctuation">.</span>onclick   项目的点击事件
</code></pre></div><p><strong>插件操作</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token func"><span class="token function">addComboboxLayer</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> design<span class="token operator">*</span><span class="token punctuation">)</span>   添加列表框（名字，设计方案）</span>
<span class="token func"><span class="token function">removeComboboxLayer</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>    移除</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">addItem</span><span class="token punctuation">(</span>caption<span class="token punctuation">,</span> onclick<span class="token punctuation">)</span>    添加项及对应事件</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">addNamedItem</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> caption<span class="token punctuation">,</span> onclick<span class="token punctuation">)</span>    添加项，标题及对应事件</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">selectItem</span><span class="token punctuation">(</span>caption<span class="token punctuation">)</span>    根据标题选择项</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">selectItemByName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>    根据name选择项</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">removeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    移除所有项</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">openList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    打开列表</span>
layer<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token func"><span class="token function">closeList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    关闭列表</span>
</code></pre></div><p><strong>自定义设计方案</strong>
通过 &lt; combobox_design &gt;元素定义，具有以下属性</p> <div class="language-ini extra-class"><pre class="language-ini"><code><span class="token key attr-name">margin</span><span class="token punctuation">=</span><span class="token value attr-value">&quot;2&quot;   边距</span>
<span class="token key attr-name">open_close_speed</span><span class="token punctuation">=</span><span class="token value attr-value">&quot;0.25&quot;   打开/关闭速度(秒)</span>
</code></pre></div><p>内部包含三个style元素分别设置容器，遮罩及项目的样式</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>combobox_design</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span> <span class="token attr-name">margin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open_close_speed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.25<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>combobox_container_style<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgalpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xFFFFFF<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgborder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1 0xFFFFFF 0.5<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgroundedge</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgshadow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 1 3 0x000000 1.0<span class="token punctuation">&quot;</span></span>
           <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>combobox_marker_style<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">css</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>color:#FFFFFF;<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bg</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">txtshadow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 2 0x000000 1<span class="token punctuation">&quot;</span></span>
           <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>combobox_item_style<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">css</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>color:#222222;<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">padding</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4 4<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bg</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgcolor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0xC7E4FC<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgalpha</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">bgroundedge</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span>
           <span class="token attr-name">txtshadow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0 0 1 0xFFFFFF 1.0<span class="token punctuation">&quot;</span></span>
           <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>combobox_design</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="此处有坑-combobox和action-calc-pos-from-hfov-yaw-pitch-roll-中cb变量冲突"><a href="#此处有坑-combobox和action-calc-pos-from-hfov-yaw-pitch-roll-中cb变量冲突" class="header-anchor">#</a> 此处有坑：combobox和action（calc_pos_from_hfov_yaw_pitch_roll）中cb变量冲突</h4> <ul><li>combobox不能放在其他layer内，可以通过parent来指定父级</li> <li>如果同时使用了最新版（1.19 pr13）的combobox 插件 及calc_pos_from_hfov_yaw_pitch_roll这个action 会出错，因为他们都使用了同一个变量 cb 。 只需要将calc_pos_from_hfov_yaw_pitch_roll中的变量改下名字就好。</li></ul> <p><img src="https://esqbs.github.io/image_store/blog/202404092045456.png" alt="图片描述"></p> <ul><li><ul><li><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul></li></ul></li></ul> <p>官方文档：<a href="https://link.segmentfault.com/?enc=vvS7Jgd8QpMKmiwvAQgVdw%3D%3D.1tnhNMUUuImg7TmfAES507nv5kmxAWhTMO9NvJjt8%2BZtAWE0s3zoEDGXr%2BmTSBVZ" target="_blank" rel="noopener noreferrer">https://krpano.com/plugins/co...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="videoplayer"><a href="#videoplayer" class="header-anchor">#</a> Videoplayer</h3> <p><strong>layer：</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>layer</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">url.flash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.swf<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">url.html5</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.js<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">videourl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video.m4v|video.webm<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">posterurl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoposter.jpg<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">pausedonstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">loop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">volume</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">onvideoready</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">onvideoplay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">onvideopaused</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">onvideocomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
       <span class="token attr-name">onerror</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
       <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p><strong>3 d-distorted热点：</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hotspot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">url.flash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.swf<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">url.html5</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.js<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">videourl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video.m4v|video.webm<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">posterurl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoposter.jpg<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">ath</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">atv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">distorted</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">scale</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span> 
         <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> 
         <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> 
         <span class="token attr-name">rz</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span> 
         <span class="token attr-name">pausedonstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">loop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">volume</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">directionalsound</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">range</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">rangefalloff</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">outofrangevolume</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onvideoready</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onvideoplay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onvideopaused</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onvideocomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">onerror</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
         <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p><strong>全景图像:</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">url.flash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.swf<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">url.html5</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoplayer.js<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">videourl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video.m4v|video.webm<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">posterurl</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>videoposter.jpg<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">panovideo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">pausedonstart</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">loop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">volume</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1.0<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onvideoready</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onvideoplay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onvideopaused</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onvideocomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onerror</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">hfov</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>360<span class="token punctuation">&quot;</span></span> <span class="token attr-name">vfov</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>180<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sphere</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>plugin:video<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>属性：</strong></p> <div class="language-gradle extra-class"><pre class="language-gradle"><code>`videourl：`视频地址，一般就是MP4<span class="token operator">+</span>webm，优先从左到右，可用preferredformat调整（MPEG4 <span class="token interpolation-string"><span class="token string">/ H264 (。 mp4,。 m4v。mov)- flash播放器/</span></span> <span class="token function">Firefox</span><span class="token punctuation">(</span>Windows <span class="token number">7</span> <span class="token operator">+</span><span class="token punctuation">)</span><span class="token interpolation-string"><span class="token string">/ Safari和Chrome /</span></span> IE Android <span class="token interpolation-string"><span class="token string">/ iOS /</span></span>
WebM <span class="token punctuation">(</span><span class="token punctuation">.</span>webm<span class="token punctuation">)</span>——Firefox和Chrome
Ogg Theora <span class="token punctuation">(</span>。 ogg<span class="token punctuation">,</span><span class="token punctuation">.</span>ogv<span class="token punctuation">)</span><span class="token operator">-</span> Firefox和Chrome
Flash视频 <span class="token punctuation">(</span>。 flv<span class="token punctuation">,</span><span class="token punctuation">.</span>f4v<span class="token punctuation">)</span>——flash播放器
RTMP视频流 <span class="token punctuation">(</span> rtmp<span class="token punctuation">:</span><span class="token interpolation-string"><span class="token string">/ /</span></span> url<span class="token punctuation">)</span><span class="token operator">-</span> flash播放器
HTTP流媒体直播 <span class="token punctuation">(</span>。 m3u<span class="token punctuation">,</span><span class="token punctuation">.</span>m3u8<span class="token punctuation">)</span>——iOS<span class="token punctuation">,</span>Mac Safari只——而且只有<span class="token operator">&lt;</span>层<span class="token operator">&gt;</span>用法<span class="token punctuation">,</span>不是因为帕诺人——因为这个视频 iOS错误 <span class="token operator">!</span>）

posterurl（html5）：封面，默认第一帧
panovideo （use_as_videopano 老版）：<span class="token boolean">false</span>是否用作全景视频
pausedonstart：<span class="token boolean">false</span>在一开始是否暂停
loop<span class="token punctuation">:</span><span class="token boolean">false</span>循环
volume：音量 <span class="token number">0.0</span><span class="token operator">-</span><span class="token number">1.0</span>
muted（html5）：静音
playbackrate（html5）：<span class="token number">1.0</span>回放速度
directionalsound（flash）：<span class="token number">3d</span>声音音效
range（flash）：<span class="token number">90.0</span>
rangefalloff （flash）：<span class="token number">1.0</span>
outofrangevolume（flash）：<span class="token number">0.0</span>
preferredformat（html5）：格式优先
autopause（html5） ：<span class="token boolean">true</span>自动暂停视频当浏览器选项卡<span class="token operator">/</span>窗口被隐藏
autoresume（html5）：<span class="token boolean">false</span>自动恢复视频的时候停顿了一下<span class="token punctuation">,</span>然后通过隐藏浏览器选项卡<span class="token operator">/</span>窗口
html5controls（html5）：<span class="token boolean">false</span>当启用<span class="token punctuation">(</span>设置为<span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>显示浏览器内置的视频控件。
html5preload（html5）：auto预加载
buffertime（falsh）：<span class="token number">0.1</span>视频应该在开始之前加载<span class="token operator">/</span>缓冲的时间
ignoremetadata（flash）：<span class="token boolean">false</span>
playsinline（html5）：<span class="token boolean">true</span>在移动设备上播放视频内联<span class="token function">krpano</span><span class="token punctuation">(</span>iPhone、iPad、Android<span class="token punctuation">)</span>。当禁用<span class="token punctuation">,</span>那么浏览器就可以最终在自己内部的放像机播放视频
iphoneworkarounds（html5）：<span class="token boolean">true</span>使工作区为iPhone视频支持<span class="token punctuation">(</span>iOS版本iOS前<span class="token number">10</span><span class="token punctuation">)</span>。
touchworkarounds（html5）：<span class="token boolean">true</span>使播放通过触摸手机和平板设备的解决方案
</code></pre></div><p><strong>事件：</strong></p> <div class="language-hsp extra-class"><pre class="language-text"><code>onvideoready：准备就绪
onvideoplay：播放
onvideopaused：暂停
onvideocomplete：播放完成
onerror：错误
onneedtouch：需要触摸
ongottouch：触摸时
</code></pre></div><p><strong>状态（只读）：</strong></p> <div class="language-applescript extra-class"><pre class="language-applescript"><code>isvideoready 
ispaused 
isseeking
iscomplete
isautopaused 
needtouch
videoerror
time
totaltime
videowidth 
videoheight
loadedbytes 
totalbytes
</code></pre></div><p><strong>操作：</strong></p> <div class="language-stylus extra-class"><pre class="language-stylus"><code><span class="token func"><span class="token function">playvideo</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> posterurl<span class="token punctuation">,</span> pausedonstart<span class="token punctuation">,</span> starttime<span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">togglepause</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="token func"><span class="token function">seek</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span></span>
</code></pre></div><ul><li><ul><li><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul></li></ul></li></ul> <p>官网:<a href="https://link.segmentfault.com/?enc=qfpgSBWLBqGgxQT53j8EoA%3D%3D.DAFDcEwEtxXN1TxEMbhseJD2TzKefupv5%2BcCzYphRbpDjEcoyPHi9xIMMFsrBRpD" target="_blank" rel="noopener noreferrer">https://krpano.com/plugins/vi...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="scrollarea"><a href="#scrollarea" class="header-anchor">#</a> Scrollarea</h3> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;layer name=&quot;scrollarea&quot;
       url=&quot;scrollarea.swf&quot; alturl=&quot;scrollarea.js&quot;
       parent=&quot;&quot;
       align=&quot;&quot; width=&quot;&quot; height=&quot;&quot;
       direction=&quot;all&quot;      方向h/v/all
       draggable=&quot;true&quot;   允许拖动
       mwheel=&quot;true&quot;        鼠标滚动
       onhover_autoscrolling=&quot;false&quot;  hover自动滚动
       overscroll=&quot;1.0&quot;   滚动超出
       friction=&quot;0.95&quot;   摩擦
       acceleration=&quot;0.08&quot;  运动加速度
       returnacceleration=&quot;0.15&quot;  回弹
       momentum=&quot;0.06&quot; 动力加速度
       onscroll=&quot;&quot;  滚动回调
       &gt;
</code></pre></div><p><strong>只读属性：</strong></p> <div class="language- extra-class"><pre class="language-text"><code>loverflow (只读) loverflow =左溢 
roverflow (只读) roverflow =对溢出 
toverflow (只读) toverflow =顶部溢出 
boverflow (只读) boverflow =底部溢出 
woverflow (只读) woverflow =总宽度溢出 
hoverflow (只读) hoverflow =总高度溢出 
</code></pre></div><p><strong>事件</strong>
onscroll //滚动
setcenter(x,y) //设置中心
scrolltocenter(x,y) //滚动到中心
scrollby(dx,dy) //设置滚动速度向量
stopscrolling() //停止滚动</p> <ul><li><ul><li><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul></li></ul></li></ul> <p>官方文档：<a href="https://link.segmentfault.com/?enc=4o%2Fa3dvBb7wy0FTO3%2FDXsA%3D%3D.kUz%2Bq2IyVmYyzRYLTObjfyuir4igML6%2FvBqJcI3kvs4aZAFLPCLUSAUq2mqXSkUQ" target="_blank" rel="noopener noreferrer">https://krpano.com/plugins/sc...<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="gyro2-新"><a href="#gyro2-新" class="header-anchor">#</a> Gyro2（新）</h3> <p>使用手机/平板电脑设备的陀螺仪和加速度传感器来控制全景查看方向，相比旧版（gyro插件），此版本更快，相应更及时、准确、流畅，建议使用新版。</p> <p><strong>支持：</strong>
ios,android，windows phone只要设备本身有硬件支持都可以使用
<strong>用法：</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;plugin name=&quot;gyro&quot; 
        devices=&quot;html5&quot; 
        keep=&quot;true&quot;
        url=&quot;gyro2.js&quot;  //引入插件
        enabled=&quot;false&quot;   //是否启用陀螺仪
        camroll=&quot;true&quot;  //根据设备旋转调整观看位置
        friction=&quot;0.0&quot;   0.0-0.99或者auto  摩擦力，auto和zoom/fov/frame-rate有关
        touch_mode=&quot;full&quot;  off(关闭)/horizontaloffset（横向）/full（全部）/disablegyro（）,触摸方式
        sensor_mode=&quot;1&quot;  传感器类型
        softstart=&quot;0.5&quot;  启用陀螺时，方向改变的时间，为0将立即使用gyro-tracked值
        autocalibration=&quot;false&quot;  自动校准陀螺仪
        onavailable=&quot;&quot;
        onunavailable=&quot;&quot;
        onenable=&quot;&quot;
        ondisable=&quot;&quot;
        /&gt;
</code></pre></div><p><strong>属性：</strong> <code>sensor_mode：</code>传感器类型</p> <ul><li>0 =直接使用最新的可用的传感器数据。 没有内插或外推法。 根据sensor-time-intervals的浏览器 运动可以是不平稳的或平滑。</li> <li>1 =最新之间顺利插入 可用的传感器数据。 这将给一个非常光滑但延迟运动。</li> <li>2 =预测设备传感器数据之间的旋转,然后插入。</li> <li>3 =推断最新可用的传感器数据 当前帧的时间。 这将给一个快速响应和平滑运动,但可以有抽搐 当外推/预测数据和实际运动不匹配。</li> <li>4 =预测当前帧的旋转装置。 这将给一个快速响应和平滑运动,但可以有抽搐 当外推/预测数据和实际运动不匹配。</li> <li>5 =预测设备旋转和推断 传感器数据从最新的事件当前帧时间。</li></ul> <p><strong>状态</strong> <code>isavailable=&quot;false&quot;</code>设备是否支持陀螺仪
<strong>事件</strong></p> <div class="language- extra-class"><pre class="language-text"><code>onavailable:   在支持陀螺仪的设备上调用
onunavailable：在不支持陀螺仪的设备上调用
onenable： 在陀螺仪启用的时候调用
ondisable： 在陀螺仪禁用的时候调用
</code></pre></div><p><strong>操作</strong> <code>resetSensor(hlookat, vlookat*)：重置陀螺仪方向</code></p> <h3 id="moretweentypes-plugin"><a href="#moretweentypes-plugin" class="header-anchor">#</a> MoreTweenTypes Plugin</h3> <p>本插件作为tween方法的参数使用。
<strong>Ease Out and In:</strong></p> <ul><li>easeOutInQuart</li> <li>easeOutInQuint</li> <li>easeOutInSine</li> <li>easeOutInBounce</li> <li>easeOutInCirc</li> <li>easeOutInCubic</li> <li>easeOutInExpo</li></ul> <p><strong>Ease In and Out:</strong></p> <ul><li>easeInOutQuad</li> <li>easeInOutQuart</li> <li>easeInOutQuint</li> <li>easeInOutSine</li> <li>easeInOutBounce</li> <li>easeInOutCirc</li> <li>easeInOutCubic</li> <li>easeInOutExpo</li></ul> <h4 id="引入插件"><a href="#引入插件" class="header-anchor">#</a> 引入插件</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span> <span class="token attr-name">url.html5</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>moretweentypes.js<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">url.flash</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>moretweentypes.swf<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">preload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="gridmenu"><a href="#gridmenu" class="header-anchor">#</a> Gridmenu</h3> <h4 id="插件属性配置"><a href="#插件属性配置" class="header-anchor">#</a> 插件属性配置</h4> <p><strong>button(可选)</strong></p> <ul><li>是否展示显示和隐藏网格菜单的默认按钮</li> <li>默认值=true</li></ul> <p><strong>padding_top(可选)</strong></p> <ul><li>缩略图滚动区域的顶部边距</li> <li>对手机端该边距将被设置为0</li> <li>默认值=75</li></ul> <p><strong>padding_bottom(可选)</strong></p> <ul><li>缩略图滚动区域的底部边距</li> <li>对手机端该边距将被设置为0</li> <li>默认值=75</li></ul> <p><strong>width_margin(可选)</strong></p> <ul><li>缩略图滚动区域的左右边距</li> <li>对手机端该边距将被设置为0</li> <li>默认值=0</li></ul> <p><strong>grid_bgcolor(可选)</strong></p> <ul><li>背景颜色</li> <li>默认值=0x000000</li></ul> <p><strong>grid_bgalpha(可选)</strong></p> <ul><li>背景透明度</li> <li>默认值=0.7</li></ul> <p><strong>display_title(可选)</strong></p> <ul><li>展示网格菜单标题</li> <li>默认值=true</li></ul> <p><strong>grid_title(可选)</strong></p> <ul><li>网格菜单标题</li> <li>默认值=GRID MENU</li></ul> <p><strong>grid_title_css(可选)</strong></p> <ul><li>网格菜单标题的CSS样式</li> <li>默认值=color:#ffffff;font-family:Raleway;font-size:35px;</li></ul> <p><strong>group(可选)</strong></p> <ul><li>是否按照分组安排缩略图</li> <li>注意不在分组中的场景不会被展示</li> <li>默认值=false</li></ul> <p><strong>current(可选)</strong></p> <ul><li>只展示当前分组的缩略图</li> <li>默认值=false</li></ul> <p><strong>cat_container_height(可选)</strong></p> <ul><li>分组标题容器的高度</li> <li>默认值=35</li></ul> <p><strong>cat_container_border(可选)</strong></p> <ul><li>分组标题容器的边框设置</li> <li>默认值=0,0,1,0 0xffffff 1.00</li></ul> <p><strong>cat_container_title_css(可选)</strong></p> <ul><li>分组标题的CSS样式</li> <li>默认值=color:#ffffff;font-family:Raleway;font-size:25px;</li></ul> <p><strong>cat_container_title_align(可选)</strong></p> <ul><li>分组标题的对齐位置</li> <li>默认值=left</li></ul> <p><strong>cat_container_border_height(可选)</strong></p> <ul><li>分组标题的底部边距</li> <li>默认值=1</li></ul> <p><strong>display_cat_desc(可选)</strong></p> <ul><li>是否显示分组的描述</li> <li>默认值=true</li></ul> <p><strong>cat_desc_css(可选)</strong></p> <ul><li>分组描述的CSS样式</li> <li>默认值=color:#ffffff;font-family:Raleway;font-size:14px;text-align:left</li></ul> <p><strong>thumbs_crop(可选)</strong></p> <ul><li>缩略图的CROP属性</li> <li>默认值=0|75|240|150</li></ul> <p><strong>thumbs_width(可选)</strong></p> <ul><li>缩略图的宽度</li> <li>默认值=240</li></ul> <p><strong>thumbs_height(可选)</strong></p> <ul><li>缩略图的高度</li> <li>默认值=150</li></ul> <p><strong>thumbs_padding(可选)</strong></p> <ul><li>缩略图的边距</li> <li>默认值=25</li></ul> <p><strong>thumbs_scale (可选)</strong></p> <ul><li>按照百分比为单位的最大缩略图尺寸</li> <li>默认值=100</li></ul> <p><strong>active_thumb_border(可选)</strong></p> <ul><li>激活的缩略图的边框设置</li> <li>默认值=3 0xffffff 1.00</li></ul> <p><strong>display_thumb_title(可选)</strong></p> <ul><li>是否展示缩略图标题</li> <li>默认值=true</li></ul> <p><strong>thumb_title_align(可选)</strong></p> <ul><li>缩略图标题的对齐方式</li> <li>默认值=bottom</li></ul> <p><strong>thumb_title_x(可选)</strong></p> <ul><li>缩略图标题的X位置</li> <li>默认值=0</li></ul> <p><strong>thumb_title_y(可选)</strong></p> <ul><li>缩略图标题的Y位置</li> <li>默认值=5</li></ul> <p><strong>thumb_title_css(可选)</strong></p> <ul><li>缩略图标题的CSS样式</li> <li>默认值=color:#ffffff;font-family:Raleway;font-size:16px;text-align:left;</li></ul> <p><strong>thumb_title_roundedge(可选)</strong></p> <ul><li>缩略图标题的背景圆角设置</li> <li>默认值=5</li></ul> <p><strong>thumb_title_background(可选)</strong></p> <ul><li>缩略图标题背景是否显示</li> <li>默认值=true</li></ul> <p><strong>thumb_title_backgroundcolor(可选)</strong></p> <ul><li>缩略图标题背景颜色</li> <li>默认值=0x000000</li></ul> <p><strong>thumb_title_backgroundalpha(可选)</strong></p> <ul><li>缩略图标题背景透明度</li> <li>默认值=0.8</li></ul> <p><strong>thumb_title_border(可选)</strong></p> <ul><li>缩略图标题背景边框是否显示</li> <li>默认值=false</li></ul> <p><strong>thumb_title_borderwidth(可选)</strong></p> <ul><li>缩略图标题边框宽度</li> <li>默认值=1</li></ul> <p><strong>thumb_title_bordercolor(可选)</strong></p> <ul><li>缩略图标题边框颜色</li> <li>默认值=0xffffff</li></ul> <p><strong>thumb_title_borderalpha(可选)</strong></p> <ul><li>缩略图标题边框透明度</li> <li>默认值=1</li></ul> <p><strong>thumb_title_padding(可选)</strong></p> <ul><li>缩略图标题边距</li> <li>默认值=3 10</li></ul> <p><strong>display_thumb_desc(可选)</strong></p> <ul><li>是否在缩略图上显示场景描述</li> <li>默认值=true</li></ul> <p><strong>thumb_desc_css(可选)</strong></p> <ul><li>场景描述的CSS样式</li> <li>默认值=color:#ffffff;font-family:Raleway;font-size:15px;text-align:center</li></ul> <p><strong>thumb_desc_bg_color(可选)</strong></p> <ul><li>场景描述的背景颜色</li> <li>默认值=0x000000</li></ul> <p><strong>thumb_desc_bg_alpha(可选)</strong></p> <ul><li>场景描述的背景透明度</li> <li>默认值=0.6</li></ul> <p><strong>thumb_desc_padding(可选)</strong></p> <ul><li>场景描述的边距</li> <li>默认值=8 15</li></ul> <p><strong>loadscene_flags(可选)</strong></p> <ul><li>Loadscene动作的flag参数</li> <li>默认值=MERGE</li></ul> <p><strong>loadscene_blend(可选)</strong></p> <ul><li>Loadscene动作的blend参数</li> <li>默认值=BLEND(1)</li></ul> <p><strong>vcenter(可选)</strong></p> <ul><li>网格菜单是否垂直居中</li> <li>默认值=false</li></ul> <h4 id="插件action"><a href="#插件action" class="header-anchor">#</a> 插件action</h4> <p><code>rg_show_thumbs_grid(true/false)</code>:显示或隐藏网格菜单</p> <p>可以选择不使用默认按钮，或者用下面代码来覆盖</p> <p><code>&lt;layer name=&quot;thumbs_button&quot; url=&quot;gridbut.png&quot; keep=&quot;true&quot; align=&quot;bottom&quot; onclick=&quot;rg_show_thumbs_grid(true);&quot; crop=&quot;0|0|45|45&quot; y=&quot;15&quot; zorder=&quot;101&quot;/&gt;</code></p> <h2 id="skin-setting"><a href="#skin-setting" class="header-anchor">#</a> skin_setting</h2> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- skin_setting 自定义元素，默认皮肤的参数设置--&gt;</span>
maps=&quot;false&quot;  <span class="token comment">&lt;!-- 是否使用必应地图或谷歌地图 --&gt;</span>
maps_type=&quot;bing&quot;  <span class="token comment">&lt;!-- 选择使用谷歌地图或必应地图 --&gt;</span>
maps_bing_api_key=&quot;&quot;   <span class="token comment">&lt;!-- 必应地图所需的API密钥，需申请 --&gt;</span>
maps_google_api_key=&quot;&quot;   <span class="token comment">&lt;!-- 谷歌地图所需的API密钥，需申请 --&gt;</span>
maps_zoombuttons=&quot;false&quot;   <span class="token comment">&lt;!-- 是否在地图上显示缩放按钮 --&gt;</span>
gyro=&quot;true&quot;   <span class="token comment">&lt;!-- 是否使用陀螺仪 --&gt;</span>
webvr=&quot;true&quot;    <span class="token comment">&lt;!-- 是否启用VR --&gt;</span>
webvr_gyro_keeplookingdirection=&quot;false&quot; <span class="token comment">&lt;!-- 进入陀螺仪或VR时是否保持观看方向 --&gt;</span>
webvr_prev_next_hotspots=&quot;true&quot;  <span class="token comment">&lt;!-- 在VR下是否启用导航到前后场景的链接热点--&gt;</span>
littleplanetintro=&quot;false&quot;    <span class="token comment">&lt;!-- 是否使用小行星开场 --&gt;</span>
title=&quot;true&quot;  <span class="token comment">&lt;!-- 是否左下角显示title --&gt;</span>
thumbs=&quot;true&quot;  <span class="token comment">&lt;!-- 是否使用缩略图，如不使用，则没有缩略图一栏 --&gt;</span>
thumbs_width=&quot;120&quot; thumbs_height=&quot;80&quot; thumbs_padding=&quot;10&quot; thumbs_crop=&quot;0|40|240|160&quot;  <span class="token comment">&lt;!-- 缩略图宽度、高度、间距以及缩略图裁切范围 --&gt;</span>
thumbs_opened=&quot;false&quot;   <span class="token comment">&lt;!-- 是否在启动时弹出缩略图一栏 --&gt;</span>
thumbs_text=&quot;false&quot;  <span class="token comment">&lt;!-- 是否在缩略图上显示名字 --&gt;</span>
thumbs_dragging=&quot;true&quot;   <span class="token comment">&lt;!-- 是否允许鼠标拖拽缩略图区域 --&gt;</span>
thumbs_onhoverscrolling=&quot;false&quot;  <span class="token comment">&lt;!-- 是否允许鼠标悬停缩略图自动滚动 --&gt;</span>
thumbs_scrollbuttons=&quot;false&quot;   <span class="token comment">&lt;!-- 是否显示缩略图滚动按钮 --&gt;</span>
thumbs_scrollindicator=&quot;false&quot;   <span class="token comment">&lt;!-- 是否显示缩略图滚动条 --&gt;</span>
thumbs_loop=&quot;false&quot;  <span class="token comment">&lt;!-- 滚动按钮是否使用缩略图循环 --&gt;</span>
tooltips_buttons=&quot;false&quot; <span class="token comment">&lt;!-- 鼠标在按钮悬停时是否弹出文字提示 --&gt;</span>
tooltips_thumbs=&quot;false&quot;  <span class="token comment">&lt;!-- 鼠标在缩略图悬停时是否弹出文字提示 --&gt;</span>
tooltips_hotspots=&quot;false&quot;   <span class="token comment">&lt;!-- 鼠标在热点上悬停时是否弹出文字提示 --&gt;</span>
tooltips_mapspots=&quot;false&quot;   <span class="token comment">&lt;!-- 鼠标在地图热点悬停时是否弹出文字提示 --&gt;</span>
deeplinking=&quot;false&quot;       <span class="token comment">&lt;!-- 是否使用深度链接获取功能，可使得当前页面路径获取场景及视角信息 --&gt;</span>
loadscene_flags=&quot;MERGE&quot;  <span class="token comment">&lt;!-- 缩略图切换场景时的变量 --&gt;</span>
loadscene_blend=&quot;OPENBLEND(0.5, 0.0, 0.75, 0.05, linear)&quot;  <span class="token comment">&lt;!-- 缩略图切换场景时的融合 --&gt;</span>
loadscene_blend_prev=&quot;SLIDEBLEND(0.5, 180, 0.75, linear)&quot;  <span class="token comment">&lt;!-- 缩略图切换到上一个场景时的融合 --&gt;</span>
loadscene_blend_next=&quot;SLIDEBLEND(0.5, 0, 0.75, linear)&quot;  <span class="token comment">&lt;!-- 缩略图切换到下一个场景时的融合 --&gt;</span>
loadingtext=&quot;载入中...&quot; <span class="token comment">&lt;!-- 在全景图载入中时显示的文字 --&gt;</span>
layout_width=&quot;100%&quot;  <span class="token comment">&lt;!--导航条容器相对屏幕宽度的百分比 --&gt;</span>
layout_maxwidth=&quot;814&quot;  <span class="token comment">&lt;!--导航条容器的最大宽度像素 --&gt;</span>
controlbar_width=&quot;-24&quot; <span class="token comment">&lt;!--导航条背景的宽度像素 --&gt;</span>
controlbar_height=&quot;40&quot;  <span class="token comment">&lt;!--导航条背景的高度像素 --&gt;</span>
controlbar_offset.normal=&quot;20&quot;  <span class="token comment">&lt;!--导航条背景与屏幕底部的距离--&gt;</span>
controlbar_offset_closed=&quot;-40&quot;  <span class="token comment">&lt;!--导航条隐藏状态时与屏幕底部的距离--&gt;</span>
controlbar_overlap.no-fractionalscaling=&quot;10&quot;  <span class="token comment">&lt;!--在不支持分级缩放页面和设置像素比的设备的导航条重叠的像素--&gt;</span>
controlbar_overlap.fractionalscaling=&quot;0&quot; <span class="token comment">&lt;!--支持分级缩放页面和设置像素比的设备的导航条重叠的像素--&gt;</span>
design_skin_images=&quot;vtourskin.png&quot; <span class="token comment">&lt;!--皮肤所用的源图片--&gt;</span>
design_bgcolor=&quot;0x000000&quot; <span class="token comment">&lt;!--皮肤的背景颜色--&gt;</span>
design_bgalpha=&quot;0.5&quot; <span class="token comment">&lt;!--皮肤的透明度--&gt;</span>
design_bgborder=&quot;0 0xFFFFFF 1.0&quot; <span class="token comment">&lt;!--皮肤的边框--&gt;</span>
design_bgroundedge=&quot;1&quot; <span class="token comment">&lt;!--皮肤边框圆角设置--&gt;</span>
design_bgshadow=&quot;0 0 9 0xFFFFFF 0.5&quot; <span class="token comment">&lt;!--皮肤的背景阴影--&gt;</span>
design_thumbborder_bgborder=&quot;4 0xFFFFFF 1.0&quot; <span class="token comment">&lt;!--皮肤的缩略图边框--&gt;</span>
design_thumbborder_padding=&quot;2&quot; <span class="token comment">&lt;!--皮肤缩略图边框间距--&gt;</span>
design_thumbborder_bgroundedge=&quot;5&quot; <span class="token comment">&lt;!--皮肤缩略图边框的圆角--&gt;</span>
design_text_css=&quot;color:#FFFFFF; font-family:Arial; font-weight:bold;&quot;<span class="token comment">&lt;!--皮肤文字样式--&gt;</span>
design_text_shadow=&quot;1&quot; <span class="token comment">&lt;!--皮肤的文字阴影--&gt;</span>
<span class="token comment">&lt;!-- 如果你要更改皮肤样式，你可以改变上面的skin_settings数值，或者选择性地include下面一个预设的设计，可以通过移除特定include元素的if属性或者在html文件的embedpano()中增加initvar:{design:’flat_light’}。 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin/vtourskin_design_glass.xml<span class="token punctuation">&quot;</span></span>       <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design === 'glass'<span class="token punctuation">&quot;</span></span>       <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin/vtourskin_design_flat.xml<span class="token punctuation">&quot;</span></span>        <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design === 'flat'<span class="token punctuation">&quot;</span></span>        <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin/vtourskin_design_flat_light.xml<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design === 'flat_light'<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin/vtourskin_design_ultra_light.xml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design === 'ultra_light'<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>skin/vtourskin_design_117.xml<span class="token punctuation">&quot;</span></span>         <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>design === '117'<span class="token punctuation">&quot;</span></span>         <span class="token punctuation">/&gt;</span></span>
</code></pre></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.dev/esqbs/blog" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/blog-pub/tags/?tag=krpano" title="标签">#krpano</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/04/26, 14:45:14</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog-pub/pages/f3f5cf/" class="prev">性能优化</a></span> <span class="next"><a href="/blog-pub/pages/389ff7/">java基础</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> 
	Theme by
	<a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
		| Copyright © 2022-2024
		<span>Esqbs</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/blog-pub/assets/js/app.910dc6a1.js" defer></script><script src="/blog-pub/assets/js/2.041a1d99.js" defer></script><script src="/blog-pub/assets/js/3.7b2c47fd.js" defer></script><script src="/blog-pub/assets/js/47.9bc03339.js" defer></script>
  </body>
</html>
